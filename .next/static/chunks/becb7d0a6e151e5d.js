(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,67423,(e,t,r)=>{"use strict";function n({widthInt:e,heightInt:t,blurWidth:r,blurHeight:n,blurDataURL:i,objectFit:s}){let a=r?40*r:e,o=n?40*n:t,l=a&&o?`viewBox='0 0 ${a} ${o}'`:"";return`%3Csvg xmlns='http://www.w3.org/2000/svg' ${l}%3E%3Cfilter id='b' color-interpolation-filters='sRGB'%3E%3CfeGaussianBlur stdDeviation='20'/%3E%3CfeColorMatrix values='1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 100 -1' result='s'/%3E%3CfeFlood x='0' y='0' width='100%25' height='100%25'/%3E%3CfeComposite operator='out' in='s'/%3E%3CfeComposite in2='SourceGraphic'/%3E%3CfeGaussianBlur stdDeviation='20'/%3E%3C/filter%3E%3Cimage width='100%25' height='100%25' x='0' y='0' preserveAspectRatio='${l?"none":"contain"===s?"xMidYMid":"cover"===s?"xMidYMid slice":"none"}' style='filter: url(%23b);' href='${i}'/%3E%3C/svg%3E`}Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"getImageBlurSvg",{enumerable:!0,get:function(){return n}})},87690,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={VALID_LOADERS:function(){return s},imageConfigDefault:function(){return a}};for(var i in n)Object.defineProperty(r,i,{enumerable:!0,get:n[i]});let s=["default","imgix","cloudinary","akamai","custom"],a={deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[32,48,64,96,128,256,384],path:"/_next/image",loader:"default",loaderFile:"",domains:[],disableStaticImages:!1,minimumCacheTTL:14400,formats:["image/webp"],maximumRedirects:3,dangerouslyAllowLocalIP:!1,dangerouslyAllowSVG:!1,contentSecurityPolicy:"script-src 'none'; frame-src 'none'; sandbox;",contentDispositionType:"attachment",localPatterns:void 0,remotePatterns:[],qualities:[75],unoptimized:!1}},8927,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"getImgProps",{enumerable:!0,get:function(){return u}}),e.r(33525);let n=e.r(43369),i=e.r(67423),s=e.r(87690),a=["-moz-initial","fill","none","scale-down",void 0];function o(e){return void 0!==e.default}function l(e){return void 0===e?e:"number"==typeof e?Number.isFinite(e)?e:NaN:"string"==typeof e&&/^[0-9]+$/.test(e)?parseInt(e,10):NaN}function u({src:e,sizes:t,unoptimized:r=!1,priority:u=!1,preload:c=!1,loading:d,className:h,quality:f,width:p,height:m,fill:g=!1,style:y,overrideSrc:v,onLoad:b,onLoadingComplete:x,placeholder:w="empty",blurDataURL:_,fetchPriority:k,decoding:j="async",layout:E,objectFit:S,objectPosition:O,lazyBoundary:T,lazyRoot:N,...A},P){var C;let z,R,$,{imgConf:F,showAltText:I,blurComplete:D,defaultLoader:M}=P,U=F||s.imageConfigDefault;if("allSizes"in U)z=U;else{let e=[...U.deviceSizes,...U.imageSizes].sort((e,t)=>e-t),t=U.deviceSizes.sort((e,t)=>e-t),r=U.qualities?.sort((e,t)=>e-t);z={...U,allSizes:e,deviceSizes:t,qualities:r}}if(void 0===M)throw Object.defineProperty(Error("images.loaderFile detected but the file is missing default export.\nRead more: https://nextjs.org/docs/messages/invalid-images-config"),"__NEXT_ERROR_CODE",{value:"E163",enumerable:!1,configurable:!0});let L=A.loader||M;delete A.loader,delete A.srcSet;let B="__next_img_default"in L;if(B){if("custom"===z.loader)throw Object.defineProperty(Error(`Image with src "${e}" is missing "loader" prop.
Read more: https://nextjs.org/docs/messages/next-image-missing-loader`),"__NEXT_ERROR_CODE",{value:"E252",enumerable:!1,configurable:!0})}else{let e=L;L=t=>{let{config:r,...n}=t;return e(n)}}if(E){"fill"===E&&(g=!0);let e={intrinsic:{maxWidth:"100%",height:"auto"},responsive:{width:"100%",height:"auto"}}[E];e&&(y={...y,...e});let r={responsive:"100vw",fill:"100vw"}[E];r&&!t&&(t=r)}let K="",Z=l(p),q=l(m);if((C=e)&&"object"==typeof C&&(o(C)||void 0!==C.src)){let t=o(e)?e.default:e;if(!t.src)throw Object.defineProperty(Error(`An object should only be passed to the image component src parameter if it comes from a static image import. It must include src. Received ${JSON.stringify(t)}`),"__NEXT_ERROR_CODE",{value:"E460",enumerable:!1,configurable:!0});if(!t.height||!t.width)throw Object.defineProperty(Error(`An object should only be passed to the image component src parameter if it comes from a static image import. It must include height and width. Received ${JSON.stringify(t)}`),"__NEXT_ERROR_CODE",{value:"E48",enumerable:!1,configurable:!0});if(R=t.blurWidth,$=t.blurHeight,_=_||t.blurDataURL,K=t.src,!g)if(Z||q){if(Z&&!q){let e=Z/t.width;q=Math.round(t.height*e)}else if(!Z&&q){let e=q/t.height;Z=Math.round(t.width*e)}}else Z=t.width,q=t.height}let V=!u&&!c&&("lazy"===d||void 0===d);(!(e="string"==typeof e?e:K)||e.startsWith("data:")||e.startsWith("blob:"))&&(r=!0,V=!1),z.unoptimized&&(r=!0),B&&!z.dangerouslyAllowSVG&&e.split("?",1)[0].endsWith(".svg")&&(r=!0);let J=l(f),W=Object.assign(g?{position:"absolute",height:"100%",width:"100%",left:0,top:0,right:0,bottom:0,objectFit:S,objectPosition:O}:{},I?{}:{color:"transparent"},y),G=D||"empty"===w?null:"blur"===w?`url("data:image/svg+xml;charset=utf-8,${(0,i.getImageBlurSvg)({widthInt:Z,heightInt:q,blurWidth:R,blurHeight:$,blurDataURL:_||"",objectFit:W.objectFit})}")`:`url("${w}")`,H=a.includes(W.objectFit)?"fill"===W.objectFit?"100% 100%":"cover":W.objectFit,Q=G?{backgroundSize:H,backgroundPosition:W.objectPosition||"50% 50%",backgroundRepeat:"no-repeat",backgroundImage:G}:{},Y=function({config:e,src:t,unoptimized:r,width:i,quality:s,sizes:a,loader:o}){if(r){let e=(0,n.getDeploymentId)();if(t.startsWith("/")&&!t.startsWith("//")&&e){let r=t.includes("?")?"&":"?";t=`${t}${r}dpl=${e}`}return{src:t,srcSet:void 0,sizes:void 0}}let{widths:l,kind:u}=function({deviceSizes:e,allSizes:t},r,n){if(n){let r=/(^|\s)(1?\d?\d)vw/g,i=[];for(let e;e=r.exec(n);)i.push(parseInt(e[2]));if(i.length){let r=.01*Math.min(...i);return{widths:t.filter(t=>t>=e[0]*r),kind:"w"}}return{widths:t,kind:"w"}}return"number"!=typeof r?{widths:e,kind:"w"}:{widths:[...new Set([r,2*r].map(e=>t.find(t=>t>=e)||t[t.length-1]))],kind:"x"}}(e,i,a),c=l.length-1;return{sizes:a||"w"!==u?a:"100vw",srcSet:l.map((r,n)=>`${o({config:e,src:t,quality:s,width:r})} ${"w"===u?r:n+1}${u}`).join(", "),src:o({config:e,src:t,quality:s,width:l[c]})}}({config:z,src:e,unoptimized:r,width:Z,quality:J,sizes:t,loader:L}),X=V?"lazy":d;return{props:{...A,loading:X,fetchPriority:k,width:Z,height:q,decoding:j,className:h,style:{...W,...Q},sizes:Y.sizes,srcSet:Y.srcSet,src:v||Y.src},meta:{unoptimized:r,preload:c||u,placeholder:w,fill:g}}}},98879,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"default",{enumerable:!0,get:function(){return o}});let n=e.r(71645),i="u"<typeof window,s=i?()=>{}:n.useLayoutEffect,a=i?()=>{}:n.useEffect;function o(e){let{headManager:t,reduceComponentsToState:r}=e;function o(){if(t&&t.mountedInstances){let e=n.Children.toArray(Array.from(t.mountedInstances).filter(Boolean));t.updateHead(r(e))}}return i&&(t?.mountedInstances?.add(e.children),o()),s(()=>(t?.mountedInstances?.add(e.children),()=>{t?.mountedInstances?.delete(e.children)})),s(()=>(t&&(t._pendingUpdate=o),()=>{t&&(t._pendingUpdate=o)})),a(()=>(t&&t._pendingUpdate&&(t._pendingUpdate(),t._pendingUpdate=null),()=>{t&&t._pendingUpdate&&(t._pendingUpdate(),t._pendingUpdate=null)})),null}},25633,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={default:function(){return m},defaultHead:function(){return d}};for(var i in n)Object.defineProperty(r,i,{enumerable:!0,get:n[i]});let s=e.r(55682),a=e.r(90809),o=e.r(43476),l=a._(e.r(71645)),u=s._(e.r(98879)),c=e.r(42732);function d(){return[(0,o.jsx)("meta",{charSet:"utf-8"},"charset"),(0,o.jsx)("meta",{name:"viewport",content:"width=device-width"},"viewport")]}function h(e,t){return"string"==typeof t||"number"==typeof t?e:t.type===l.default.Fragment?e.concat(l.default.Children.toArray(t.props.children).reduce((e,t)=>"string"==typeof t||"number"==typeof t?e:e.concat(t),[])):e.concat(t)}e.r(33525);let f=["name","httpEquiv","charSet","itemProp"];function p(e){let t,r,n,i;return e.reduce(h,[]).reverse().concat(d().reverse()).filter((t=new Set,r=new Set,n=new Set,i={},e=>{let s=!0,a=!1;if(e.key&&"number"!=typeof e.key&&e.key.indexOf("$")>0){a=!0;let r=e.key.slice(e.key.indexOf("$")+1);t.has(r)?s=!1:t.add(r)}switch(e.type){case"title":case"base":r.has(e.type)?s=!1:r.add(e.type);break;case"meta":for(let t=0,r=f.length;t<r;t++){let r=f[t];if(e.props.hasOwnProperty(r))if("charSet"===r)n.has(r)?s=!1:n.add(r);else{let t=e.props[r],n=i[r]||new Set;("name"!==r||!a)&&n.has(t)?s=!1:(n.add(t),i[r]=n)}}}return s})).reverse().map((e,t)=>{let r=e.key||t;return l.default.cloneElement(e,{key:r})})}let m=function({children:e}){let t=(0,l.useContext)(c.HeadManagerContext);return(0,o.jsx)(u.default,{reduceComponentsToState:p,headManager:t,children:e})};("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},18556,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"ImageConfigContext",{enumerable:!0,get:function(){return s}});let n=e.r(55682)._(e.r(71645)),i=e.r(87690),s=n.default.createContext(i.imageConfigDefault)},65856,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"RouterContext",{enumerable:!0,get:function(){return n}});let n=e.r(55682)._(e.r(71645)).default.createContext(null)},70965,(e,t,r)=>{"use strict";function n(e,t){let r=e||75;return t?.qualities?.length?t.qualities.reduce((e,t)=>Math.abs(t-r)<Math.abs(e-r)?t:e,0):r}Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"findClosestQuality",{enumerable:!0,get:function(){return n}})},1948,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"default",{enumerable:!0,get:function(){return a}});let n=e.r(70965),i=e.r(43369);function s({config:e,src:t,width:r,quality:s}){if(t.startsWith("/")&&t.includes("?")&&e.localPatterns?.length===1&&"**"===e.localPatterns[0].pathname&&""===e.localPatterns[0].search)throw Object.defineProperty(Error(`Image with src "${t}" is using a query string which is not configured in images.localPatterns.
Read more: https://nextjs.org/docs/messages/next-image-unconfigured-localpatterns`),"__NEXT_ERROR_CODE",{value:"E871",enumerable:!1,configurable:!0});let a=(0,n.findClosestQuality)(s,e),o=(0,i.getDeploymentId)();return`${e.path}?url=${encodeURIComponent(t)}&w=${r}&q=${a}${t.startsWith("/")&&o?`&dpl=${o}`:""}`}s.__next_img_default=!0;let a=s},18581,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"useMergedRef",{enumerable:!0,get:function(){return i}});let n=e.r(71645);function i(e,t){let r=(0,n.useRef)(null),i=(0,n.useRef)(null);return(0,n.useCallback)(n=>{if(null===n){let e=r.current;e&&(r.current=null,e());let t=i.current;t&&(i.current=null,t())}else e&&(r.current=s(e,n)),t&&(i.current=s(t,n))},[e,t])}function s(e,t){if("function"!=typeof e)return e.current=t,()=>{e.current=null};{let r=e(t);return"function"==typeof r?r:()=>e(null)}}("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},5500,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"Image",{enumerable:!0,get:function(){return x}});let n=e.r(55682),i=e.r(90809),s=e.r(43476),a=i._(e.r(71645)),o=n._(e.r(74080)),l=n._(e.r(25633)),u=e.r(8927),c=e.r(87690),d=e.r(18556);e.r(33525);let h=e.r(65856),f=n._(e.r(1948)),p=e.r(18581),m={deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[32,48,64,96,128,256,384],qualities:[75],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!1};function g(e,t,r,n,i,s,a){let o=e?.src;e&&e["data-loaded-src"]!==o&&(e["data-loaded-src"]=o,("decode"in e?e.decode():Promise.resolve()).catch(()=>{}).then(()=>{if(e.parentElement&&e.isConnected){if("empty"!==t&&i(!0),r?.current){let t=new Event("load");Object.defineProperty(t,"target",{writable:!1,value:e});let n=!1,i=!1;r.current({...t,nativeEvent:t,currentTarget:e,target:e,isDefaultPrevented:()=>n,isPropagationStopped:()=>i,persist:()=>{},preventDefault:()=>{n=!0,t.preventDefault()},stopPropagation:()=>{i=!0,t.stopPropagation()}})}n?.current&&n.current(e)}}))}function y(e){return a.use?{fetchPriority:e}:{fetchpriority:e}}"u"<typeof window&&(globalThis.__NEXT_IMAGE_IMPORTED=!0);let v=(0,a.forwardRef)(({src:e,srcSet:t,sizes:r,height:n,width:i,decoding:o,className:l,style:u,fetchPriority:c,placeholder:d,loading:h,unoptimized:f,fill:m,onLoadRef:v,onLoadingCompleteRef:b,setBlurComplete:x,setShowAltText:w,sizesInput:_,onLoad:k,onError:j,...E},S)=>{let O=(0,a.useCallback)(e=>{e&&(j&&(e.src=e.src),e.complete&&g(e,d,v,b,x,f,_))},[e,d,v,b,x,j,f,_]),T=(0,p.useMergedRef)(S,O);return(0,s.jsx)("img",{...E,...y(c),loading:h,width:i,height:n,decoding:o,"data-nimg":m?"fill":"1",className:l,style:u,sizes:r,srcSet:t,src:e,ref:T,onLoad:e=>{g(e.currentTarget,d,v,b,x,f,_)},onError:e=>{w(!0),"empty"!==d&&x(!0),j&&j(e)}})});function b({isAppRouter:e,imgAttributes:t}){let r={as:"image",imageSrcSet:t.srcSet,imageSizes:t.sizes,crossOrigin:t.crossOrigin,referrerPolicy:t.referrerPolicy,...y(t.fetchPriority)};return e&&o.default.preload?(o.default.preload(t.src,r),null):(0,s.jsx)(l.default,{children:(0,s.jsx)("link",{rel:"preload",href:t.srcSet?void 0:t.src,...r},"__nimg-"+t.src+t.srcSet+t.sizes)})}let x=(0,a.forwardRef)((e,t)=>{let r=(0,a.useContext)(h.RouterContext),n=(0,a.useContext)(d.ImageConfigContext),i=(0,a.useMemo)(()=>{let e=m||n||c.imageConfigDefault,t=[...e.deviceSizes,...e.imageSizes].sort((e,t)=>e-t),r=e.deviceSizes.sort((e,t)=>e-t),i=e.qualities?.sort((e,t)=>e-t);return{...e,allSizes:t,deviceSizes:r,qualities:i,localPatterns:"u"<typeof window?n?.localPatterns:e.localPatterns}},[n]),{onLoad:o,onLoadingComplete:l}=e,p=(0,a.useRef)(o);(0,a.useEffect)(()=>{p.current=o},[o]);let g=(0,a.useRef)(l);(0,a.useEffect)(()=>{g.current=l},[l]);let[y,x]=(0,a.useState)(!1),[w,_]=(0,a.useState)(!1),{props:k,meta:j}=(0,u.getImgProps)(e,{defaultLoader:f.default,imgConf:i,blurComplete:y,showAltText:w});return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(v,{...k,unoptimized:j.unoptimized,placeholder:j.placeholder,fill:j.fill,onLoadRef:p,onLoadingCompleteRef:g,setBlurComplete:x,setShowAltText:_,sizesInput:e.sizes,ref:t}),j.preload?(0,s.jsx)(b,{isAppRouter:!r,imgAttributes:k}):null]})});("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},94909,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={default:function(){return c},getImageProps:function(){return u}};for(var i in n)Object.defineProperty(r,i,{enumerable:!0,get:n[i]});let s=e.r(55682),a=e.r(8927),o=e.r(5500),l=s._(e.r(1948));function u(e){let{props:t}=(0,a.getImgProps)(e,{defaultLoader:l.default,imgConf:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[32,48,64,96,128,256,384],qualities:[75],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!1}});for(let[e,r]of Object.entries(t))void 0===r&&delete t[e];return{props:t}}let c=o.Image},57688,(e,t,r)=>{t.exports=e.r(94909)},93560,(e,t,r)=>{e.e,t.exports=function(){"use strict";var t=function(e,r){return(t=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,r)},r=function(){return(r=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function n(e,t,r){if(r||2==arguments.length)for(var n,i=0,s=t.length;i<s;i++)!n&&i in t||((n=n||Array.prototype.slice.call(t,0,i))[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))}var i="u">typeof globalThis?globalThis:"u">typeof self?self:"u">typeof window?window:e.g,s=Object.keys,a=Array.isArray;function o(e,t){return"object"!=typeof t||s(t).forEach(function(r){e[r]=t[r]}),e}"u"<typeof Promise||i.Promise||(i.Promise=Promise);var l=Object.getPrototypeOf,u={}.hasOwnProperty;function c(e,t){return u.call(e,t)}function d(e,t){"function"==typeof t&&(t=t(l(e))),("u"<typeof Reflect?s:Reflect.ownKeys)(t).forEach(function(r){f(e,r,t[r])})}var h=Object.defineProperty;function f(e,t,r,n){h(e,t,o(r&&c(r,"get")&&"function"==typeof r.get?{get:r.get,set:r.set,configurable:!0}:{value:r,configurable:!0,writable:!0},n))}function p(e){return{from:function(t){return e.prototype=Object.create(t.prototype),f(e.prototype,"constructor",e),{extend:d.bind(null,e.prototype)}}}}var m=Object.getOwnPropertyDescriptor,g=[].slice;function y(e,t,r){return g.call(e,t,r)}function v(e,t){return t(e)}function b(e){if(!e)throw Error("Assertion Failed")}function x(e){i.setImmediate?setImmediate(e):setTimeout(e,0)}function w(e,t){if("string"==typeof t&&c(e,t))return e[t];if(!t)return e;if("string"!=typeof t){for(var r=[],n=0,i=t.length;n<i;++n){var s=w(e,t[n]);r.push(s)}return r}var a=t.indexOf(".");if(-1!==a){var o=e[t.substr(0,a)];return null==o?void 0:w(o,t.substr(a+1))}}function _(e,t,r){if(e&&void 0!==t&&!("isFrozen"in Object&&Object.isFrozen(e)))if("string"!=typeof t&&"length"in t){b("string"!=typeof r&&"length"in r);for(var n=0,i=t.length;n<i;++n)_(e,t[n],r[n])}else{var s,o,l=t.indexOf(".");-1!==l?(s=t.substr(0,l),""===(o=t.substr(l+1))?void 0===r?a(e)&&!isNaN(parseInt(s))?e.splice(s,1):delete e[s]:e[s]=r:_(l=(l=e[s])&&c(e,s)?l:e[s]={},o,r)):void 0===r?a(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=r}}function k(e){var t,r={};for(t in e)c(e,t)&&(r[t]=e[t]);return r}var j=[].concat;function E(e){return j.apply([],e)}var S="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(E([8,16,32,64].map(function(e){return["Int","Uint","Float"].map(function(t){return t+e+"Array"})}))).filter(function(e){return i[e]}),O=new Set(S.map(function(e){return i[e]})),T=null;function N(e){return T=new WeakMap,e=function e(t){if(!t||"object"!=typeof t)return t;var r=T.get(t);if(r)return r;if(a(t)){r=[],T.set(t,r);for(var n=0,i=t.length;n<i;++n)r.push(e(t[n]))}else if(O.has(t.constructor))r=t;else{var s,o=l(t);for(s in r=o===Object.prototype?{}:Object.create(o),T.set(t,r),t)c(t,s)&&(r[s]=e(t[s]))}return r}(e),T=null,e}var A={}.toString;function P(e){return A.call(e).slice(8,-1)}var C="u">typeof Symbol?Symbol.iterator:"@@iterator",z="symbol"==typeof C?function(e){var t;return null!=e&&(t=e[C])&&t.apply(e)}:function(){return null};function R(e,t){return 0<=(t=e.indexOf(t))&&e.splice(t,1),0<=t}var $={};function F(e){var t,r,n,i;if(1==arguments.length){if(a(e))return e.slice();if(this===$&&"string"==typeof e)return[e];if(i=z(e)){for(r=[];!(n=i.next()).done;)r.push(n.value);return r}if(null==e||"number"!=typeof(t=e.length))return[e];for(r=Array(t);t--;)r[t]=e[t];return r}for(t=arguments.length,r=Array(t);t--;)r[t]=arguments[t];return r}var I="u">typeof Symbol?function(e){return"AsyncFunction"===e[Symbol.toStringTag]}:function(){return!1},D=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],M=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(D),U={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function L(e,t){this.name=e,this.message=t}function B(e,t){return e+". Errors: "+Object.keys(t).map(function(e){return t[e].toString()}).filter(function(e,t,r){return r.indexOf(e)===t}).join("\n")}function K(e,t,r,n){this.failures=t,this.failedKeys=n,this.successCount=r,this.message=B(e,t)}function Z(e,t){this.name="BulkError",this.failures=Object.keys(t).map(function(e){return t[e]}),this.failuresByPos=t,this.message=B(e,this.failures)}p(L).from(Error).extend({toString:function(){return this.name+": "+this.message}}),p(K).from(L),p(Z).from(L);var q=M.reduce(function(e,t){return e[t]=t+"Error",e},{}),V=M.reduce(function(e,t){var r=t+"Error";function n(e,n){this.name=r,e?"string"==typeof e?(this.message="".concat(e).concat(n?"\n "+n:""),this.inner=n||null):"object"==typeof e&&(this.message="".concat(e.name," ").concat(e.message),this.inner=e):(this.message=U[t]||r,this.inner=null)}return p(n).from(L),e[t]=n,e},{});V.Syntax=SyntaxError,V.Type=TypeError,V.Range=RangeError;var J=D.reduce(function(e,t){return e[t+"Error"]=V[t],e},{}),W=M.reduce(function(e,t){return -1===["Syntax","Type","Range"].indexOf(t)&&(e[t+"Error"]=V[t]),e},{});function G(){}function H(e){return e}function Q(e,t){return null==e||e===H?t:function(r){return t(e(r))}}function Y(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function X(e,t){return e===G?t:function(){var r=e.apply(this,arguments);void 0!==r&&(arguments[0]=r);var n=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var s=t.apply(this,arguments);return n&&(this.onsuccess=this.onsuccess?Y(n,this.onsuccess):n),i&&(this.onerror=this.onerror?Y(i,this.onerror):i),void 0!==s?s:r}}function ee(e,t){return e===G?t:function(){e.apply(this,arguments);var r=this.onsuccess,n=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),r&&(this.onsuccess=this.onsuccess?Y(r,this.onsuccess):r),n&&(this.onerror=this.onerror?Y(n,this.onerror):n)}}function et(e,t){return e===G?t:function(r){var n=e.apply(this,arguments);o(r,n);var i=this.onsuccess,s=this.onerror;return this.onsuccess=null,this.onerror=null,r=t.apply(this,arguments),i&&(this.onsuccess=this.onsuccess?Y(i,this.onsuccess):i),s&&(this.onerror=this.onerror?Y(s,this.onerror):s),void 0===n?void 0===r?void 0:r:o(n,r)}}function er(e,t){return e===G?t:function(){return!1!==t.apply(this,arguments)&&e.apply(this,arguments)}}function en(e,t){return e===G?t:function(){var r=e.apply(this,arguments);if(r&&"function"==typeof r.then){for(var n=this,i=arguments.length,s=Array(i);i--;)s[i]=arguments[i];return r.then(function(){return t.apply(n,s)})}return t.apply(this,arguments)}}W.ModifyError=K,W.DexieError=L,W.BulkError=Z;var ei="u">typeof location&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href),es={},S="u"<typeof Promise?[]:function(){var e=Promise.resolve();if("u"<typeof crypto||!crypto.subtle)return[e,l(e),e];var t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,l(t),e]}(),D=S[0],M=S[1],S=S[2],M=M&&M.then,ea=D&&D.constructor,eo=!!S,el=function(e,t){eg.push([e,t]),ec&&(queueMicrotask(eS),ec=!1)},eu=!0,ec=!0,ed=[],eh=[],ef=H,ep={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:G,pgp:!1,env:{},finalize:G},em=ep,eg=[],ey=0,ev=[];function eb(e){if("object"!=typeof this)throw TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var t=this._PSD=em;if("function"!=typeof e){if(e!==es)throw TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(!1===this._state&&e_(this,this._value))}this._state=null,this._value=null,++t.ref,function e(t,r){try{r(function(r){if(null===t._state){if(r===t)throw TypeError("A promise cannot be resolved with itself.");var n=t._lib&&eO();r&&"function"==typeof r.then?e(t,function(e,t){r instanceof eb?r._then(e,t):r.then(e,t)}):(t._state=!0,t._value=r,ek(t)),n&&eT()}},e_.bind(null,t))}catch(e){e_(t,e)}}(this,e)}var ex={get:function(){var e=em,t=eF;function r(r,n){var i=this,s=!e.global&&(e!==em||t!==eF),a=s&&!eU(),o=new eb(function(t,o){ej(i,new ew(eV(r,e,s,a),eV(n,e,s,a),t,o,e))});return this._consoleTask&&(o._consoleTask=this._consoleTask),o}return r.prototype=es,r},set:function(e){f(this,"then",e&&e.prototype===es?ex:{get:function(){return e},set:ex.set})}};function ew(e,t,r,n,i){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.resolve=r,this.reject=n,this.psd=i}function e_(e,t){var r;eh.push(t),null===e._state&&(r=e._lib&&eO(),t=ef(t),e._state=!1,e._value=t,ed.some(function(t){return t._value===e._value})||ed.push(e),ek(e),r&&eT())}function ek(e){var t=e._listeners;e._listeners=[];for(var r=0,n=t.length;r<n;++r)ej(e,t[r]);var i=e._PSD;--i.ref||i.finalize(),0===ey&&(++ey,el(function(){0==--ey&&eN()},[]))}function ej(e,t){if(null!==e._state){var r=e._state?t.onFulfilled:t.onRejected;if(null===r)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++ey,el(eE,[r,e,t])}else e._listeners.push(t)}function eE(e,t,r){try{var n,i=t._value;!t._state&&eh.length&&(eh=[]),n=ei&&t._consoleTask?t._consoleTask.run(function(){return e(i)}):e(i),t._state||-1!==eh.indexOf(i)||function(e){for(var t=ed.length;t;)if(ed[--t]._value===e._value)return ed.splice(t,1)}(t),r.resolve(n)}catch(e){r.reject(e)}finally{0==--ey&&eN(),--r.psd.ref||r.psd.finalize()}}function eS(){eq(ep,function(){eO()&&eT()})}function eO(){var e=eu;return ec=eu=!1,e}function eT(){var e,t,r;do for(;0<eg.length;)for(e=eg,eg=[],r=e.length,t=0;t<r;++t){var n=e[t];n[0].apply(null,n[1])}while(0<eg.length)ec=eu=!0}function eN(){var e=ed;ed=[],e.forEach(function(e){e._PSD.onunhandled.call(null,e._value,e)});for(var t=ev.slice(0),r=t.length;r;)t[--r]()}function eA(e){return new eb(es,!1,e)}function eP(e,t){var r=em;return function(){var n=eO(),i=em;try{return eK(r,!0),e.apply(this,arguments)}catch(e){t&&t(e)}finally{eK(i,!1),n&&eT()}}}d(eb.prototype,{then:ex,_then:function(e,t){ej(this,new ew(null,null,e,t,em))},catch:function(e){if(1==arguments.length)return this.then(null,e);var t=arguments[1];return"function"==typeof e?this.then(null,function(r){return(r instanceof e?t:eA)(r)}):this.then(null,function(r){return(r&&r.name===e?t:eA)(r)})},finally:function(e){return this.then(function(t){return eb.resolve(e()).then(function(){return t})},function(t){return eb.resolve(e()).then(function(){return eA(t)})})},timeout:function(e,t){var r=this;return e<1/0?new eb(function(n,i){var s=setTimeout(function(){return i(new V.Timeout(t))},e);r.then(n,i).finally(clearTimeout.bind(null,s))}):this}}),"u">typeof Symbol&&Symbol.toStringTag&&f(eb.prototype,Symbol.toStringTag,"Dexie.Promise"),ep.env=eZ(),d(eb,{all:function(){var e=F.apply(null,arguments).map(eL);return new eb(function(t,r){0===e.length&&t([]);var n=e.length;e.forEach(function(i,s){return eb.resolve(i).then(function(r){e[s]=r,--n||t(e)},r)})})},resolve:function(e){return e instanceof eb?e:e&&"function"==typeof e.then?new eb(function(t,r){e.then(t,r)}):new eb(es,!0,e)},reject:eA,race:function(){var e=F.apply(null,arguments).map(eL);return new eb(function(t,r){e.map(function(e){return eb.resolve(e).then(t,r)})})},PSD:{get:function(){return em},set:function(e){return em=e}},totalEchoes:{get:function(){return eF}},newPSD:eD,usePSD:eq,scheduler:{get:function(){return el},set:function(e){el=e}},rejectionMapper:{get:function(){return ef},set:function(e){ef=e}},follow:function(e,t){return new eb(function(r,n){return eD(function(t,r){var n=em;n.unhandleds=[],n.onunhandled=r,n.finalize=Y(function(){var e,n=this;e=function(){0===n.unhandleds.length?t():r(n.unhandleds[0])},ev.push(function t(){e(),ev.splice(ev.indexOf(t),1)}),++ey,el(function(){0==--ey&&eN()},[])},n.finalize),e()},t,r,n)})}}),ea&&(ea.allSettled&&f(eb,"allSettled",function(){var e=F.apply(null,arguments).map(eL);return new eb(function(t){0===e.length&&t([]);var r=e.length,n=Array(r);e.forEach(function(e,i){return eb.resolve(e).then(function(e){return n[i]={status:"fulfilled",value:e}},function(e){return n[i]={status:"rejected",reason:e}}).then(function(){return--r||t(n)})})})}),ea.any&&"u">typeof AggregateError&&f(eb,"any",function(){var e=F.apply(null,arguments).map(eL);return new eb(function(t,r){0===e.length&&r(AggregateError([]));var n=e.length,i=Array(n);e.forEach(function(e,s){return eb.resolve(e).then(function(e){return t(e)},function(e){i[s]=e,--n||r(AggregateError(i))})})})}),ea.withResolvers&&(eb.withResolvers=ea.withResolvers));var eC={awaits:0,echoes:0,id:0},ez=0,eR=[],e$=0,eF=0,eI=0;function eD(e,t,r,n){var i=em,s=Object.create(i);return s.parent=i,s.ref=0,s.global=!1,s.id=++eI,ep.env,s.env=eo?{Promise:eb,PromiseProp:{value:eb,configurable:!0,writable:!0},all:eb.all,race:eb.race,allSettled:eb.allSettled,any:eb.any,resolve:eb.resolve,reject:eb.reject}:{},t&&o(s,t),++i.ref,s.finalize=function(){--this.parent.ref||this.parent.finalize()},n=eq(s,e,r,n),0===s.ref&&s.finalize(),n}function eM(){return eC.id||(eC.id=++ez),++eC.awaits,eC.echoes+=100,eC.id}function eU(){return!!eC.awaits&&(0==--eC.awaits&&(eC.id=0),eC.echoes=100*eC.awaits,!0)}function eL(e){return eC.echoes&&e&&e.constructor===ea?(eM(),e.then(function(e){return eU(),e},function(e){return eU(),eW(e)})):e}function eB(){var e=eR[eR.length-1];eR.pop(),eK(e,!1)}function eK(e,t){var r,n=em;(t?!eC.echoes||e$++&&e===em:!e$||--e$&&e===em)||queueMicrotask(t?(function(e){++eF,eC.echoes&&0!=--eC.echoes||(eC.echoes=eC.awaits=eC.id=0),eR.push(em),eK(e,!0)}).bind(null,e):eB),e!==em&&(em=e,n===ep&&(ep.env=eZ()),eo&&(r=ep.env.Promise,t=e.env,(n.global||e.global)&&(Object.defineProperty(i,"Promise",t.PromiseProp),r.all=t.all,r.race=t.race,r.resolve=t.resolve,r.reject=t.reject,t.allSettled&&(r.allSettled=t.allSettled),t.any&&(r.any=t.any))))}function eZ(){var e=i.Promise;return eo?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(i,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject}:{}}function eq(e,t,r,n,i){var s=em;try{return eK(e,!0),t(r,n,i)}finally{eK(s,!1)}}function eV(e,t,r,n){return"function"!=typeof e?e:function(){var i=em;r&&eM(),eK(t,!0);try{return e.apply(this,arguments)}finally{eK(i,!1),n&&queueMicrotask(eU)}}}function eJ(e){Promise===ea&&0===eC.echoes?0===e$?e():enqueueNativeMicroTask(e):setTimeout(e,0)}-1===(""+M).indexOf("[native code]")&&(eM=eU=G);var eW=eb.reject,eG=String.fromCharCode(65535),eH="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",eQ="String expected.",eY=[],eX="__dbnames",e0="readonly",e1="readwrite";function e2(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}var e3={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function e4(e){return"string"!=typeof e||/\./.test(e)?function(e){return e}:function(t){return void 0===t[e]&&e in t&&delete(t=N(t))[e],t}}function e5(){throw V.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function e6(e,t){try{var r=e8(e),n=e8(t);if(r!==n)return"Array"===r?1:"Array"===n?-1:"binary"===r?1:"binary"===n?-1:"string"===r?1:"string"===n?-1:"Date"===r?1:"Date"!==n?NaN:-1;switch(r){case"number":case"Date":case"string":return t<e?1:e<t?-1:0;case"binary":return function(e,t){for(var r=e.length,n=t.length,i=r<n?r:n,s=0;s<i;++s)if(e[s]!==t[s])return e[s]<t[s]?-1:1;return r===n?0:r<n?-1:1}(e7(e),e7(t));case"Array":return function(e,t){for(var r=e.length,n=t.length,i=r<n?r:n,s=0;s<i;++s){var a=e6(e[s],t[s]);if(0!==a)return a}return r===n?0:r<n?-1:1}(e,t)}}catch(e){}return NaN}function e8(e){var t=typeof e;return"object"!=t?t:ArrayBuffer.isView(e)||"ArrayBuffer"===(e=P(e))?"binary":e}function e7(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}function e9(e,t,r){var n=e.schema.yProps;return n?(t&&0<r.numFailures&&(t=t.filter(function(e,t){return!r.failures[t]})),Promise.all(n.map(function(r){return r=r.updatesTable,t?e.db.table(r).where("k").anyOf(t).delete():e.db.table(r).clear()})).then(function(){return r})):r}var te=(tt.prototype.execute=function(e){var t=this["@@propmod"];if(void 0!==t.add){var r=t.add;if(a(r))return n(n([],a(e)?e:[],!0),r,!0).sort();if("number"==typeof r)return(Number(e)||0)+r;if("bigint"==typeof r)try{return BigInt(e)+r}catch(e){return BigInt(0)+r}throw TypeError("Invalid term ".concat(r))}if(void 0!==t.remove){var i=t.remove;if(a(i))return a(e)?e.filter(function(e){return!i.includes(e)}).sort():[];if("number"==typeof i)return Number(e)-i;if("bigint"==typeof i)try{return BigInt(e)-i}catch(e){return BigInt(0)-i}throw TypeError("Invalid subtrahend ".concat(i))}return(r=null==(r=t.replacePrefix)?void 0:r[0])&&"string"==typeof e&&e.startsWith(r)?t.replacePrefix[1]+e.substring(r.length):e},tt);function tt(e){this["@@propmod"]=e}function tr(e,t){for(var r=s(t),n=r.length,i=!1,a=0;a<n;++a){var o=r[a],l=t[o],u=w(e,o);l instanceof te?(_(e,o,l.execute(u)),i=!0):u!==l&&(_(e,o,l),i=!0)}return i}var tn=(ti.prototype._trans=function(e,t,r){var n=this._tx||em.trans,i=this.name,s=ei&&"u">typeof console&&console.createTask&&console.createTask("Dexie: ".concat("readonly"===e?"read":"write"," ").concat(this.name));function a(e,r,n){if(!n.schema[i])throw new V.NotFound("Table "+i+" not part of transaction");return t(n.idbtrans,n)}var o=eO();try{var l=n&&n.db._novip===this.db._novip?n===em.trans?n._promise(e,a,r):eD(function(){return n._promise(e,a,r)},{trans:n,transless:em.transless||em}):function e(t,r,n,i){if(t.idbdb&&(t._state.openComplete||em.letThrough||t._vip)){var s=t._createTransaction(r,n,t._dbSchema);try{s.create(),t._state.PR1398_maxLoop=3}catch(s){return s.name===q.InvalidState&&t.isOpen()&&0<--t._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),t.close({disableAutoOpen:!1}),t.open().then(function(){return e(t,r,n,i)})):eW(s)}return s._promise(r,function(e,t){return eD(function(){return em.trans=s,i(e,t,s)})}).then(function(e){if("readwrite"===r)try{s.idbtrans.commit()}catch(e){}return"readonly"===r?e:s._completion.then(function(){return e})})}if(t._state.openComplete)return eW(new V.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._state.autoOpen)return eW(new V.DatabaseClosed);t.open().catch(G)}return t._state.dbReadyPromise.then(function(){return e(t,r,n,i)})}(this.db,e,[this.name],a);return s&&(l._consoleTask=s,l=l.catch(function(e){return console.trace(e),eW(e)})),l}finally{o&&eT()}},ti.prototype.get=function(e,t){var r=this;return e&&e.constructor===Object?this.where(e).first(t):null==e?eW(new V.Type("Invalid argument to Table.get()")):this._trans("readonly",function(t){return r.core.get({trans:t,key:e}).then(function(e){return r.hook.reading.fire(e)})}).then(t)},ti.prototype.where=function(e){if("string"==typeof e)return new this.db.WhereClause(this,e);if(a(e))return new this.db.WhereClause(this,"[".concat(e.join("+"),"]"));var t=s(e);if(1===t.length)return this.where(t[0]).equals(e[t[0]]);var r=this.schema.indexes.concat(this.schema.primKey).filter(function(e){if(e.compound&&t.every(function(t){return 0<=e.keyPath.indexOf(t)})){for(var r=0;r<t.length;++r)if(-1===t.indexOf(e.keyPath[r]))return!1;return!0}return!1}).sort(function(e,t){return e.keyPath.length-t.keyPath.length})[0];if(r&&this.db._maxKey!==eG){var n=r.keyPath.slice(0,t.length);return this.where(n).equals(n.map(function(t){return e[t]}))}!r&&ei&&console.warn("The query ".concat(JSON.stringify(e)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(t.join("+"),"]"));var i=this.schema.idxByName,o=t.reduce(function(t,r){var n=t[0],s=t[1],t=i[r],o=e[r];return[n||t,n||!t?e2(s,t&&t.multi?function(e){return a(e=w(e,r))&&e.some(function(e){return 0===e6(o,e)})}:function(e){return 0===e6(o,w(e,r))}):s]},[null,null]),n=o[0],o=o[1];return n?this.where(n.name).equals(e[n.keyPath]).filter(o):r?this.filter(o):this.where(t).equals("")},ti.prototype.filter=function(e){return this.toCollection().and(e)},ti.prototype.count=function(e){return this.toCollection().count(e)},ti.prototype.offset=function(e){return this.toCollection().offset(e)},ti.prototype.limit=function(e){return this.toCollection().limit(e)},ti.prototype.each=function(e){return this.toCollection().each(e)},ti.prototype.toArray=function(e){return this.toCollection().toArray(e)},ti.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},ti.prototype.orderBy=function(e){return new this.db.Collection(new this.db.WhereClause(this,a(e)?"[".concat(e.join("+"),"]"):e))},ti.prototype.reverse=function(){return this.toCollection().reverse()},ti.prototype.mapToClass=function(e){var r,n=this.db,i=this.name;function s(){return null!==r&&r.apply(this,arguments)||this}(this.schema.mappedClass=e).prototype instanceof e5&&(function(e,r){if("function"!=typeof r&&null!==r)throw TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}(s,r=e),Object.defineProperty(s.prototype,"db",{get:function(){return n},enumerable:!1,configurable:!0}),s.prototype.table=function(){return i},e=s);for(var a=new Set,o=e.prototype;o;o=l(o))Object.getOwnPropertyNames(o).forEach(function(e){return a.add(e)});function u(t){if(!t)return t;var r,n=Object.create(e.prototype);for(r in t)if(!a.has(r))try{n[r]=t[r]}catch(e){}return n}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=u,this.hook("reading",u),e},ti.prototype.defineClass=function(){return this.mapToClass(function(e){o(this,e)})},ti.prototype.add=function(e,t){var r=this,n=this.schema.primKey,i=n.auto,s=n.keyPath,a=e;return s&&i&&(a=e4(s)(e)),this._trans("readwrite",function(e){return r.core.mutate({trans:e,type:"add",keys:null!=t?[t]:null,values:[a]})}).then(function(e){return e.numFailures?eb.reject(e.failures[0]):e.lastResult}).then(function(t){if(s)try{_(e,s,t)}catch(e){}return t})},ti.prototype.upsert=function(e,t){var r=this,n=this.schema.primKey.keyPath;return this._trans("readwrite",function(i){return r.core.get({trans:i,key:e}).then(function(s){var a=null!=s?s:{};return tr(a,t),n&&_(a,n,e),r.core.mutate({trans:i,type:"put",values:[a],keys:[e],upsert:!0,updates:{keys:[e],changeSpecs:[t]}}).then(function(e){return e.numFailures?eb.reject(e.failures[0]):!!s})})})},ti.prototype.update=function(e,t){return"object"!=typeof e||a(e)?this.where(":id").equals(e).modify(t):void 0===(e=w(e,this.schema.primKey.keyPath))?eW(new V.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(e).modify(t)},ti.prototype.put=function(e,t){var r=this,n=this.schema.primKey,i=n.auto,s=n.keyPath,a=e;return s&&i&&(a=e4(s)(e)),this._trans("readwrite",function(e){return r.core.mutate({trans:e,type:"put",values:[a],keys:null!=t?[t]:null})}).then(function(e){return e.numFailures?eb.reject(e.failures[0]):e.lastResult}).then(function(t){if(s)try{_(e,s,t)}catch(e){}return t})},ti.prototype.delete=function(e){var t=this;return this._trans("readwrite",function(r){return t.core.mutate({trans:r,type:"delete",keys:[e]}).then(function(r){return e9(t,[e],r)}).then(function(e){return e.numFailures?eb.reject(e.failures[0]):void 0})})},ti.prototype.clear=function(){var e=this;return this._trans("readwrite",function(t){return e.core.mutate({trans:t,type:"deleteRange",range:e3}).then(function(t){return e9(e,null,t)})}).then(function(e){return e.numFailures?eb.reject(e.failures[0]):void 0})},ti.prototype.bulkGet=function(e){var t=this;return this._trans("readonly",function(r){return t.core.getMany({keys:e,trans:r}).then(function(e){return e.map(function(e){return t.hook.reading.fire(e)})})})},ti.prototype.bulkAdd=function(e,t,r){var n=this,i=Array.isArray(t)?t:void 0,s=(r=r||(i?void 0:t))?r.allKeys:void 0;return this._trans("readwrite",function(t){var r=n.schema.primKey,a=r.auto,r=r.keyPath;if(r&&i)throw new V.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(i&&i.length!==e.length)throw new V.InvalidArgument("Arguments objects and keys must have the same length");var o=e.length,r=r&&a?e.map(e4(r)):e;return n.core.mutate({trans:t,type:"add",keys:i,values:r,wantResults:s}).then(function(e){var t=e.numFailures,r=e.results,i=e.lastResult,e=e.failures;if(0===t)return s?r:i;throw new Z("".concat(n.name,".bulkAdd(): ").concat(t," of ").concat(o," operations failed"),e)})})},ti.prototype.bulkPut=function(e,t,r){var n=this,i=Array.isArray(t)?t:void 0,s=(r=r||(i?void 0:t))?r.allKeys:void 0;return this._trans("readwrite",function(t){var r=n.schema.primKey,a=r.auto,r=r.keyPath;if(r&&i)throw new V.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(i&&i.length!==e.length)throw new V.InvalidArgument("Arguments objects and keys must have the same length");var o=e.length,r=r&&a?e.map(e4(r)):e;return n.core.mutate({trans:t,type:"put",keys:i,values:r,wantResults:s}).then(function(e){var t=e.numFailures,r=e.results,i=e.lastResult,e=e.failures;if(0===t)return s?r:i;throw new Z("".concat(n.name,".bulkPut(): ").concat(t," of ").concat(o," operations failed"),e)})})},ti.prototype.bulkUpdate=function(e){var t=this,r=this.core,n=e.map(function(e){return e.key}),i=e.map(function(e){return e.changes}),s=[];return this._trans("readwrite",function(a){return r.getMany({trans:a,keys:n,cache:"clone"}).then(function(o){var l=[],u=[];e.forEach(function(e,r){var n=e.key,i=e.changes,a=o[r];if(a){for(var c=0,d=Object.keys(i);c<d.length;c++){var h=d[c],f=i[h];if(h===t.schema.primKey.keyPath){if(0!==e6(f,n))throw new V.Constraint("Cannot update primary key in bulkUpdate()")}else _(a,h,f)}s.push(r),l.push(n),u.push(a)}});var c=l.length;return r.mutate({trans:a,type:"put",keys:l,values:u,updates:{keys:n,changeSpecs:i}}).then(function(e){var r=e.numFailures,n=e.failures;if(0===r)return c;for(var i=0,a=Object.keys(n);i<a.length;i++){var o,l=a[i],u=s[Number(l)];null!=u&&(o=n[l],delete n[l],n[u]=o)}throw new Z("".concat(t.name,".bulkUpdate(): ").concat(r," of ").concat(c," operations failed"),n)})})})},ti.prototype.bulkDelete=function(e){var t=this,r=e.length;return this._trans("readwrite",function(r){return t.core.mutate({trans:r,type:"delete",keys:e}).then(function(r){return e9(t,e,r)})}).then(function(e){var n=e.numFailures,i=e.lastResult,e=e.failures;if(0===n)return i;throw new Z("".concat(t.name,".bulkDelete(): ").concat(n," of ").concat(r," operations failed"),e)})},ti);function ti(){}function ts(e){function t(t,n){if(n){for(var i=arguments.length,s=Array(i-1);--i;)s[i-1]=arguments[i];return r[t].subscribe.apply(null,s),e}if("string"==typeof t)return r[t]}var r={};t.addEventType=o;for(var n=1,i=arguments.length;n<i;++n)o(arguments[n]);return t;function o(e,n,i){if("object"!=typeof e){n=n||er;var l={subscribers:[],fire:i=i||G,subscribe:function(e){-1===l.subscribers.indexOf(e)&&(l.subscribers.push(e),l.fire=n(l.fire,e))},unsubscribe:function(e){l.subscribers=l.subscribers.filter(function(t){return t!==e}),l.fire=l.subscribers.reduce(n,i)}};return r[e]=t[e]=l}s(e).forEach(function(t){var r=e[t];if(a(r))o(t,e[t][0],e[t][1]);else{if("asap"!==r)throw new V.InvalidArgument("Invalid event config");var n=o(t,H,function(){for(var e=arguments.length,t=Array(e);e--;)t[e]=arguments[e];n.subscribers.forEach(function(e){x(function(){e.apply(null,t)})})})}})}}function ta(e,t){return p(t).from({prototype:e}),t}function to(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function tl(e,t){e.filter=e2(e.filter,t)}function tu(e,t,r){var n=e.replayFilter;e.replayFilter=n?function(){return e2(n(),t())}:t,e.justLimit=r&&!n}function tc(e,t){if(e.isPrimKey)return t.primaryKey;var r=t.getIndexByKeyPath(e.index);if(!r)throw new V.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return r}function td(e,t,r){var n=tc(e,t.schema);return t.openCursor({trans:r,values:!e.keysOnly,reverse:"prev"===e.dir,unique:!!e.unique,query:{index:n,range:e.range}})}function th(e,t,r,n){var i=e.replayFilter?e2(e.filter,e.replayFilter()):e.filter;if(e.or){var s={},a=function(e,r,n){var a,o;i&&!i(r,n,function(e){return r.stop(e)},function(e){return r.fail(e)})||("[object ArrayBuffer]"==(o=""+(a=r.primaryKey))&&(o=""+new Uint8Array(a)),c(s,o)||(s[o]=!0,t(e,r,n)))};return Promise.all([e.or._iterate(a,r),tf(td(e,n,r),e.algorithm,a,!e.keysOnly&&e.valueMapper)])}return tf(td(e,n,r),e2(e.algorithm,i),t,!e.keysOnly&&e.valueMapper)}function tf(e,t,r,n){var i=eP(n?function(e,t,i){return r(n(e),t,i)}:r);return e.then(function(e){if(e)return e.start(function(){var r=function(){return e.continue()};t&&!t(e,function(e){return r=e},function(t){e.stop(t),r=G},function(t){e.fail(t),r=G})||i(e.value,e,function(e){return r=e}),r()})})}var tp=(tm.prototype._read=function(e,t){var r=this._ctx;return r.error?r.table._trans(null,eW.bind(null,r.error)):r.table._trans("readonly",e).then(t)},tm.prototype._write=function(e){var t=this._ctx;return t.error?t.table._trans(null,eW.bind(null,t.error)):t.table._trans("readwrite",e,"locked")},tm.prototype._addAlgorithm=function(e){var t=this._ctx;t.algorithm=e2(t.algorithm,e)},tm.prototype._iterate=function(e,t){return th(this._ctx,e,t,this._ctx.table.core)},tm.prototype.clone=function(e){var t=Object.create(this.constructor.prototype),r=Object.create(this._ctx);return e&&o(r,e),t._ctx=r,t},tm.prototype.raw=function(){return this._ctx.valueMapper=null,this},tm.prototype.each=function(e){var t=this._ctx;return this._read(function(r){return th(t,e,r,t.table.core)})},tm.prototype.count=function(e){var t=this;return this._read(function(e){var r=t._ctx,n=r.table.core;if(to(r,!0))return n.count({trans:e,query:{index:tc(r,n.schema),range:r.range}}).then(function(e){return Math.min(e,r.limit)});var i=0;return th(r,function(){return++i,!1},e,n).then(function(){return i})}).then(e)},tm.prototype.sortBy=function(e,t){var r=e.split(".").reverse(),n=r[0],i=r.length-1;function s(e,t){return t?s(e[r[t]],t-1):e[n]}var a="next"===this._ctx.dir?1:-1;function o(e,t){return e6(s(e,i),s(t,i))*a}return this.toArray(function(e){return e.sort(o)}).then(t)},tm.prototype.toArray=function(e){var t=this;return this._read(function(e){var r=t._ctx;if("next"===r.dir&&to(r,!0)&&0<r.limit){var n=r.valueMapper,i=tc(r,r.table.core.schema);return r.table.core.query({trans:e,limit:r.limit,values:!0,query:{index:i,range:r.range}}).then(function(e){return e=e.result,n?e.map(n):e})}var s=[];return th(r,function(e){return s.push(e)},e,r.table.core).then(function(){return s})},e)},tm.prototype.offset=function(e){var t=this._ctx;return e<=0||(t.offset+=e,to(t)?tu(t,function(){var t=e;return function(e,r){return 0===t||(1===t?--t:r(function(){e.advance(t),t=0}),!1)}}):tu(t,function(){var t=e;return function(){return--t<0}})),this},tm.prototype.limit=function(e){return this._ctx.limit=Math.min(this._ctx.limit,e),tu(this._ctx,function(){var t=e;return function(e,r,n){return--t<=0&&r(n),0<=t}},!0),this},tm.prototype.until=function(e,t){return tl(this._ctx,function(r,n,i){return!e(r.value)||(n(i),t)}),this},tm.prototype.first=function(e){return this.limit(1).toArray(function(e){return e[0]}).then(e)},tm.prototype.last=function(e){return this.reverse().first(e)},tm.prototype.filter=function(e){var t;return tl(this._ctx,function(t){return e(t.value)}),(t=this._ctx).isMatch=e2(t.isMatch,e),this},tm.prototype.and=function(e){return this.filter(e)},tm.prototype.or=function(e){return new this.db.WhereClause(this._ctx.table,e,this)},tm.prototype.reverse=function(){return this._ctx.dir="prev"===this._ctx.dir?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},tm.prototype.desc=function(){return this.reverse()},tm.prototype.eachKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(t,r){e(r.key,r)})},tm.prototype.eachUniqueKey=function(e){return this._ctx.unique="unique",this.eachKey(e)},tm.prototype.eachPrimaryKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(t,r){e(r.primaryKey,r)})},tm.prototype.keys=function(e){var t=this._ctx;t.keysOnly=!t.isMatch;var r=[];return this.each(function(e,t){r.push(t.key)}).then(function(){return r}).then(e)},tm.prototype.primaryKeys=function(e){var t=this._ctx;if("next"===t.dir&&to(t,!0)&&0<t.limit)return this._read(function(e){var r=tc(t,t.table.core.schema);return t.table.core.query({trans:e,values:!1,limit:t.limit,query:{index:r,range:t.range}})}).then(function(e){return e.result}).then(e);t.keysOnly=!t.isMatch;var r=[];return this.each(function(e,t){r.push(t.primaryKey)}).then(function(){return r}).then(e)},tm.prototype.uniqueKeys=function(e){return this._ctx.unique="unique",this.keys(e)},tm.prototype.firstKey=function(e){return this.limit(1).keys(function(e){return e[0]}).then(e)},tm.prototype.lastKey=function(e){return this.reverse().firstKey(e)},tm.prototype.distinct=function(){var e=this._ctx,e=e.index&&e.table.schema.idxByName[e.index];if(!e||!e.multi)return this;var t={};return tl(this._ctx,function(e){var r=e.primaryKey.toString(),e=c(t,r);return t[r]=!0,!e}),this},tm.prototype.modify=function(e){var t=this,r=this._ctx;return this._write(function(n){var i="function"==typeof e?e:function(t){return tr(t,e)},a=r.table.core,o=a.schema.primaryKey,l=o.outbound,u=o.extractKey,c=200,o=t.db._options.modifyChunkSize;function d(e,t){var r=t.failures,t=t.numFailures;f+=e-t;for(var n=0,i=s(r);n<i.length;n++){var a=i[n];h.push(r[a])}}o&&(c="object"==typeof o?o[a.name]||o["*"]||200:o);var h=[],f=0,p=[],m=e===tg;return t.clone().primaryKeys().then(function(t){var s=to(r)&&r.limit===1/0&&("function"!=typeof e||m)&&{index:r.index,range:r.range};return(function o(h){var f=Math.min(c,t.length-h),p=t.slice(h,h+f);return(m?Promise.resolve([]):a.getMany({trans:n,keys:p,cache:"immutable"})).then(function(g){var y=[],v=[],b=l?[]:null,x=m?p:[];if(!m)for(var w=0;w<f;++w){var _=g[w],k={value:N(_),primKey:t[h+w]};!1!==i.call(k,k.value,k)&&(null==k.value?x.push(t[h+w]):l||0===e6(u(_),u(k.value))?(v.push(k.value),l&&b.push(t[h+w])):(x.push(t[h+w]),y.push(k.value)))}return Promise.resolve(0<y.length&&a.mutate({trans:n,type:"add",values:y}).then(function(e){for(var t in e.failures)x.splice(parseInt(t),1);d(y.length,e)})).then(function(){return(0<v.length||s&&"object"==typeof e)&&a.mutate({trans:n,type:"put",keys:b,values:v,criteria:s,changeSpec:"function"!=typeof e&&e,isAdditionalChunk:0<h}).then(function(e){return d(v.length,e)})}).then(function(){return(0<x.length||s&&m)&&a.mutate({trans:n,type:"delete",keys:x,criteria:s,isAdditionalChunk:0<h}).then(function(e){return e9(r.table,x,e)}).then(function(e){return d(x.length,e)})}).then(function(){return t.length>h+f&&o(h+c)})})})(0).then(function(){if(0<h.length)throw new K("Error modifying one or more objects",h,f,p);return t.length})})})},tm.prototype.delete=function(){var e=this._ctx,t=e.range;return to(e)&&!e.table.schema.yProps&&(e.isPrimKey||3===t.type)?this._write(function(r){var n=e.table.core.schema.primaryKey;return e.table.core.count({trans:r,query:{index:n,range:t}}).then(function(n){return e.table.core.mutate({trans:r,type:"deleteRange",range:t}).then(function(e){var t=e.failures,e=e.numFailures;if(e)throw new K("Could not delete some values",Object.keys(t).map(function(e){return t[e]}),n-e);return n-e})})}):this.modify(tg)},tm);function tm(){}var tg=function(e,t){return t.value=null};function ty(e,t){return e<t?-1:+(e!==t)}function tv(e,t){return t<e?-1:+(e!==t)}function tb(e,t,r){return(e=e instanceof tj?new e.Collection(e):e)._ctx.error=new(r||TypeError)(t),e}function tx(e){return new e.Collection(e,function(){return tk("")}).limit(0)}function tw(e,t,r,n){var i,s,a,o,l,u,c,d=r.length;if(!r.every(function(e){return"string"==typeof e}))return tb(e,eQ);function h(e){i="next"===e?function(e){return e.toUpperCase()}:function(e){return e.toLowerCase()},s="next"===e?function(e){return e.toLowerCase()}:function(e){return e.toUpperCase()},a="next"===e?ty:tv;var t=r.map(function(e){return{lower:s(e),upper:i(e)}}).sort(function(e,t){return a(e.lower,t.lower)});o=t.map(function(e){return e.upper}),l=t.map(function(e){return e.lower}),c="next"===(u=e)?"":n}h("next"),(e=new e.Collection(e,function(){return t_(o[0],l[d-1]+n)}))._ondirectionchange=function(e){h(e)};var f=0;return e._addAlgorithm(function(e,r,n){var i=e.key;if("string"!=typeof i)return!1;var h=s(i);if(t(h,l,f))return!0;for(var p=null,m=f;m<d;++m){var g=function(e,t,r,n,i,s){for(var a=Math.min(e.length,n.length),o=-1,l=0;l<a;++l){var u=t[l];if(u!==n[l])return 0>i(e[l],r[l])?e.substr(0,l)+r[l]+r.substr(l+1):0>i(e[l],n[l])?e.substr(0,l)+n[l]+r.substr(l+1):0<=o?e.substr(0,o)+t[o]+r.substr(o+1):null;0>i(e[l],u)&&(o=l)}return a<n.length&&"next"===s?e+r.substr(e.length):a<e.length&&"prev"===s?e.substr(0,r.length):o<0?null:e.substr(0,o)+n[o]+r.substr(o+1)}(i,h,o[m],l[m],a,u);null===g&&null===p?f=m+1:(null===p||0<a(p,g))&&(p=g)}return r(null!==p?function(){e.continue(p+c)}:n),!1}),e}function t_(e,t,r,n){return{type:2,lower:e,upper:t,lowerOpen:r,upperOpen:n}}function tk(e){return{type:1,lower:e,upper:e}}var tj=(Object.defineProperty(tE.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),tE.prototype.between=function(e,t,r,n){r=!1!==r,n=!0===n;try{return 0<this._cmp(e,t)||0===this._cmp(e,t)&&(r||n)&&(!r||!n)?tx(this):new this.Collection(this,function(){return t_(e,t,!r,!n)})}catch(e){return tb(this,eH)}},tE.prototype.equals=function(e){return null==e?tb(this,eH):new this.Collection(this,function(){return tk(e)})},tE.prototype.above=function(e){return null==e?tb(this,eH):new this.Collection(this,function(){return t_(e,void 0,!0)})},tE.prototype.aboveOrEqual=function(e){return null==e?tb(this,eH):new this.Collection(this,function(){return t_(e,void 0,!1)})},tE.prototype.below=function(e){return null==e?tb(this,eH):new this.Collection(this,function(){return t_(void 0,e,!1,!0)})},tE.prototype.belowOrEqual=function(e){return null==e?tb(this,eH):new this.Collection(this,function(){return t_(void 0,e)})},tE.prototype.startsWith=function(e){return"string"!=typeof e?tb(this,eQ):this.between(e,e+eG,!0,!0)},tE.prototype.startsWithIgnoreCase=function(e){return""===e?this.startsWith(e):tw(this,function(e,t){return 0===e.indexOf(t[0])},[e],eG)},tE.prototype.equalsIgnoreCase=function(e){return tw(this,function(e,t){return e===t[0]},[e],"")},tE.prototype.anyOfIgnoreCase=function(){var e=F.apply($,arguments);return 0===e.length?tx(this):tw(this,function(e,t){return -1!==t.indexOf(e)},e,"")},tE.prototype.startsWithAnyOfIgnoreCase=function(){var e=F.apply($,arguments);return 0===e.length?tx(this):tw(this,function(e,t){return t.some(function(t){return 0===e.indexOf(t)})},e,eG)},tE.prototype.anyOf=function(){var e=this,t=F.apply($,arguments),r=this._cmp;try{t.sort(r)}catch(e){return tb(this,eH)}if(0===t.length)return tx(this);var n=new this.Collection(this,function(){return t_(t[0],t[t.length-1])});n._ondirectionchange=function(n){r="next"===n?e._ascending:e._descending,t.sort(r)};var i=0;return n._addAlgorithm(function(e,n,s){for(var a=e.key;0<r(a,t[i]);)if(++i===t.length)return n(s),!1;return 0===r(a,t[i])||(n(function(){e.continue(t[i])}),!1)}),n},tE.prototype.notEqual=function(e){return this.inAnyRange([[-1/0,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},tE.prototype.noneOf=function(){var e=F.apply($,arguments);if(0===e.length)return new this.Collection(this);try{e.sort(this._ascending)}catch(e){return tb(this,eH)}var t=e.reduce(function(e,t){return e?e.concat([[e[e.length-1][1],t]]):[[-1/0,t]]},null);return t.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(t,{includeLowers:!1,includeUppers:!1})},tE.prototype.inAnyRange=function(e,t){var r=this,n=this._cmp,i=this._ascending,s=this._descending,a=this._min,o=this._max;if(0===e.length)return tx(this);if(!e.every(function(e){return void 0!==e[0]&&void 0!==e[1]&&0>=i(e[0],e[1])}))return tb(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",V.InvalidArgument);var l,u=!t||!1!==t.includeLowers,c=t&&!0===t.includeUppers,d=i;function h(e,t){return d(e[0],t[0])}try{(l=e.reduce(function(e,t){for(var r=0,i=e.length;r<i;++r){var s=e[r];if(0>n(t[0],s[1])&&0<n(t[1],s[0])){s[0]=a(s[0],t[0]),s[1]=o(s[1],t[1]);break}}return r===i&&e.push(t),e},[])).sort(h)}catch(e){return tb(this,eH)}var f=0,p=c?function(e){return 0<i(e,l[f][1])}:function(e){return 0<=i(e,l[f][1])},m=u?function(e){return 0<s(e,l[f][0])}:function(e){return 0<=s(e,l[f][0])},g=p,e=new this.Collection(this,function(){return t_(l[0][0],l[l.length-1][1],!u,!c)});return e._ondirectionchange=function(e){d="next"===e?(g=p,i):(g=m,s),l.sort(h)},e._addAlgorithm(function(e,t,n){for(var s=e.key;g(s);)if(++f===l.length)return t(n),!1;return!p(s)&&!m(s)||(0===r._cmp(s,l[f][1])||0===r._cmp(s,l[f][0])||t(function(){d===i?e.continue(l[f][0]):e.continue(l[f][1])}),!1)}),e},tE.prototype.startsWithAnyOf=function(){var e=F.apply($,arguments);return e.every(function(e){return"string"==typeof e})?0===e.length?tx(this):this.inAnyRange(e.map(function(e){return[e,e+eG]})):tb(this,"startsWithAnyOf() only works with strings")},tE);function tE(){}function tS(e){return eP(function(t){return tO(t),e(t.target.error),!1})}function tO(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}var tT="storagemutated",tN="x-storagemutated-1",tA=ts(null,tT),tP=(tC.prototype._lock=function(){return b(!em.global),++this._reculock,1!==this._reculock||em.global||(em.lockOwnerFor=this),this},tC.prototype._unlock=function(){if(b(!em.global),0==--this._reculock)for(em.global||(em.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var e=this._blockedFuncs.shift();try{eq(e[1],e[0])}catch(e){}}return this},tC.prototype._locked=function(){return this._reculock&&em.lockOwnerFor!==this},tC.prototype.create=function(e){var t=this;if(!this.mode)return this;var r=this.db.idbdb,n=this.db._state.dbOpenError;if(b(!this.idbtrans),!e&&!r)switch(n&&n.name){case"DatabaseClosedError":throw new V.DatabaseClosed(n);case"MissingAPIError":throw new V.MissingAPI(n.message,n);default:throw new V.OpenFailed(n)}if(!this.active)throw new V.TransactionInactive;return b(null===this._completion._state),(e=this.idbtrans=e||(this.db.core||r).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=eP(function(r){tO(r),t._reject(e.error)}),e.onabort=eP(function(r){tO(r),t.active&&t._reject(new V.Abort(e.error)),t.active=!1,t.on("abort").fire(r)}),e.oncomplete=eP(function(){t.active=!1,t._resolve(),"mutatedParts"in e&&tA.storagemutated.fire(e.mutatedParts)}),this},tC.prototype._promise=function(e,t,r){var n=this;if("readwrite"===e&&"readwrite"!==this.mode)return eW(new V.ReadOnly("Transaction is readonly"));if(!this.active)return eW(new V.TransactionInactive);if(this._locked())return new eb(function(i,s){n._blockedFuncs.push([function(){n._promise(e,t,r).then(i,s)},em])});if(r)return eD(function(){var e=new eb(function(e,r){n._lock();var i=t(e,r,n);i&&i.then&&i.then(e,r)});return e.finally(function(){return n._unlock()}),e._lib=!0,e});var i=new eb(function(e,r){var i=t(e,r,n);i&&i.then&&i.then(e,r)});return i._lib=!0,i},tC.prototype._root=function(){return this.parent?this.parent._root():this},tC.prototype.waitFor=function(e){var t,r=this._root(),n=eb.resolve(e);r._waitingFor?r._waitingFor=r._waitingFor.then(function(){return n}):(r._waitingFor=n,r._waitingQueue=[],t=r.idbtrans.objectStore(r.storeNames[0]),function e(){for(++r._spinCount;r._waitingQueue.length;)r._waitingQueue.shift()();r._waitingFor&&(t.get(-1/0).onsuccess=e)}());var i=r._waitingFor;return new eb(function(e,t){n.then(function(t){return r._waitingQueue.push(eP(e.bind(null,t)))},function(e){return r._waitingQueue.push(eP(t.bind(null,e)))}).finally(function(){r._waitingFor===i&&(r._waitingFor=null)})})},tC.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new V.Abort))},tC.prototype.table=function(e){var t=this._memoizedTables||(this._memoizedTables={});if(c(t,e))return t[e];var r=this.schema[e];if(!r)throw new V.NotFound("Table "+e+" not part of transaction");return(r=new this.db.Table(e,r,this)).core=this.db.core.table(e),t[e]=r},tC);function tC(){}function tz(e,t,r,n,i,s,a,o){return{name:e,keyPath:t,unique:r,multi:n,auto:i,compound:s,src:(r&&!a?"&":"")+(n?"*":"")+(i?"++":"")+tR(t),type:o}}function tR(e){return"string"==typeof e?e:e?"["+[].join.call(e,"+")+"]":""}function t$(e,t,r){var n;return{name:e,primKey:t,indexes:r,mappedClass:null,idxByName:(n=function(e){return[e.name,e]},r.reduce(function(e,t,r){return(r=n(t,r))&&(e[r[0]]=r[1]),e},{}))}}var tF=function(e){try{return e.only([[]]),tF=function(){return[[]]},[[]]}catch(e){return tF=function(){return eG},eG}};function tI(e){return null==e?function(){}:"string"==typeof e?1===e.split(".").length?function(t){return t[e]}:function(t){return w(t,e)}:function(t){return w(t,e)}}function tD(e){return[].slice.call(e)}var tM=0;function tU(e){return null==e?":id":"string"==typeof e?e:"[".concat(e.join("+"),"]")}function tL(e,t){var n,i,s,o,l=t.db,t=(n=e._middlewares,i=e._deps,s=t,o=i.IDBKeyRange,i.indexedDB,{dbcore:(s=function(e,t,r){function n(e){if(3===e.type)return null;if(4===e.type)throw Error("Cannot convert never type to IDBKeyRange");var r=e.lower,n=e.upper,i=e.lowerOpen,e=e.upperOpen;return void 0===r?void 0===n?null:t.upperBound(n,!!e):void 0===n?t.lowerBound(r,!!i):t.bound(r,n,!!i,!!e)}var i,s,o=(i=r,s=tD(e.objectStoreNames),{schema:{name:e.name,tables:s.map(function(e){return i.objectStore(e)}).map(function(e){var t=e.keyPath,r=e.autoIncrement,n=a(t),i={},r={name:e.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:null==t,compound:n,keyPath:t,autoIncrement:r,unique:!0,extractKey:tI(t)},indexes:tD(e.indexNames).map(function(t){return e.index(t)}).map(function(e){var t=e.name,r=e.unique,n=e.multiEntry,e=e.keyPath,n={name:t,compound:a(e),keyPath:e,unique:r,multiEntry:n,extractKey:tI(e)};return i[tU(e)]=n}),getIndexByKeyPath:function(e){return i[tU(e)]}};return i[":id"]=r.primaryKey,null!=t&&(i[tU(t)]=r.primaryKey),r})},hasGetAll:0<s.length&&"getAll"in i.objectStore(s[0])&&!("u">typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),r=o.schema,l=o.hasGetAll,o=r.tables.map(function(e){var t=e.name;return{name:t,schema:e,mutate:function(e){var r=e.trans,i=e.type,s=e.keys,a=e.values,o=e.range;return new Promise(function(e,l){e=eP(e);var u=r.objectStore(t),c=null==u.keyPath,d="put"===i||"add"===i;if(!d&&"delete"!==i&&"deleteRange"!==i)throw Error("Invalid operation type: "+i);var h,f=(s||a||{length:1}).length;if(s&&a&&s.length!==a.length)throw Error("Given keys array must have same length as given values array.");if(0===f)return e({numFailures:0,failures:{},results:[],lastResult:void 0});function p(e){++y,tO(e)}var m=[],g=[],y=0;if("deleteRange"===i){if(4===o.type)return e({numFailures:y,failures:g,results:[],lastResult:void 0});3===o.type?m.push(h=u.clear()):m.push(h=u.delete(n(o)))}else{var c=d?c?[a,s]:[a,null]:[s,null],v=c[0],b=c[1];if(d)for(var x=0;x<f;++x)m.push(h=b&&void 0!==b[x]?u[i](v[x],b[x]):u[i](v[x])),h.onerror=p;else for(x=0;x<f;++x)m.push(h=u[i](v[x])),h.onerror=p}function w(t){t=t.target.result,m.forEach(function(e,t){return null!=e.error&&(g[t]=e.error)}),e({numFailures:y,failures:g,results:"delete"===i?s:m.map(function(e){return e.result}),lastResult:t})}h.onerror=function(e){p(e),w(e)},h.onsuccess=w})},getMany:function(e){var r=e.trans,n=e.keys;return new Promise(function(e,i){e=eP(e);for(var s,a=r.objectStore(t),o=n.length,l=Array(o),u=0,c=0,d=function(t){l[(t=t.target)._pos]=t.result,++c===u&&e(l)},h=tS(i),f=0;f<o;++f)null!=n[f]&&((s=a.get(n[f]))._pos=f,s.onsuccess=d,s.onerror=h,++u);0===u&&e(l)})},get:function(e){var r=e.trans,n=e.key;return new Promise(function(e,i){e=eP(e);var s=r.objectStore(t).get(n);s.onsuccess=function(t){return e(t.target.result)},s.onerror=tS(i)})},query:function(e){return new Promise(function(r,i){r=eP(r);var s,a,o,u=e.trans,c=e.values,d=e.limit,h=e.query,f=d===1/0?void 0:d,p=h.index,h=h.range,u=u.objectStore(t),p=p.isPrimaryKey?u:u.index(p.name),h=n(h);if(0===d)return r({result:[]});l?((f=c?p.getAll(h,f):p.getAllKeys(h,f)).onsuccess=function(e){return r({result:e.target.result})},f.onerror=tS(i)):(s=0,a=!c&&"openKeyCursor"in p?p.openKeyCursor(h):p.openCursor(h),o=[],a.onsuccess=function(e){var t=a.result;return t?(o.push(c?t.value:t.primaryKey),++s===d?r({result:o}):void t.continue()):r({result:o})},a.onerror=tS(i))})},openCursor:function(e){var r=e.trans,i=e.values,s=e.query,a=e.reverse,o=e.unique;return new Promise(function(e,l){e=eP(e);var u=s.index,c=s.range,d=r.objectStore(t),d=u.isPrimaryKey?d:d.index(u.name),u=a?o?"prevunique":"prev":o?"nextunique":"next",h=!i&&"openKeyCursor"in d?d.openKeyCursor(n(c),u):d.openCursor(n(c),u);h.onerror=tS(l),h.onsuccess=eP(function(t){var n,i,s,a,o=h.result;o?(o.___id=++tM,o.done=!1,n=o.continue.bind(o),i=(i=o.continuePrimaryKey)&&i.bind(o),s=o.advance.bind(o),a=function(){throw Error("Cursor not stopped")},o.trans=r,o.stop=o.continue=o.continuePrimaryKey=o.advance=function(){throw Error("Cursor not started")},o.fail=eP(l),o.next=function(){var e=this,t=1;return this.start(function(){return t--?e.continue():e.stop()}).then(function(){return e})},o.start=function(e){function t(){if(h.result)try{e()}catch(e){o.fail(e)}else o.done=!0,o.start=function(){throw Error("Cursor behind last entry")},o.stop()}var r=new Promise(function(e,t){e=eP(e),h.onerror=tS(t),o.fail=t,o.stop=function(t){o.stop=o.continue=o.continuePrimaryKey=o.advance=a,e(t)}});return h.onsuccess=eP(function(e){h.onsuccess=t,t()}),o.continue=n,o.continuePrimaryKey=i,o.advance=s,t(),r},e(o)):e(null)},l)})},count:function(e){var r=e.query,i=e.trans,s=r.index,a=r.range;return new Promise(function(e,r){var o=i.objectStore(t),l=s.isPrimaryKey?o:o.index(s.name),o=n(a),l=o?l.count(o):l.count();l.onsuccess=eP(function(t){return e(t.target.result)}),l.onerror=tS(r)})}}}),u={};return o.forEach(function(e){return u[e.name]=e}),{stack:"dbcore",transaction:e.transaction.bind(e),table:function(e){if(!u[e])throw Error("Table '".concat(e,"' not found"));return u[e]},MIN_KEY:-1/0,MAX_KEY:tF(t),schema:r}}(l,o,s),n.dbcore.reduce(function(e,t){return t=t.create,r(r({},e),t(e))},s))});e.core=t.dbcore,e.tables.forEach(function(t){var r=t.name;e.core.schema.tables.some(function(e){return e.name===r})&&(t.core=e.core.table(r),e[r]instanceof e.Table&&(e[r].core=t.core))})}function tB(e,t,r,n){r.forEach(function(r){var i=n[r];t.forEach(function(t){var n=function e(t,r){return m(t,r)||(t=l(t))&&e(t,r)}(t,r);(!n||"value"in n&&void 0===n.value)&&(t===e.Transaction.prototype||t instanceof e.Transaction?f(t,r,{get:function(){return this.table(r)},set:function(e){h(this,r,{value:e,writable:!0,configurable:!0,enumerable:!0})}}):t[r]=new e.Table(r,i))})})}function tK(e,t){t.forEach(function(t){for(var r in t)t[r]instanceof e.Table&&delete t[r]})}function tZ(e,t){return e._cfg.version-t._cfg.version}function tq(e,t){var r,n={del:[],add:[],change:[]};for(r in e)t[r]||n.del.push(r);for(r in t){var i=e[r],s=t[r];if(i){var a={name:r,def:s,recreate:!1,del:[],add:[],change:[]};if(""+(i.primKey.keyPath||"")!=""+(s.primKey.keyPath||"")||i.primKey.auto!==s.primKey.auto)a.recreate=!0,n.change.push(a);else{var o=i.idxByName,l=s.idxByName,u=void 0;for(u in o)l[u]||a.del.push(u);for(u in l){var c=o[u],d=l[u];c?c.src!==d.src&&a.change.push(d):a.add.push(d)}(0<a.del.length||0<a.add.length||0<a.change.length)&&n.change.push(a)}}else n.add.push([r,s])}return n}function tV(e,t,r,n){var i=e.db.createObjectStore(t,r.keyPath?{keyPath:r.keyPath,autoIncrement:r.auto}:{autoIncrement:r.auto});return n.forEach(function(e){return tW(i,e)}),i}function tJ(e,t){s(e).forEach(function(r){t.db.objectStoreNames.contains(r)||(ei&&console.debug("Dexie: Creating missing table",r),tV(t,r,e[r].primKey,e[r].indexes))})}function tW(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function tG(e,t,r){var n={};return y(t.objectStoreNames,0).forEach(function(e){for(var t=r.objectStore(e),i=tz(tR(l=t.keyPath),l||"",!0,!1,!!t.autoIncrement,l&&"string"!=typeof l,!0),s=[],a=0;a<t.indexNames.length;++a){var o=t.index(t.indexNames[a]),l=o.keyPath,o=tz(o.name,l,!!o.unique,!!o.multiEntry,!1,l&&"string"!=typeof l,!1);s.push(o)}n[e]=t$(e,i,s)}),n}function tH(e,t,r){for(var n=r.db.objectStoreNames,s=0;s<n.length;++s){var a=n[s],o=r.objectStore(a);e._hasGetAll="getAll"in o;for(var l=0;l<o.indexNames.length;++l){var u=o.indexNames[l],c=o.index(u).keyPath,d="string"==typeof c?c:"["+y(c).join("+")+"]";!t[a]||(c=t[a].idxByName[d])&&(c.name=u,delete t[a].idxByName[d],t[a].idxByName[u]=c)}}"u">typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&i.WorkerGlobalScope&&i instanceof i.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}function tQ(e){return e.split(",").map(function(e,t){var r=e.split(":"),n=null==(i=r[1])?void 0:i.trim(),i=(e=r[0].trim()).replace(/([&*]|\+\+)/g,""),r=/^\[/.test(i)?i.match(/^\[(.*)\]$/)[1].split("+"):i;return tz(i,r||null,/\&/.test(e),/\*/.test(e),/\+\+/.test(e),a(r),0===t,n)})}var tY=(tX.prototype._createTableSchema=t$,tX.prototype._parseIndexSyntax=tQ,tX.prototype._parseStoresSpec=function(e,t){var r=this;s(e).forEach(function(n){if(null!==e[n]){var i=r._parseIndexSyntax(e[n]),s=i.shift();if(!s)throw new V.Schema("Invalid schema for table "+n+": "+e[n]);if(s.unique=!0,s.multi)throw new V.Schema("Primary key cannot be multiEntry*");i.forEach(function(e){if(e.auto)throw new V.Schema("Only primary key can be marked as autoIncrement (++)");if(!e.keyPath)throw new V.Schema("Index must have a name and cannot be an empty string")}),i=r._createTableSchema(n,s,i),t[n]=i}})},tX.prototype.stores=function(e){var t=this.db;this._cfg.storesSource=this._cfg.storesSource?o(this._cfg.storesSource,e):e;var e=t._versions,r={},n={};return e.forEach(function(e){o(r,e._cfg.storesSource),n=e._cfg.dbschema={},e._parseStoresSpec(r,n)}),t._dbSchema=n,tK(t,[t._allTables,t,t.Transaction.prototype]),tB(t,[t._allTables,t,t.Transaction.prototype,this._cfg.tables],s(n),n),t._storeNames=s(n),this},tX.prototype.upgrade=function(e){return this._cfg.contentUpgrade=en(this._cfg.contentUpgrade||G,e),this},tX);function tX(){}function t0(e,t){var r=e._dbNamesDB;return r||(r=e._dbNamesDB=new rS(eX,{addons:[],indexedDB:e,IDBKeyRange:t})).version(1).stores({dbnames:"name"}),r.table("dbnames")}function t1(e){return e&&"function"==typeof e.databases}function t2(e){return eD(function(){return em.letThrough=!0,e()})}function t3(e){return!("from"in e)}var t4=function(e,t){if(!this){var r=new t4;return e&&"d"in e&&o(r,e),r}o(this,arguments.length?{d:1,from:e,to:1<arguments.length?t:e}:{d:0})};function t5(e,t,r){var n=e6(t,r);if(!isNaN(n)){if(0<n)throw RangeError();if(t3(e))return o(e,{from:t,to:r,d:1});var i=e.l,n=e.r;if(0>e6(r,e.from))return i?t5(i,t,r):e.l={from:t,to:r,d:1,l:null,r:null},t9(e);if(0<e6(t,e.to))return n?t5(n,t,r):e.r={from:t,to:r,d:1,l:null,r:null},t9(e);0>e6(t,e.from)&&(e.from=t,e.l=null,e.d=n?n.d+1:1),0<e6(r,e.to)&&(e.to=r,e.r=null,e.d=e.l?e.l.d+1:1),r=!e.r,i&&!e.l&&t6(e,i),n&&r&&t6(e,n)}}function t6(e,t){t3(t)||function e(t,r){var n=r.from,i=r.to,s=r.l,r=r.r;t5(t,n,i),s&&e(t,s),r&&e(t,r)}(e,t)}function t8(e,t){var r=t7(t),n=r.next();if(n.done)return!1;for(var i=n.value,s=t7(e),a=s.next(i.from),o=a.value;!n.done&&!a.done;){if(0>=e6(o.from,i.to)&&0<=e6(o.to,i.from))return!0;0>e6(i.from,o.from)?i=(n=r.next(o.from)).value:o=(a=s.next(i.from)).value}return!1}function t7(e){var t=t3(e)?null:{s:0,n:e};return{next:function(e){for(var r=0<arguments.length;t;)switch(t.s){case 0:if(t.s=1,r)for(;t.n.l&&0>e6(e,t.n.from);)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!r||0>=e6(e,t.n.to))return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function t9(e){var t,n,i=((null==(t=e.r)?void 0:t.d)||0)-((null==(n=e.l)?void 0:n.d)||0),s=1<i?"r":i<-1?"l":"";s&&(t="r"==s?"l":"r",n=r({},e),i=e[s],e.from=i.from,e.to=i.to,e[s]=i[s],n[s]=i[t],(e[t]=n).d=re(n)),e.d=re(e)}function re(e){var t=e.r,e=e.l;return(t?e?Math.max(t.d,e.d):t.d:e?e.d:0)+1}function rt(e,t){return s(t).forEach(function(r){e[r]?t6(e[r],t[r]):e[r]=function e(t){var r,n,i={};for(r in t)c(t,r)&&(n=t[r],i[r]=!n||"object"!=typeof n||O.has(n.constructor)?n:e(n));return i}(t[r])}),e}function rr(e,t){return e.all||t.all||Object.keys(e).some(function(r){return t[r]&&t8(t[r],e[r])})}d(t4.prototype,((M={add:function(e){return t6(this,e),this},addKey:function(e){return t5(this,e,e),this},addKeys:function(e){var t=this;return e.forEach(function(e){return t5(t,e,e)}),this},hasKey:function(e){var t=t7(this).next(e).value;return t&&0>=e6(t.from,e)&&0<=e6(t.to,e)}})[C]=function(){return t7(this)},M));var rn={},ri={},rs=!1;function ra(e){rt(ri,e),rs||(rs=!0,setTimeout(function(){rs=!1,ro(ri,(ri={},!1))},0))}function ro(e,t){void 0===t&&(t=!1);var r=new Set;if(e.all)for(var n=0,i=Object.values(rn);n<i.length;n++)rl(a=i[n],e,r,t);else for(var s in e){var a,o=/^idb\:\/\/(.*)\/(.*)\//.exec(s);o&&(s=o[1],o=o[2],(a=rn["idb://".concat(s,"/").concat(o)])&&rl(a,e,r,t))}r.forEach(function(e){return e()})}function rl(e,t,r,n){for(var i=[],s=0,a=Object.entries(e.queries.query);s<a.length;s++){for(var o=a[s],l=o[0],u=[],c=0,d=o[1];c<d.length;c++){var h=d[c];rr(t,h.obsSet)?h.subscribers.forEach(function(e){return r.add(e)}):n&&u.push(h)}n&&i.push([l,u])}if(n)for(var f=0;f<i.length;f++){var p=i[f],l=p[0],u=p[1];e.queries.query[l]=u}}function ru(e){function t(t){return e.next(t)}var r=i(t),n=i(function(t){return e.throw(t)});function i(e){return function(t){var i=e(t),t=i.value;return i.done?t:t&&"function"==typeof t.then?t.then(r,n):a(t)?Promise.all(t).then(r,n):r(t)}}return i(t)()}function rc(e,t,r){for(var n=a(e)?e.slice():[e],i=0;i<r;++i)n.push(t);return n}var rd={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(e){return r(r({},e),{table:function(t){var n=e.table(t),i=n.schema,s={},a=[];function o(e,t,n){var i=tU(e),l=s[i]=s[i]||[],u=null==e?0:"string"==typeof e?1:e.length,c=0<t,c=r(r({},n),{name:c?"".concat(i,"(virtual-from:").concat(n.name,")"):n.name,lowLevelIndex:n,isVirtual:c,keyTail:t,keyLength:u,extractKey:tI(e),unique:!c&&n.unique});return l.push(c),c.isPrimaryKey||a.push(c),1<u&&o(2===u?e[0]:e.slice(0,u-1),t+1,n),l.sort(function(e,t){return e.keyTail-t.keyTail}),c}t=o(i.primaryKey.keyPath,0,i.primaryKey),s[":id"]=[t];for(var l=0,u=i.indexes;l<u.length;l++){var c=u[l];o(c.keyPath,0,c)}function d(t){var n,i=t.query.index;return i.isVirtual?r(r({},t),{query:{index:i.lowLevelIndex,range:(n=t.query.range,i=i.keyTail,{type:1===n.type?2:n.type,lower:rc(n.lower,n.lowerOpen?e.MAX_KEY:e.MIN_KEY,i),lowerOpen:!0,upper:rc(n.upper,n.upperOpen?e.MIN_KEY:e.MAX_KEY,i),upperOpen:!0})}}):t}return r(r({},n),{schema:r(r({},i),{primaryKey:t,indexes:a,getIndexByKeyPath:function(e){return(e=s[tU(e)])&&e[0]}}),count:function(e){return n.count(d(e))},query:function(e){return n.query(d(e))},openCursor:function(t){var r=t.query.index,i=r.keyTail,s=r.isVirtual,a=r.keyLength;return s?n.openCursor(d(t)).then(function(r){var n;return r&&Object.create(n=r,{continue:{value:function(r){null!=r?n.continue(rc(r,t.reverse?e.MAX_KEY:e.MIN_KEY,i)):t.unique?n.continue(n.key.slice(0,a).concat(t.reverse?e.MIN_KEY:e.MAX_KEY,i)):n.continue()}},continuePrimaryKey:{value:function(t,r){n.continuePrimaryKey(rc(t,e.MAX_KEY,i),r)}},primaryKey:{get:function(){return n.primaryKey}},key:{get:function(){var e=n.key;return 1===a?e[0]:e.slice(0,a)}},value:{get:function(){return n.value}}})}):n.openCursor(t)}})}})}};function rh(e,t,r,n){return r=r||{},n=n||"",s(e).forEach(function(i){var s,a,o;c(t,i)?(s=e[i],a=t[i],"object"==typeof s&&"object"==typeof a&&s&&a?(o=P(s))!==P(a)?r[n+i]=t[i]:"Object"===o?rh(s,a,r,n+i+"."):s!==a&&(r[n+i]=t[i]):s!==a&&(r[n+i]=t[i])):r[n+i]=void 0}),s(t).forEach(function(i){c(e,i)||(r[n+i]=t[i])}),r}function rf(e,t){return"delete"===t.type?t.keys:t.keys||t.values.map(e.extractKey)}var rp={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(e){return r(r({},e),{table:function(t){var i=e.table(t),s=i.schema.primaryKey;return r(r({},i),{mutate:function(e){var a=em.trans,o=a.table(t).hook,l=o.deleting,u=o.creating,d=o.updating;switch(e.type){case"add":if(u.fire===G)break;return a._promise("readwrite",function(){return h(e)},!0);case"put":if(u.fire===G&&d.fire===G)break;return a._promise("readwrite",function(){return h(e)},!0);case"delete":if(l.fire===G)break;return a._promise("readwrite",function(){return h(e)},!0);case"deleteRange":if(l.fire===G)break;return a._promise("readwrite",function(){return function e(t,n,a){return i.query({trans:t,values:!1,query:{index:s,range:n},limit:a}).then(function(i){var s=i.result;return h({type:"delete",keys:s,trans:t}).then(function(i){return 0<i.numFailures?Promise.reject(i.failures[0]):s.length<a?{failures:[],numFailures:0,lastResult:void 0}:e(t,r(r({},n),{lower:s[s.length-1],lowerOpen:!0}),a)})})}(e.trans,e.range,1e4)},!0)}return i.mutate(e);function h(e){var t,a=em.trans,o=e.keys||rf(s,e);if(!o)throw Error("Keys missing");return"delete"!==(e="add"===e.type||"put"===e.type?r(r({},e),{keys:o}):r({},e)).type&&(e.values=n([],e.values,!0)),e.keys&&(e.keys=n([],e.keys,!0)),("add"===(t=e).type?Promise.resolve([]):i.getMany({trans:t.trans,keys:o,cache:"immutable"})).then(function(t){var r=o.map(function(r,n){var i,o,h,f=t[n],p={onerror:null,onsuccess:null};return"delete"===e.type?l.fire.call(p,r,f,a):"add"===e.type||void 0===f?(i=u.fire.call(p,r,e.values[n],a),null==r&&null!=i&&(e.keys[n]=r=i,s.outbound||_(e.values[n],s.keyPath,r))):(i=rh(f,e.values[n]),(o=d.fire.call(p,i,r,f,a))&&(h=e.values[n],Object.keys(o).forEach(function(e){c(h,e)?h[e]=o[e]:_(h,e,o[e])}))),p});return i.mutate(e).then(function(n){for(var i=n.failures,s=n.results,a=n.numFailures,n=n.lastResult,l=0;l<o.length;++l){var u=(s||o)[l],c=r[l];null==u?c.onerror&&c.onerror(i[l]):c.onsuccess&&c.onsuccess("put"===e.type&&t[l]?e.values[l]:u)}return{failures:i,results:s,numFailures:a,lastResult:n}}).catch(function(e){return r.forEach(function(t){return t.onerror&&t.onerror(e)}),Promise.reject(e)})})}}})}})}};function rm(e,t,r){try{if(!t||t.keys.length<e.length)return null;for(var n=[],i=0,s=0;i<t.keys.length&&s<e.length;++i)0===e6(t.keys[i],e[s])&&(n.push(r?N(t.values[i]):t.values[i]),++s);return n.length===e.length?n:null}catch(e){return null}}var rg={stack:"dbcore",level:-1,create:function(e){return{table:function(t){var n=e.table(t);return r(r({},n),{getMany:function(e){if(!e.cache)return n.getMany(e);var t=rm(e.keys,e.trans._cache,"clone"===e.cache);return t?eb.resolve(t):n.getMany(e).then(function(t){return e.trans._cache={keys:e.keys,values:"clone"===e.cache?N(t):t},t})},mutate:function(e){return"add"!==e.type&&(e.trans._cache=null),n.mutate(e)}})}}}};function ry(e,t){return"readonly"===e.trans.mode&&!!e.subscr&&!e.trans.explicit&&"disabled"!==e.trans.db._options.cache&&!t.schema.primaryKey.outbound}function rv(e,t){switch(e){case"query":return t.values&&!t.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var rb={stack:"dbcore",level:0,name:"Observability",create:function(e){var t=e.schema.name,n=new t4(e.MIN_KEY,e.MAX_KEY);return r(r({},e),{transaction:function(t,r,n){if(em.subscr&&"readonly"!==r)throw new V.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(em.querier));return e.transaction(t,r,n)},table:function(i){var o=e.table(i),l=o.schema,u=l.primaryKey,c=l.indexes,d=u.extractKey,h=u.outbound,f=u.autoIncrement&&c.filter(function(e){return e.compound&&e.keyPath.includes(u.keyPath)}),p=r(r({},o),{mutate:function(r){function s(e){return p[e="idb://".concat(t,"/").concat(i,"/").concat(e)]||(p[e]=new t4)}var c,d,h=r.trans,p=r.mutatedParts||(r.mutatedParts={}),m=s(""),g=s(":dels"),y=r.type,v="deleteRange"===r.type?[r.range]:"delete"===r.type?[r.keys]:r.values.length<50?[rf(u,r).filter(function(e){return e}),r.values]:[],b=v[0],x=v[1],v=r.trans._cache;return a(b)?(m.addKeys(b),(v="delete"===y||b.length===x.length?rm(b,v):null)||g.addKeys(b),(v||x)&&(c=v,d=x,l.indexes.forEach(function(e){var t=s(e.name||"");function r(t){return null!=t?e.extractKey(t):null}function n(r){return e.multiEntry&&a(r)?r.forEach(function(e){return t.addKey(e)}):t.addKey(r)}(c||d).forEach(function(e,t){var i=c&&r(c[t]),t=d&&r(d[t]);0!==e6(i,t)&&(null!=i&&n(i),null!=t&&n(t))})}))):b?(x={from:null!=(x=b.lower)?x:e.MIN_KEY,to:null!=(x=b.upper)?x:e.MAX_KEY},g.add(x),m.add(x)):(m.add(n),g.add(n),l.indexes.forEach(function(e){return s(e.name).add(n)})),o.mutate(r).then(function(e){return!b||"add"!==r.type&&"put"!==r.type||(m.addKeys(e.results),f&&f.forEach(function(t){for(var n=r.values.map(function(e){return t.extractKey(e)}),i=t.keyPath.findIndex(function(e){return e===u.keyPath}),a=0,o=e.results.length;a<o;++a)n[a][i]=e.results[a];s(t.name).addKeys(n)})),h.mutatedParts=rt(h.mutatedParts||{},p),e})}}),c=function(t){var r=t.query,t=r.index,r=r.range;return[t,new t4(null!=(t=r.lower)?t:e.MIN_KEY,null!=(r=r.upper)?r:e.MAX_KEY)]},m={get:function(e){return[u,new t4(e.key)]},getMany:function(e){return[u,(new t4).addKeys(e.keys)]},count:c,query:c,openCursor:c};return s(m).forEach(function(e){p[e]=function(s){var a=em.subscr,l=!!a,u=ry(em,o)&&rv(e,s)?s.obsSet={}:a;if(l){var c=function(e){return u[e="idb://".concat(t,"/").concat(i,"/").concat(e)]||(u[e]=new t4)},f=c(""),p=c(":dels"),a=m[e](s),l=a[0],a=a[1];if(("query"===e&&l.isPrimaryKey&&!s.values?p:c(l.name||"")).add(a),!l.isPrimaryKey){if("count"!==e){var g="query"===e&&h&&s.values&&o.query(r(r({},s),{values:!1}));return o[e].apply(this,arguments).then(function(t){if("query"===e){if(h&&s.values)return g.then(function(e){return e=e.result,f.addKeys(e),t});var r=s.values?t.result.map(d):t.result;(s.values?f:p).addKeys(r)}else if("openCursor"===e){var n=s.values;return t&&Object.create(t,{key:{get:function(){return p.addKey(t.primaryKey),t.key}},primaryKey:{get:function(){var e=t.primaryKey;return p.addKey(e),e}},value:{get:function(){return n&&f.addKey(t.primaryKey),t.value}}})}return t})}p.add(n)}}return o[e].apply(this,arguments)}}),p}})}};function rx(e,t,n){if(0===n.numFailures)return t;if("deleteRange"===t.type)return null;var i=t.keys?t.keys.length:"values"in t&&t.values?t.values.length:1;return n.numFailures===i?null:(a((t=r({},t)).keys)&&(t.keys=t.keys.filter(function(e,t){return!(t in n.failures)})),"values"in t&&a(t.values)&&(t.values=t.values.filter(function(e,t){return!(t in n.failures)})),t)}function rw(e,t){return(void 0===t.lower||(t.lowerOpen?0<e6(e,t.lower):0<=e6(e,t.lower)))&&(void 0===t.upper||(t.upperOpen?0>e6(e,t.upper):0>=e6(e,t.upper)))}function r_(e,t,r,n,i,s){if(!r||0===r.length)return e;var o=t.query.index,l=o.multiEntry,u=t.query.range,c=n.schema.primaryKey.extractKey,d=o.extractKey,h=(o.lowLevelIndex||o).extractKey,r=r.reduce(function(e,r){var n=e,i=[];if("add"===r.type||"put"===r.type)for(var s=new t4,o=r.values.length-1;0<=o;--o){var h,f=r.values[o],p=c(f);s.hasKey(p)||(h=d(f),(l&&a(h)?h.some(function(e){return rw(e,u)}):rw(h,u))&&(s.addKey(p),i.push(f)))}switch(r.type){case"add":var m=(new t4).addKeys(t.values?e.map(function(e){return c(e)}):e),n=e.concat(t.values?i.filter(function(e){return e=c(e),!m.hasKey(e)&&(m.addKey(e),!0)}):i.map(function(e){return c(e)}).filter(function(e){return!m.hasKey(e)&&(m.addKey(e),!0)}));break;case"put":var g=(new t4).addKeys(r.values.map(function(e){return c(e)}));n=e.filter(function(e){return!g.hasKey(t.values?c(e):e)}).concat(t.values?i:i.map(function(e){return c(e)}));break;case"delete":var y=(new t4).addKeys(r.keys);n=e.filter(function(e){return!y.hasKey(t.values?c(e):e)});break;case"deleteRange":var v=r.range;n=e.filter(function(e){return!rw(c(e),v)})}return n},e);return r===e?e:(r.sort(function(e,t){return e6(h(e),h(t))||e6(c(e),c(t))}),t.limit&&t.limit<1/0&&(r.length>t.limit?r.length=t.limit:e.length===t.limit&&r.length<t.limit&&(i.dirty=!0)),s?Object.freeze(r):r)}function rk(e,t){return 0===e6(e.lower,t.lower)&&0===e6(e.upper,t.upper)&&!!e.lowerOpen==!!t.lowerOpen&&!!e.upperOpen==!!t.upperOpen}var rj={stack:"dbcore",level:0,name:"Cache",create:function(e){var t=e.schema.name;return r(r({},e),{transaction:function(r,n,i){var s,a,o=e.transaction(r,n,i);return"readwrite"===n&&(a=(s=new AbortController).signal,i=function(i){return function(){if(s.abort(),"readwrite"===n){for(var a=new Set,l=0;l<r.length;l++){var u=r[l],c=rn["idb://".concat(t,"/").concat(u)];if(c){var d=e.table(u),h=c.optimisticOps.filter(function(e){return e.trans===o});if(o._explicit&&i&&o.mutatedParts)for(var f=0,p=Object.values(c.queries.query);f<p.length;f++)for(var m=0,g=(b=p[f]).slice();m<g.length;m++)rr((x=g[m]).obsSet,o.mutatedParts)&&(R(b,x),x.subscribers.forEach(function(e){return a.add(e)}));else if(0<h.length){c.optimisticOps=c.optimisticOps.filter(function(e){return e.trans!==o});for(var y=0,v=Object.values(c.queries.query);y<v.length;y++)for(var b,x,w,_=0,k=(b=v[y]).slice();_<k.length;_++)null!=(x=k[_]).res&&o.mutatedParts&&(i&&!x.dirty?(w=Object.isFrozen(x.res),w=r_(x.res,x.req,h,d,x,w),x.dirty?(R(b,x),x.subscribers.forEach(function(e){return a.add(e)})):w!==x.res&&(x.res=w,x.promise=eb.resolve({result:w}))):(x.dirty&&R(b,x),x.subscribers.forEach(function(e){return a.add(e)})))}}}a.forEach(function(e){return e()})}}},o.addEventListener("abort",i(!1),{signal:a}),o.addEventListener("error",i(!1),{signal:a}),o.addEventListener("complete",i(!0),{signal:a})),o},table:function(n){var i=e.table(n),s=i.schema.primaryKey;return r(r({},i),{mutate:function(e){var a=em.trans;if(s.outbound||"disabled"===a.db._options.cache||a.explicit||"readwrite"!==a.idbtrans.mode)return i.mutate(e);var o=rn["idb://".concat(t,"/").concat(n)];return o?(a=i.mutate(e),("add"===e.type||"put"===e.type)&&(50<=e.values.length||rf(s,e).some(function(e){return null==e}))?a.then(function(t){var n=rx(0,r(r({},e),{values:e.values.map(function(e,n){var i;return t.failures[n]||_(e=null!=(i=s.keyPath)&&i.includes(".")?N(e):r({},e),s.keyPath,t.results[n]),e})}),t);o.optimisticOps.push(n),queueMicrotask(function(){return e.mutatedParts&&ra(e.mutatedParts)})}):(o.optimisticOps.push(e),e.mutatedParts&&ra(e.mutatedParts),a.then(function(t){0<t.numFailures&&(R(o.optimisticOps,e),(t=rx(0,e,t))&&o.optimisticOps.push(t),e.mutatedParts&&ra(e.mutatedParts))}),a.catch(function(){R(o.optimisticOps,e),e.mutatedParts&&ra(e.mutatedParts)})),a):i.mutate(e)},query:function(e){if(!ry(em,i)||!rv("query",e))return i.query(e);var r,s,a="immutable"===(null==(c=em.trans)?void 0:c.db._options.cache),o=em,l=o.requery,u=o.signal,c=function(e,t,r,n){var i=rn["idb://".concat(e,"/").concat(t)];if(!i)return[];if(!(t=i.queries[r]))return[null,!1,i,null];var s=t[(n.query?n.query.index.name:null)||""];if(!s)return[null,!1,i,null];switch(r){case"query":var a=s.find(function(e){return e.req.limit===n.limit&&e.req.values===n.values&&rk(e.req.query.range,n.query.range)});return a?[a,!0,i,s]:[s.find(function(e){var t,r;return("limit"in e.req?e.req.limit:1/0)>=n.limit&&(!n.values||e.req.values)&&(t=e.req.query.range,r=n.query.range,0>=function(e,t,r,n){if(void 0===e)return void 0!==t?-1:0;if(void 0===t)return 1;if(0===(t=e6(e,t))){if(r&&n)return 0;if(r)return 1;if(n)return -1}return t}(t.lower,r.lower,t.lowerOpen,r.lowerOpen)&&0<=function(e,t,r,n){if(void 0===e)return+(void 0!==t);if(void 0===t)return -1;if(0===(t=e6(e,t))){if(r&&n)return 0;if(r)return -1;if(n)return 1}return t}(t.upper,r.upper,t.upperOpen,r.upperOpen))}),!1,i,s];case"count":return[a=s.find(function(e){return rk(e.req.query.range,n.query.range)}),!!a,i,s]}}(t,n,"query",e),d=c[0],o=c[1],h=c[2],f=c[3];return d&&o?d.obsSet=e.obsSet:(o=i.query(e).then(function(e){var t=e.result;if(d&&(d.res=t),a){for(var r=0,n=t.length;r<n;++r)Object.freeze(t[r]);Object.freeze(t)}else e.result=N(t);return e}).catch(function(e){return f&&d&&R(f,d),Promise.reject(e)}),d={obsSet:e.obsSet,promise:o,subscribers:new Set,type:"query",req:e,dirty:!1},f?f.push(d):(f=[d],(h=h||(rn["idb://".concat(t,"/").concat(n)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[e.query.index.name||""]=f)),r=d,s=f,r.subscribers.add(l),u.addEventListener("abort",function(){r.subscribers.delete(l),0===r.subscribers.size&&setTimeout(function(){0===r.subscribers.size&&R(s,r)},3e3)}),d.promise.then(function(t){return{result:r_(t.result,e,null==h?void 0:h.optimisticOps,i,d,a)}})}})}})}};function rE(e,t){return new Proxy(e,{get:function(e,r,n){return"db"===r?t:Reflect.get(e,r,n)}})}var rS=(rO.prototype.version=function(e){if(isNaN(e)||e<.1)throw new V.Type("Given version is not a positive number");if(e=Math.round(10*e)/10,this.idbdb||this._state.isBeingOpened)throw new V.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);var t=this._versions,r=t.filter(function(t){return t._cfg.version===e})[0];return r||(r=new this.Version(e),t.push(r),t.sort(tZ),r.stores({}),this._state.autoSchema=!1,r)},rO.prototype._whenReady=function(e){var t=this;return this.idbdb&&(this._state.openComplete||em.letThrough||this._vip)?e():new eb(function(e,r){if(t._state.openComplete)return r(new V.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._state.autoOpen)return void r(new V.DatabaseClosed);t.open().catch(G)}t._state.dbReadyPromise.then(e,r)}).then(e)},rO.prototype.use=function(e){var t=e.stack,r=e.create,n=e.level,i=e.name;return i&&this.unuse({stack:t,name:i}),(e=this._middlewares[t]||(this._middlewares[t]=[])).push({stack:t,create:r,level:null==n?10:n,name:i}),e.sort(function(e,t){return e.level-t.level}),this},rO.prototype.unuse=function(e){var t=e.stack,r=e.name,n=e.create;return t&&this._middlewares[t]&&(this._middlewares[t]=this._middlewares[t].filter(function(e){return n?e.create!==n:!!r&&e.name!==r})),this},rO.prototype.open=function(){var e=this;return eq(ep,function(){return function(e){var t=e._state,r=e._deps.indexedDB;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then(function(){return t.dbOpenError?eW(t.dbOpenError):e});t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;var n=t.openCanceller,i=Math.round(10*e.verno),a=!1;function o(){if(t.openCanceller!==n)throw new V.DatabaseClosed("db.open() was cancelled")}var l,u=t.dbReadyResolve,c=null,d=!1;return eb.race([n,("u"<typeof navigator?eb.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(e){function t(){return indexedDB.databases().finally(e)}l=setInterval(t,100),t()}).finally(function(){return clearInterval(l)}):Promise.resolve()).then(function n(){return new eb(function(l,u){if(o(),!r)throw new V.MissingAPI;var h=e.name,f=t.autoSchema||!i?r.open(h):r.open(h,i);if(!f)throw new V.MissingAPI;f.onerror=tS(u),f.onblocked=eP(e._fireOnBlocked),f.onupgradeneeded=eP(function(n){var i,o,l,p,m,g,y;c=f.transaction,t.autoSchema&&!e._options.allowEmptyDB?(f.onerror=tO,c.abort(),f.result.close(),(i=r.deleteDatabase(h)).onsuccess=i.onerror=eP(function(){u(new V.NoSuchDatabase("Database ".concat(h," doesnt exist")))})):(c.onerror=tS(u),d=(n=n.oldVersion>0x4000000000000000?0:n.oldVersion)<1,e.idbdb=f.result,a&&function(e,t){tJ(e._dbSchema,t),t.db.version%10!=0||t.objectStoreNames.contains("$meta")||t.db.createObjectStore("$meta").add(Math.ceil(t.db.version/10-1),"version");var r=tG(0,e.idbdb,t);tH(e,e._dbSchema,t);for(var n=0,i=tq(r,e._dbSchema).change;n<i.length;n++){var s=function(e){if(e.change.length||e.recreate)return console.warn("Unable to patch indexes of table ".concat(e.name," because it has changes on the type of index or primary key.")),{value:void 0};var r=t.objectStore(e.name);e.add.forEach(function(t){ei&&console.debug("Dexie upgrade patch: Creating missing index ".concat(e.name,".").concat(t.src)),tW(r,t)})}(i[n]);if("object"==typeof s)return s.value}}(e,c),o=n/10,l=c,p=e._dbSchema,l.objectStoreNames.contains("$meta")&&!p.$meta&&(p.$meta=t$("$meta",tQ("")[0],[]),e._storeNames.push("$meta")),(m=e._createTransaction("readwrite",e._storeNames,p)).create(l),m._completion.catch(u),g=m._reject.bind(m),y=em.transless||em,eD(function(){return em.trans=m,em.transless=y,0!==o?(tL(e,l),(m.storeNames.includes("$meta")?m.table("$meta").get("version").then(function(e){return null!=e?e:o}):eb.resolve(o)).then(function(t){var r,n,i;return r=t,n=[],t=e._versions,i=e._dbSchema=tG(0,e.idbdb,l),0!==(t=t.filter(function(e){return e._cfg.version>=r})).length?(t.forEach(function(t){n.push(function(){var n=i,a=t._cfg.dbschema;tH(e,n,l),tH(e,a,l),i=e._dbSchema=a;var o=tq(n,a);o.add.forEach(function(e){tV(l,e[0],e[1].primKey,e[1].indexes)}),o.change.forEach(function(e){if(e.recreate)throw new V.Upgrade("Not yet support for changing primary key");var t=l.objectStore(e.name);e.add.forEach(function(e){return tW(t,e)}),e.change.forEach(function(e){t.deleteIndex(e.name),tW(t,e)}),e.del.forEach(function(e){return t.deleteIndex(e)})});var u=t._cfg.contentUpgrade;if(u&&t._cfg.version>r){tL(e,l),m._memoizedTables={};var c=k(a);o.del.forEach(function(e){c[e]=n[e]}),tK(e,[e.Transaction.prototype]),tB(e,[e.Transaction.prototype],s(c),c),m.schema=c;var d,h=I(u);return h&&eM(),o=eb.follow(function(){var e;(d=u(m))&&h&&(e=eU.bind(null,null),d.then(e,e))}),d&&"function"==typeof d.then?eb.resolve(d):o.then(function(){return d})}}),n.push(function(r){var n=t._cfg.dbschema;[].slice.call(r.db.objectStoreNames).forEach(function(e){return null==n[e]&&r.db.deleteObjectStore(e)}),tK(e,[e.Transaction.prototype]),tB(e,[e.Transaction.prototype],e._storeNames,e._dbSchema),m.schema=e._dbSchema}),n.push(function(r){e.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(e.idbdb.version/10)===t._cfg.version?(e.idbdb.deleteObjectStore("$meta"),delete e._dbSchema.$meta,e._storeNames=e._storeNames.filter(function(e){return"$meta"!==e})):r.objectStore("$meta").put(t._cfg.version,"version"))})}),(function e(){return n.length?eb.resolve(n.shift()(m.idbtrans)).then(e):eb.resolve()})().then(function(){tJ(i,l)})):eb.resolve()}).catch(g)):(s(p).forEach(function(e){tV(l,e,p[e].primKey,p[e].indexes)}),tL(e,l),void eb.follow(function(){return e.on.populate.fire(m)}).catch(g))}))},u),f.onsuccess=eP(function(){c=null;var r,o,u,p=e.idbdb=f.result,m=y(p.objectStoreNames);if(0<m.length)try{var g=p.transaction(1===m.length?m[0]:m,"readonly");if(t.autoSchema)r=p,o=g,e.verno=r.version/10,o=e._dbSchema=tG(0,r,o),e._storeNames=y(r.objectStoreNames,0),tB(e,[e._allTables],s(o),o);else if(tH(e,e._dbSchema,g),((u=tq(tG(0,(u=e).idbdb,g),u._dbSchema)).add.length||u.change.some(function(e){return e.add.length||e.change.length}))&&!a)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),p.close(),i=p.version+1,a=!0,l(n());tL(e,g)}catch(e){}eY.push(e),p.onversionchange=eP(function(r){t.vcFired=!0,e.on("versionchange").fire(r)}),p.onclose=eP(function(){e.close({disableAutoOpen:!1})}),d&&(u=e._deps,g=h,p=u.indexedDB,u=u.IDBKeyRange,t1(p)||g===eX||t0(p,u).put({name:g}).catch(G)),l()},u)}).catch(function(e){switch(null==e?void 0:e.name){case"UnknownError":if(0<t.PR1398_maxLoop)return t.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),n();break;case"VersionError":if(0<i)return i=0,n()}return eb.reject(e)})})]).then(function(){return o(),t.onReadyBeingFired=[],eb.resolve(t2(function(){return e.on.ready.fire(e.vip)})).then(function r(){if(0<t.onReadyBeingFired.length){var n=t.onReadyBeingFired.reduce(en,G);return t.onReadyBeingFired=[],eb.resolve(t2(function(){return n(e.vip)})).then(r)}})}).finally(function(){t.openCanceller===n&&(t.onReadyBeingFired=null,t.isBeingOpened=!1)}).catch(function(r){t.dbOpenError=r;try{c&&c.abort()}catch(e){}return n===t.openCanceller&&e._close(),eW(r)}).finally(function(){t.openComplete=!0,u()}).then(function(){var t;return d&&(t={},e.tables.forEach(function(r){r.schema.indexes.forEach(function(n){n.name&&(t["idb://".concat(e.name,"/").concat(r.name,"/").concat(n.name)]=new t4(-1/0,[[[]]]))}),t["idb://".concat(e.name,"/").concat(r.name,"/")]=t["idb://".concat(e.name,"/").concat(r.name,"/:dels")]=new t4(-1/0,[[[]]])}),tA(tT).fire(t),ro(t,!0)),e})}(e)})},rO.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var e=this._state,t=eY.indexOf(this);if(0<=t&&eY.splice(t,1),this.idbdb){try{this.idbdb.close()}catch(e){}this.idbdb=null}e.isBeingOpened||(e.dbReadyPromise=new eb(function(t){e.dbReadyResolve=t}),e.openCanceller=new eb(function(t,r){e.cancelOpen=r}))},rO.prototype.close=function(e){var t=(void 0===e?{disableAutoOpen:!0}:e).disableAutoOpen,e=this._state;t?(e.isBeingOpened&&e.cancelOpen(new V.DatabaseClosed),this._close(),e.autoOpen=!1,e.dbOpenError=new V.DatabaseClosed):(this._close(),e.autoOpen=this._options.autoOpen||e.isBeingOpened,e.openComplete=!1,e.dbOpenError=null)},rO.prototype.delete=function(e){var t=this;void 0===e&&(e={disableAutoOpen:!0});var r=0<arguments.length&&"object"!=typeof arguments[0],n=this._state;return new eb(function(i,s){function a(){t.close(e);var r=t._deps.indexedDB.deleteDatabase(t.name);r.onsuccess=eP(function(){var e,r,n;e=t._deps,r=t.name,n=e.indexedDB,e=e.IDBKeyRange,t1(n)||r===eX||t0(n,e).delete(r).catch(G),i()}),r.onerror=tS(s),r.onblocked=t._fireOnBlocked}if(r)throw new V.InvalidArgument("Invalid closeOptions argument to db.delete()");n.isBeingOpened?n.dbReadyPromise.then(a):a()})},rO.prototype.backendDB=function(){return this.idbdb},rO.prototype.isOpen=function(){return null!==this.idbdb},rO.prototype.hasBeenClosed=function(){var e=this._state.dbOpenError;return e&&"DatabaseClosed"===e.name},rO.prototype.hasFailed=function(){return null!==this._state.dbOpenError},rO.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(rO.prototype,"tables",{get:function(){var e=this;return s(this._allTables).map(function(t){return e._allTables[t]})},enumerable:!1,configurable:!0}),rO.prototype.transaction=function(){var e=(function(e,t,r){var n=arguments.length;if(n<2)throw new V.InvalidArgument("Too few arguments");for(var i=Array(n-1);--n;)i[n-1]=arguments[n];return r=i.pop(),[e,E(i),r]}).apply(this,arguments);return this._transaction.apply(this,e)},rO.prototype._transaction=function(e,t,r){var n=this,i=em.trans;i&&i.db===this&&-1===e.indexOf("!")||(i=null);var s,a,o=-1!==e.indexOf("?");e=e.replace("!","").replace("?","");try{if(a=t.map(function(e){if(e=e instanceof n.Table?e.name:e,"string"!=typeof e)throw TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return e}),"r"==e||e===e0)s=e0;else{if("rw"!=e&&e!=e1)throw new V.InvalidArgument("Invalid transaction mode: "+e);s=e1}if(i){if(i.mode===e0&&s===e1){if(!o)throw new V.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");i=null}i&&a.forEach(function(e){if(i&&-1===i.storeNames.indexOf(e)){if(!o)throw new V.SubTransaction("Table "+e+" not included in parent transaction.");i=null}}),o&&i&&!i.active&&(i=null)}}catch(e){return i?i._promise(null,function(t,r){r(e)}):eW(e)}var l=(function e(t,r,n,i,s){return eb.resolve().then(function(){var a=em.transless||em,o=t._createTransaction(r,n,t._dbSchema,i);if(o.explicit=!0,a={trans:o,transless:a},i)o.idbtrans=i.idbtrans;else try{o.create(),o.idbtrans._explicit=!0,t._state.PR1398_maxLoop=3}catch(i){return i.name===q.InvalidState&&t.isOpen()&&0<--t._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),t.close({disableAutoOpen:!1}),t.open().then(function(){return e(t,r,n,null,s)})):eW(i)}var l,u=I(s);return u&&eM(),a=eb.follow(function(){var e;(l=s.call(o,o))&&(u?(e=eU.bind(null,null),l.then(e,e)):"function"==typeof l.next&&"function"==typeof l.throw&&(l=ru(l)))},a),(l&&"function"==typeof l.then?eb.resolve(l).then(function(e){return o.active?e:eW(new V.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):a.then(function(){return l})).then(function(e){return i&&o._resolve(),o._completion.then(function(){return e})}).catch(function(e){return o._reject(e),eW(e)})})}).bind(null,this,s,a,i,r);return i?i._promise(s,l,"lock"):em.trans?eq(em.transless,function(){return n._whenReady(l)}):this._whenReady(l)},rO.prototype.table=function(e){if(!c(this._allTables,e))throw new V.InvalidTable("Table ".concat(e," does not exist"));return this._allTables[e]},rO);function rO(e,t){var n=this;this._middlewares={},this.verno=0;var i=rO.dependencies;this._options=t=r({addons:rO.addons,autoOpen:!0,indexedDB:i.indexedDB,IDBKeyRange:i.IDBKeyRange,cache:"cloned"},t),this._deps={indexedDB:t.indexedDB,IDBKeyRange:t.IDBKeyRange},i=t.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var s,a,o,l,u,c={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:G,dbReadyPromise:null,cancelOpen:G,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:t.autoOpen};c.dbReadyPromise=new eb(function(e){c.dbReadyResolve=e}),c.openCanceller=new eb(function(e,t){c.cancelOpen=t}),this._state=c,this.name=e,this.on=ts(this,"populate","blocked","versionchange","close",{ready:[en,G]}),this.once=function(e,t){var r=function(){for(var i=[],s=0;s<arguments.length;s++)i[s]=arguments[s];n.on(e).unsubscribe(r),t.apply(n,i)};return n.on(e,r)},this.on.ready.subscribe=v(this.on.ready.subscribe,function(e){return function(t,r){rO.vip(function(){var i=n._state;i.openComplete?(i.dbOpenError||eb.resolve().then(t),r&&e(t)):i.onReadyBeingFired?(i.onReadyBeingFired.push(t),r&&e(t)):(e(t),r||e(function e(){n.on.ready.unsubscribe(t),n.on.ready.unsubscribe(e)}))})}}),this.Collection=(s=this,ta(tp.prototype,function(e,t){this.db=s;var r=e3,n=null;if(t)try{r=t()}catch(e){n=e}var i=e._ctx,t=i.table,e=t.hook.reading.fire;this._ctx={table:t,index:i.index,isPrimKey:!i.index||t.schema.primKey.keyPath&&i.index===t.schema.primKey.name,range:r,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:n,or:i.or,valueMapper:e!==H?e:null}})),this.Table=(a=this,ta(tn.prototype,function(e,t,r){this.db=a,this._tx=r,this.name=e,this.schema=t,this.hook=a._allTables[e]?a._allTables[e].hook:ts(null,{creating:[X,G],reading:[Q,H],updating:[et,G],deleting:[ee,G]})})),this.Transaction=(o=this,ta(tP.prototype,function(e,t,r,n,i){var s=this;"readonly"!==e&&t.forEach(function(e){(e=null==(e=r[e])?void 0:e.yProps)&&(t=t.concat(e.map(function(e){return e.updatesTable})))}),this.db=o,this.mode=e,this.storeNames=t,this.schema=r,this.chromeTransactionDurability=n,this.idbtrans=null,this.on=ts(this,"complete","error","abort"),this.parent=i||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new eb(function(e,t){s._resolve=e,s._reject=t}),this._completion.then(function(){s.active=!1,s.on.complete.fire()},function(e){var t=s.active;return s.active=!1,s.on.error.fire(e),s.parent?s.parent._reject(e):t&&s.idbtrans&&s.idbtrans.abort(),eW(e)})})),this.Version=(l=this,ta(tY.prototype,function(e){this.db=l,this._cfg={version:e,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(u=this,ta(tj.prototype,function(e,t,r){if(this.db=u,this._ctx={table:e,index:":id"===t?null:t,or:r},this._cmp=this._ascending=e6,this._descending=function(e,t){return e6(t,e)},this._max=function(e,t){return 0<e6(e,t)?e:t},this._min=function(e,t){return 0>e6(e,t)?e:t},this._IDBKeyRange=u._deps.IDBKeyRange,!this._IDBKeyRange)throw new V.MissingAPI})),this.on("versionchange",function(e){0<e.newVersion?console.warn("Another connection wants to upgrade database '".concat(n.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(n.name,"'. Closing db now to resume the delete request.")),n.close({disableAutoOpen:!1})}),this.on("blocked",function(e){!e.newVersion||e.newVersion<e.oldVersion?console.warn("Dexie.delete('".concat(n.name,"') was blocked")):console.warn("Upgrade '".concat(n.name,"' blocked by other connection holding version ").concat(e.oldVersion/10))}),this._maxKey=tF(t.IDBKeyRange),this._createTransaction=function(e,t,r,i){return new n.Transaction(e,t,r,n._options.chromeTransactionDurability,i)},this._fireOnBlocked=function(e){n.on("blocked").fire(e),eY.filter(function(e){return e.name===n.name&&e!==n&&!e._state.vcFired}).map(function(t){return t.on("versionchange").fire(e)})},this.use(rg),this.use(rj),this.use(rb),this.use(rd),this.use(rp);var d=new Proxy(this,{get:function(e,t,r){if("_vip"===t)return!0;if("table"===t)return function(e){return rE(n.table(e),d)};var i=Reflect.get(e,t,r);return i instanceof tn?rE(i,d):"tables"===t?i.map(function(e){return rE(e,d)}):"_createTransaction"===t?function(){return rE(i.apply(this,arguments),d)}:i}});this.vip=d,i.forEach(function(e){return e(n)})}var rT,M="u">typeof Symbol&&"observable"in Symbol?Symbol.observable:"@@observable",rN=(rA.prototype.subscribe=function(e,t,r){return this._subscribe(e&&"function"!=typeof e?e:{next:e,error:t,complete:r})},rA.prototype[M]=function(){return this},rA);function rA(e){this._subscribe=e}try{rT={indexedDB:i.indexedDB||i.mozIndexedDB||i.webkitIndexedDB||i.msIndexedDB,IDBKeyRange:i.IDBKeyRange||i.webkitIDBKeyRange}}catch(e){rT={indexedDB:null,IDBKeyRange:null}}function rP(e){var t,r=!1,n=new rN(function(n){var i,s=I(e),a=!1,o={},l={},u={get closed(){return a},unsubscribe:function(){a||(a=!0,i&&i.abort(),d&&tA.storagemutated.unsubscribe(f))}};n.start&&n.start(u);var d=!1,h=function(){return eJ(p)},f=function(e){rt(o,e),rr(l,o)&&h()},p=function(){var u,p;!a&&rT.indexedDB&&(o={},u={},i&&i.abort(),Promise.resolve(function(t){var r=eO();try{s&&eM();var n=eD(e,t);return n=s?n.finally(eU):n}finally{r&&eT()}}(p={subscr:u,signal:(i=new AbortController).signal,requery:h,querier:e,trans:null})).then(function(e){r=!0,t=e,a||p.signal.aborted||(o={},function(e){for(var t in e)if(c(e,t))return;return 1}(l=u)||d||(tA(tT,f),d=!0),eJ(function(){return!a&&n.next&&n.next(e)}))},function(e){r=!1,["DatabaseClosedError","AbortError"].includes(null==e?void 0:e.name)||a||eJ(function(){a||n.error&&n.error(e)})}))};return setTimeout(h,0),u});return n.hasValue=function(){return r},n.getValue=function(){return t},n}function rC(e){var t=rR;try{rR=!0,tA.storagemutated.fire(e),ro(e,!0)}finally{rR=t}}d(rS,r(r({},W),{delete:function(e){return new rS(e,{addons:[]}).delete()},exists:function(e){return new rS(e,{addons:[]}).open().then(function(e){return e.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(e){var t,r;try{return r=(t=rS.dependencies).indexedDB,t=t.IDBKeyRange,(t1(r)?Promise.resolve(r.databases()).then(function(e){return e.map(function(e){return e.name}).filter(function(e){return e!==eX})}):t0(r,t).toCollection().primaryKeys()).then(e)}catch(e){return eW(new V.MissingAPI)}},defineClass:function(){return function(e){o(this,e)}},ignoreTransaction:function(e){return em.trans?eq(em.transless,e):e()},vip:t2,async:function(e){return function(){try{var t=ru(e.apply(this,arguments));return t&&"function"==typeof t.then?t:eb.resolve(t)}catch(e){return eW(e)}}},spawn:function(e,t,r){try{var n=ru(e.apply(r,t||[]));return n&&"function"==typeof n.then?n:eb.resolve(n)}catch(e){return eW(e)}},currentTransaction:{get:function(){return em.trans||null}},waitFor:function(e,t){return t=eb.resolve("function"==typeof e?rS.ignoreTransaction(e):e).timeout(t||6e4),em.trans?em.trans.waitFor(t):t},Promise:eb,debug:{get:function(){return ei},set:function(e){ei=e}},derive:p,extend:o,props:d,override:v,Events:ts,on:tA,liveQuery:rP,extendObservabilitySet:rt,getByKeyPath:w,setByKeyPath:_,delByKeyPath:function(e,t){"string"==typeof t?_(e,t,void 0):"length"in t&&[].map.call(t,function(t){_(e,t,void 0)})},shallowClone:k,deepClone:N,getObjectDiff:rh,cmp:e6,asap:x,minKey:-1/0,addons:[],connections:eY,errnames:q,dependencies:rT,cache:rn,semVer:"4.2.1",version:"4.2.1".split(".").map(function(e){return parseInt(e)}).reduce(function(e,t,r){return e+t/Math.pow(10,2*r)})})),rS.maxKey=tF(rS.dependencies.IDBKeyRange),"u">typeof dispatchEvent&&"u">typeof addEventListener&&(tA(tT,function(e){rR||(e=new CustomEvent(tN,{detail:e}),rR=!0,dispatchEvent(e),rR=!1)}),addEventListener(tN,function(e){e=e.detail,rR||rC(e)}));var rz,rR=!1,r$=function(){};return"u">typeof BroadcastChannel&&((r$=function(){(rz=new BroadcastChannel(tN)).onmessage=function(e){return e.data&&rC(e.data)}})(),"function"==typeof rz.unref&&rz.unref(),tA(tT,function(e){rR||rz.postMessage(e)})),"u">typeof addEventListener&&(addEventListener("pagehide",function(e){if(!rS.disableBfCache&&e.persisted){ei&&console.debug("Dexie: handling persisted pagehide"),null!=rz&&rz.close();for(var t=0;t<eY.length;t++)eY[t].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(e){!rS.disableBfCache&&e.persisted&&(ei&&console.debug("Dexie: handling persisted pageshow"),r$(),rC({all:new t4(-1/0,[[]])}))})),eb.rejectionMapper=function(e,t){return!e||e instanceof L||e instanceof TypeError||e instanceof SyntaxError||!e.name||!J[e.name]?e:(t=new J[e.name](t||e.message,e),"stack"in e&&f(t,"stack",{get:function(){return this.inner.stack}}),t)},r(rS,Object.freeze({__proto__:null,Dexie:rS,liveQuery:rP,Entity:e5,cmp:e6,PropModification:te,replacePrefix:function(e,t){return new te({replacePrefix:[e,t]})},add:function(e){return new te({add:e})},remove:function(e){return new te({remove:e})},default:rS,RangeSet:t4,mergeRanges:t6,rangesOverlap:t8}),{default:rS}),rS}()},54385,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}}},43173,(e,t,r)=>{"use strict";var n=e.e&&e.e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0});let i=n(e.r(6085)),s=n(e.r(54385));r.default=class{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:"u"<typeof fetch?this.fetch=i.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=Object.assign({},this.headers),this.headers[e]=t,this}then(e,t){void 0===this.schema||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),"GET"!==this.method&&"HEAD"!==this.method&&(this.headers["Content-Type"]="application/json");let r=(0,this.fetch)(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async e=>{var t,r,n;let i=null,a=null,o=null,l=e.status,u=e.statusText;if(e.ok){if("HEAD"!==this.method){let t=await e.text();""===t||(a="text/csv"===this.headers.Accept||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?t:JSON.parse(t))}let n=null==(t=this.headers.Prefer)?void 0:t.match(/count=(exact|planned|estimated)/),s=null==(r=e.headers.get("content-range"))?void 0:r.split("/");n&&s&&s.length>1&&(o=parseInt(s[1])),this.isMaybeSingle&&"GET"===this.method&&Array.isArray(a)&&(a.length>1?(i={code:"PGRST116",details:`Results contain ${a.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},a=null,o=null,l=406,u="Not Acceptable"):a=1===a.length?a[0]:null)}else{let t=await e.text();try{i=JSON.parse(t),Array.isArray(i)&&404===e.status&&(a=[],i=null,l=200,u="OK")}catch(r){404===e.status&&""===t?(l=204,u="No Content"):i={message:t}}if(i&&this.isMaybeSingle&&(null==(n=null==i?void 0:i.details)?void 0:n.includes("0 rows"))&&(i=null,l=200,u="OK"),i&&this.shouldThrowOnError)throw new s.default(i)}return{error:i,data:a,count:o,status:l,statusText:u}});return this.shouldThrowOnError||(r=r.catch(e=>{var t,r,n;return{error:{message:`${null!=(t=null==e?void 0:e.name)?t:"FetchError"}: ${null==e?void 0:e.message}`,details:`${null!=(r=null==e?void 0:e.stack)?r:""}`,hint:"",code:`${null!=(n=null==e?void 0:e.code)?n:""}`},data:null,count:null,status:0,statusText:""}})),r.then(e,t)}}},82191,(e,t,r)=>{"use strict";var n=e.e&&e.e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0});let i=n(e.r(43173));class s extends i.default{select(e){let t=!1,r=(null!=e?e:"*").split("").map(e=>/\s/.test(e)&&!t?"":('"'===e&&(t=!t),e)).join("");return this.url.searchParams.set("select",r),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:t=!0,nullsFirst:r,foreignTable:n,referencedTable:i=n}={}){let s=i?`${i}.order`:"order",a=this.url.searchParams.get(s);return this.url.searchParams.set(s,`${a?`${a},`:""}${e}.${t?"asc":"desc"}${void 0===r?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:r=t}={}){let n=void 0===r?"limit":`${r}.limit`;return this.url.searchParams.set(n,`${e}`),this}range(e,t,{foreignTable:r,referencedTable:n=r}={}){let i=void 0===n?"offset":`${n}.offset`,s=void 0===n?"limit":`${n}.limit`;return this.url.searchParams.set(i,`${e}`),this.url.searchParams.set(s,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return"GET"===this.method?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:n=!1,wal:i=!1,format:s="text"}={}){var a;let o=[e?"analyze":null,t?"verbose":null,r?"settings":null,n?"buffers":null,i?"wal":null].filter(Boolean).join("|"),l=null!=(a=this.headers.Accept)?a:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${s}; for="${l}"; options=${o};`,this}rollback(){var e;return(null!=(e=this.headers.Prefer)?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}r.default=s},14633,(e,t,r)=>{"use strict";var n=e.e&&e.e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0});let i=n(e.r(82191));class s extends i.default{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){let r=Array.from(new Set(t)).map(e=>"string"==typeof e&&RegExp("[,()]").test(e)?`"${e}"`:`${e}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}contains(e,t){return"string"==typeof t?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return"string"==typeof t?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return"string"==typeof t?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:n}={}){let i="";"plain"===n?i="pl":"phrase"===n?i="ph":"websearch"===n&&(i="w");let s=void 0===r?"":`(${r})`;return this.url.searchParams.append(e,`${i}fts${s}.${t}`),this}match(e){return Object.entries(e).forEach(([e,t])=>{this.url.searchParams.append(e,`eq.${t}`)}),this}not(e,t,r){return this.url.searchParams.append(e,`not.${t}.${r}`),this}or(e,{foreignTable:t,referencedTable:r=t}={}){let n=r?`${r}.or`:"or";return this.url.searchParams.append(n,`(${e})`),this}filter(e,t,r){return this.url.searchParams.append(e,`${t}.${r}`),this}}r.default=s},38290,(e,t,r)=>{"use strict";var n=e.e&&e.e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0});let i=n(e.r(14633));r.default=class{constructor(e,{headers:t={},schema:r,fetch:n}){this.url=e,this.headers=t,this.schema=r,this.fetch=n}select(e,{head:t=!1,count:r}={}){let n=!1,s=(null!=e?e:"*").split("").map(e=>/\s/.test(e)&&!n?"":('"'===e&&(n=!n),e)).join("");return this.url.searchParams.set("select",s),r&&(this.headers.Prefer=`count=${r}`),new i.default({method:t?"HEAD":"GET",url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:t,defaultToNull:r=!0}={}){let n=[];if(this.headers.Prefer&&n.push(this.headers.Prefer),t&&n.push(`count=${t}`),r||n.push("missing=default"),this.headers.Prefer=n.join(","),Array.isArray(e)){let t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){let e=[...new Set(t)].map(e=>`"${e}"`);this.url.searchParams.set("columns",e.join(","))}}return new i.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:t,ignoreDuplicates:r=!1,count:n,defaultToNull:s=!0}={}){let a=[`resolution=${r?"ignore":"merge"}-duplicates`];if(void 0!==t&&this.url.searchParams.set("on_conflict",t),this.headers.Prefer&&a.push(this.headers.Prefer),n&&a.push(`count=${n}`),s||a.push("missing=default"),this.headers.Prefer=a.join(","),Array.isArray(e)){let t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){let e=[...new Set(t)].map(e=>`"${e}"`);this.url.searchParams.set("columns",e.join(","))}}return new i.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:t}={}){let r=[];return this.headers.Prefer&&r.push(this.headers.Prefer),t&&r.push(`count=${t}`),this.headers.Prefer=r.join(","),new i.default({method:"PATCH",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){let t=[];return e&&t.push(`count=${e}`),this.headers.Prefer&&t.unshift(this.headers.Prefer),this.headers.Prefer=t.join(","),new i.default({method:"DELETE",url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}},98042,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.version=void 0,r.version="0.0.0-automated"},85511,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.DEFAULT_HEADERS=void 0;let n=e.r(98042);r.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${n.version}`}},2259,(e,t,r)=>{"use strict";var n=e.e&&e.e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0});let i=n(e.r(38290)),s=n(e.r(14633)),a=e.r(85511);class o{constructor(e,{headers:t={},schema:r,fetch:n}={}){this.url=e,this.headers=Object.assign(Object.assign({},a.DEFAULT_HEADERS),t),this.schemaName=r,this.fetch=n}from(e){let t=new URL(`${this.url}/${e}`);return new i.default(t,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new o(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,t={},{head:r=!1,get:n=!1,count:i}={}){let a,o,l=new URL(`${this.url}/rpc/${e}`);r||n?(a=r?"HEAD":"GET",Object.entries(t).filter(([e,t])=>void 0!==t).map(([e,t])=>[e,Array.isArray(t)?`{${t.join(",")}}`:`${t}`]).forEach(([e,t])=>{l.searchParams.append(e,t)})):(a="POST",o=t);let u=Object.assign({},this.headers);return i&&(u.Prefer=`count=${i}`),new s.default({method:a,url:l,headers:u,schema:this.schemaName,body:o,fetch:this.fetch,allowEmpty:!1})}}r.default=o},82215,(e,t,r)=>{"use strict";var n=e.e&&e.e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.PostgrestError=r.PostgrestBuilder=r.PostgrestTransformBuilder=r.PostgrestFilterBuilder=r.PostgrestQueryBuilder=r.PostgrestClient=void 0;let i=n(e.r(2259));r.PostgrestClient=i.default;let s=n(e.r(38290));r.PostgrestQueryBuilder=s.default;let a=n(e.r(14633));r.PostgrestFilterBuilder=a.default;let o=n(e.r(82191));r.PostgrestTransformBuilder=o.default;let l=n(e.r(43173));r.PostgrestBuilder=l.default;let u=n(e.r(54385));r.PostgrestError=u.default,r.default={PostgrestClient:i.default,PostgrestQueryBuilder:s.default,PostgrestFilterBuilder:a.default,PostgrestTransformBuilder:o.default,PostgrestBuilder:l.default,PostgrestError:u.default}},71058,e=>{"use strict";let t,r,n,i,s,a,o,l,u;var c,d,h,f,p,m,g,y,v,b,x,w,_,k,j,E,S,O,T,N,A,P,C,z,R,$,F,I,D=e.i(43476),M=e.i(71645);let U=(...e)=>e.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim();var L={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let B=(0,M.forwardRef)(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:i="",children:s,iconNode:a,...o},l)=>(0,M.createElement)("svg",{ref:l,...L,width:t,height:t,stroke:e,strokeWidth:n?24*Number(r)/Number(t):r,className:U("lucide",i),...o},[...a.map(([e,t])=>(0,M.createElement)(e,t)),...Array.isArray(s)?s:[s]])),K=(e,t)=>{let r=(0,M.forwardRef)(({className:r,...n},i)=>(0,M.createElement)(B,{ref:i,iconNode:t,className:U(`lucide-${e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,r),...n}));return r.displayName=`${e}`,r},Z=K("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);var q=e.i(57688);let V=(e,t)=>{if(0===e.length)return t.classGroupId;let r=e[0],n=t.nextPart.get(r),i=n?V(e.slice(1),n):void 0;if(i)return i;if(0===t.validators.length)return;let s=e.join("-");return t.validators.find(({validator:e})=>e(s))?.classGroupId},J=/^\[(.+)\]$/,W=(e,t,r,n)=>{e.forEach(e=>{if("string"==typeof e){(""===e?t:G(t,e)).classGroupId=r;return}"function"==typeof e?H(e)?W(e(n),t,r,n):t.validators.push({validator:e,classGroupId:r}):Object.entries(e).forEach(([e,i])=>{W(i,G(t,e),r,n)})})},G=(e,t)=>{let r=e;return t.split("-").forEach(e=>{r.nextPart.has(e)||r.nextPart.set(e,{nextPart:new Map,validators:[]}),r=r.nextPart.get(e)}),r},H=e=>e.isThemeGetter,Q=(e,t)=>t?e.map(([e,r])=>[e,r.map(e=>"string"==typeof e?t+e:"object"==typeof e?Object.fromEntries(Object.entries(e).map(([e,r])=>[t+e,r])):e)]):e,Y=e=>{if(e.length<=1)return e;let t=[],r=[];return e.forEach(e=>{"["===e[0]?(t.push(...r.sort(),e),r=[]):r.push(e)}),t.push(...r.sort()),t},X=/\s+/;function ee(){let e,t,r=0,n="";for(;r<arguments.length;)(e=arguments[r++])&&(t=et(e))&&(n&&(n+=" "),n+=t);return n}let et=e=>{let t;if("string"==typeof e)return e;let r="";for(let n=0;n<e.length;n++)e[n]&&(t=et(e[n]))&&(r&&(r+=" "),r+=t);return r},er=e=>{let t=t=>t[e]||[];return t.isThemeGetter=!0,t},en=/^\[(?:([a-z-]+):)?(.+)\]$/i,ei=/^\d+\/\d+$/,es=new Set(["px","full","screen"]),ea=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,eo=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,el=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,eu=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,ec=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,ed=e=>ef(e)||es.has(e)||ei.test(e),eh=e=>eS(e,"length",eO),ef=e=>!!e&&!Number.isNaN(Number(e)),ep=e=>eS(e,"number",ef),em=e=>!!e&&Number.isInteger(Number(e)),eg=e=>e.endsWith("%")&&ef(e.slice(0,-1)),ey=e=>en.test(e),ev=e=>ea.test(e),eb=new Set(["length","size","percentage"]),ex=e=>eS(e,eb,eT),ew=e=>eS(e,"position",eT),e_=new Set(["image","url"]),ek=e=>eS(e,e_,eA),ej=e=>eS(e,"",eN),eE=()=>!0,eS=(e,t,r)=>{let n=en.exec(e);return!!n&&(n[1]?"string"==typeof t?n[1]===t:t.has(n[1]):r(n[2]))},eO=e=>eo.test(e)&&!el.test(e),eT=()=>!1,eN=e=>eu.test(e),eA=e=>ec.test(e),eP=function(e,...t){let r,n,i,s=function(o){let l;return n=(r={cache:(e=>{if(e<1)return{get:()=>void 0,set:()=>{}};let t=0,r=new Map,n=new Map,i=(i,s)=>{r.set(i,s),++t>e&&(t=0,n=r,r=new Map)};return{get(e){let t=r.get(e);return void 0!==t?t:void 0!==(t=n.get(e))?(i(e,t),t):void 0},set(e,t){r.has(e)?r.set(e,t):i(e,t)}}})((l=t.reduce((e,t)=>t(e),e())).cacheSize),parseClassName:(e=>{let{separator:t,experimentalParseClassName:r}=e,n=1===t.length,i=t[0],s=t.length,a=e=>{let r,a=[],o=0,l=0;for(let u=0;u<e.length;u++){let c=e[u];if(0===o){if(c===i&&(n||e.slice(u,u+s)===t)){a.push(e.slice(l,u)),l=u+s;continue}if("/"===c){r=u;continue}}"["===c?o++:"]"===c&&o--}let u=0===a.length?e:e.substring(l),c=u.startsWith("!"),d=c?u.substring(1):u;return{modifiers:a,hasImportantModifier:c,baseClassName:d,maybePostfixModifierPosition:r&&r>l?r-l:void 0}};return r?e=>r({className:e,parseClassName:a}):a})(l),...(e=>{let t=(e=>{let{theme:t,prefix:r}=e,n={nextPart:new Map,validators:[]};return Q(Object.entries(e.classGroups),r).forEach(([e,r])=>{W(r,n,e,t)}),n})(e),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=e;return{getClassGroupId:e=>{let r=e.split("-");return""===r[0]&&1!==r.length&&r.shift(),V(r,t)||(e=>{if(J.test(e)){let t=J.exec(e)[1],r=t?.substring(0,t.indexOf(":"));if(r)return"arbitrary.."+r}})(e)},getConflictingClassGroupIds:(e,t)=>{let i=r[e]||[];return t&&n[e]?[...i,...n[e]]:i}}})(l)}).cache.get,i=r.cache.set,s=a,a(o)};function a(e){let t=n(e);if(t)return t;let s=((e,t)=>{let{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:i}=t,s=[],a=e.trim().split(X),o="";for(let e=a.length-1;e>=0;e-=1){let t=a[e],{modifiers:l,hasImportantModifier:u,baseClassName:c,maybePostfixModifierPosition:d}=r(t),h=!!d,f=n(h?c.substring(0,d):c);if(!f){if(!h||!(f=n(c))){o=t+(o.length>0?" "+o:o);continue}h=!1}let p=Y(l).join(":"),m=u?p+"!":p,g=m+f;if(s.includes(g))continue;s.push(g);let y=i(f,h);for(let e=0;e<y.length;++e){let t=y[e];s.push(m+t)}o=t+(o.length>0?" "+o:o)}return o})(e,r);return i(e,s),s}return function(){return s(ee.apply(null,arguments))}}(()=>{let e=er("colors"),t=er("spacing"),r=er("blur"),n=er("brightness"),i=er("borderColor"),s=er("borderRadius"),a=er("borderSpacing"),o=er("borderWidth"),l=er("contrast"),u=er("grayscale"),c=er("hueRotate"),d=er("invert"),h=er("gap"),f=er("gradientColorStops"),p=er("gradientColorStopPositions"),m=er("inset"),g=er("margin"),y=er("opacity"),v=er("padding"),b=er("saturate"),x=er("scale"),w=er("sepia"),_=er("skew"),k=er("space"),j=er("translate"),E=()=>["auto","contain","none"],S=()=>["auto","hidden","clip","visible","scroll"],O=()=>["auto",ey,t],T=()=>[ey,t],N=()=>["",ed,eh],A=()=>["auto",ef,ey],P=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],C=()=>["solid","dashed","dotted","double","none"],z=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],R=()=>["start","end","center","between","around","evenly","stretch"],$=()=>["","0",ey],F=()=>["auto","avoid","all","avoid-page","page","left","right","column"],I=()=>[ef,ey];return{cacheSize:500,separator:":",theme:{colors:[eE],spacing:[ed,eh],blur:["none","",ev,ey],brightness:I(),borderColor:[e],borderRadius:["none","","full",ev,ey],borderSpacing:T(),borderWidth:N(),contrast:I(),grayscale:$(),hueRotate:I(),invert:$(),gap:T(),gradientColorStops:[e],gradientColorStopPositions:[eg,eh],inset:O(),margin:O(),opacity:I(),padding:T(),saturate:I(),scale:I(),sepia:$(),skew:I(),space:T(),translate:T()},classGroups:{aspect:[{aspect:["auto","square","video",ey]}],container:["container"],columns:[{columns:[ev]}],"break-after":[{"break-after":F()}],"break-before":[{"break-before":F()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...P(),ey]}],overflow:[{overflow:S()}],"overflow-x":[{"overflow-x":S()}],"overflow-y":[{"overflow-y":S()}],overscroll:[{overscroll:E()}],"overscroll-x":[{"overscroll-x":E()}],"overscroll-y":[{"overscroll-y":E()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[m]}],"inset-x":[{"inset-x":[m]}],"inset-y":[{"inset-y":[m]}],start:[{start:[m]}],end:[{end:[m]}],top:[{top:[m]}],right:[{right:[m]}],bottom:[{bottom:[m]}],left:[{left:[m]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",em,ey]}],basis:[{basis:O()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",ey]}],grow:[{grow:$()}],shrink:[{shrink:$()}],order:[{order:["first","last","none",em,ey]}],"grid-cols":[{"grid-cols":[eE]}],"col-start-end":[{col:["auto",{span:["full",em,ey]},ey]}],"col-start":[{"col-start":A()}],"col-end":[{"col-end":A()}],"grid-rows":[{"grid-rows":[eE]}],"row-start-end":[{row:["auto",{span:[em,ey]},ey]}],"row-start":[{"row-start":A()}],"row-end":[{"row-end":A()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",ey]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",ey]}],gap:[{gap:[h]}],"gap-x":[{"gap-x":[h]}],"gap-y":[{"gap-y":[h]}],"justify-content":[{justify:["normal",...R()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...R(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...R(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[v]}],px:[{px:[v]}],py:[{py:[v]}],ps:[{ps:[v]}],pe:[{pe:[v]}],pt:[{pt:[v]}],pr:[{pr:[v]}],pb:[{pb:[v]}],pl:[{pl:[v]}],m:[{m:[g]}],mx:[{mx:[g]}],my:[{my:[g]}],ms:[{ms:[g]}],me:[{me:[g]}],mt:[{mt:[g]}],mr:[{mr:[g]}],mb:[{mb:[g]}],ml:[{ml:[g]}],"space-x":[{"space-x":[k]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[k]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",ey,t]}],"min-w":[{"min-w":[ey,t,"min","max","fit"]}],"max-w":[{"max-w":[ey,t,"none","full","min","max","fit","prose",{screen:[ev]},ev]}],h:[{h:[ey,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[ey,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[ey,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[ey,t,"auto","min","max","fit"]}],"font-size":[{text:["base",ev,eh]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",ep]}],"font-family":[{font:[eE]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",ey]}],"line-clamp":[{"line-clamp":["none",ef,ep]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",ed,ey]}],"list-image":[{"list-image":["none",ey]}],"list-style-type":[{list:["none","disc","decimal",ey]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[y]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[y]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...C(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",ed,eh]}],"underline-offset":[{"underline-offset":["auto",ed,ey]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:T()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",ey]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",ey]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[y]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...P(),ew]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",ex]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},ek]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[p]}],"gradient-via-pos":[{via:[p]}],"gradient-to-pos":[{to:[p]}],"gradient-from":[{from:[f]}],"gradient-via":[{via:[f]}],"gradient-to":[{to:[f]}],rounded:[{rounded:[s]}],"rounded-s":[{"rounded-s":[s]}],"rounded-e":[{"rounded-e":[s]}],"rounded-t":[{"rounded-t":[s]}],"rounded-r":[{"rounded-r":[s]}],"rounded-b":[{"rounded-b":[s]}],"rounded-l":[{"rounded-l":[s]}],"rounded-ss":[{"rounded-ss":[s]}],"rounded-se":[{"rounded-se":[s]}],"rounded-ee":[{"rounded-ee":[s]}],"rounded-es":[{"rounded-es":[s]}],"rounded-tl":[{"rounded-tl":[s]}],"rounded-tr":[{"rounded-tr":[s]}],"rounded-br":[{"rounded-br":[s]}],"rounded-bl":[{"rounded-bl":[s]}],"border-w":[{border:[o]}],"border-w-x":[{"border-x":[o]}],"border-w-y":[{"border-y":[o]}],"border-w-s":[{"border-s":[o]}],"border-w-e":[{"border-e":[o]}],"border-w-t":[{"border-t":[o]}],"border-w-r":[{"border-r":[o]}],"border-w-b":[{"border-b":[o]}],"border-w-l":[{"border-l":[o]}],"border-opacity":[{"border-opacity":[y]}],"border-style":[{border:[...C(),"hidden"]}],"divide-x":[{"divide-x":[o]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[o]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[y]}],"divide-style":[{divide:C()}],"border-color":[{border:[i]}],"border-color-x":[{"border-x":[i]}],"border-color-y":[{"border-y":[i]}],"border-color-s":[{"border-s":[i]}],"border-color-e":[{"border-e":[i]}],"border-color-t":[{"border-t":[i]}],"border-color-r":[{"border-r":[i]}],"border-color-b":[{"border-b":[i]}],"border-color-l":[{"border-l":[i]}],"divide-color":[{divide:[i]}],"outline-style":[{outline:["",...C()]}],"outline-offset":[{"outline-offset":[ed,ey]}],"outline-w":[{outline:[ed,eh]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:N()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[y]}],"ring-offset-w":[{"ring-offset":[ed,eh]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",ev,ej]}],"shadow-color":[{shadow:[eE]}],opacity:[{opacity:[y]}],"mix-blend":[{"mix-blend":[...z(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":z()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[n]}],contrast:[{contrast:[l]}],"drop-shadow":[{"drop-shadow":["","none",ev,ey]}],grayscale:[{grayscale:[u]}],"hue-rotate":[{"hue-rotate":[c]}],invert:[{invert:[d]}],saturate:[{saturate:[b]}],sepia:[{sepia:[w]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[l]}],"backdrop-grayscale":[{"backdrop-grayscale":[u]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[c]}],"backdrop-invert":[{"backdrop-invert":[d]}],"backdrop-opacity":[{"backdrop-opacity":[y]}],"backdrop-saturate":[{"backdrop-saturate":[b]}],"backdrop-sepia":[{"backdrop-sepia":[w]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[a]}],"border-spacing-x":[{"border-spacing-x":[a]}],"border-spacing-y":[{"border-spacing-y":[a]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",ey]}],duration:[{duration:I()}],ease:[{ease:["linear","in","out","in-out",ey]}],delay:[{delay:I()}],animate:[{animate:["none","spin","ping","pulse","bounce",ey]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[x]}],"scale-x":[{"scale-x":[x]}],"scale-y":[{"scale-y":[x]}],rotate:[{rotate:[em,ey]}],"translate-x":[{"translate-x":[j]}],"translate-y":[{"translate-y":[j]}],"skew-x":[{"skew-x":[_]}],"skew-y":[{"skew-y":[_]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",ey]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",ey]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":T()}],"scroll-mx":[{"scroll-mx":T()}],"scroll-my":[{"scroll-my":T()}],"scroll-ms":[{"scroll-ms":T()}],"scroll-me":[{"scroll-me":T()}],"scroll-mt":[{"scroll-mt":T()}],"scroll-mr":[{"scroll-mr":T()}],"scroll-mb":[{"scroll-mb":T()}],"scroll-ml":[{"scroll-ml":T()}],"scroll-p":[{"scroll-p":T()}],"scroll-px":[{"scroll-px":T()}],"scroll-py":[{"scroll-py":T()}],"scroll-ps":[{"scroll-ps":T()}],"scroll-pe":[{"scroll-pe":T()}],"scroll-pt":[{"scroll-pt":T()}],"scroll-pr":[{"scroll-pr":T()}],"scroll-pb":[{"scroll-pb":T()}],"scroll-pl":[{"scroll-pl":T()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",ey]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[ed,eh,ep]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}}),eC={key:"/key.svg",lock:"/lock.svg",shield:"/shield.svg",upload:"/upload.svg",smartphone:"/smartphone.svg",cloud:"/cloud.svg",clock:"/clock.svg",search:"/search.svg",image:"/image.svg",folder:"/Openfolder.svg",refresh:"/RefreshCw.svg",chevronRight:"/ChevronRight.svg"};function ez({name:e,className:t,size:r=24}){return(0,D.jsx)("div",{className:function(...e){return eP(function(){for(var e,t,r=0,n="",i=arguments.length;r<i;r++)(e=arguments[r])&&(t=function e(t){var r,n,i="";if("string"==typeof t||"number"==typeof t)i+=t;else if("object"==typeof t)if(Array.isArray(t)){var s=t.length;for(r=0;r<s;r++)t[r]&&(n=e(t[r]))&&(i&&(i+=" "),i+=n)}else for(n in t)t[n]&&(i&&(i+=" "),i+=n);return i}(e))&&(n&&(n+=" "),n+=t);return n}(e))}("relative inline-block shrink-0",t),style:{width:r,height:r},children:(0,D.jsx)(q.default,{src:eC[e],alt:e,fill:!0,className:"object-contain",unoptimized:!0})})}let eR=K("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]),e$=()=>(0,D.jsxs)("div",{className:"loader-container",children:[(0,D.jsx)("div",{className:"peeking-photo-icon",children:(0,D.jsx)(eR,{strokeWidth:1.5})}),(0,D.jsxs)("div",{className:"shield-container",children:[Array.from({length:150}).map((e,t)=>(0,D.jsx)("div",{className:"particle",style:{animationDelay:`${t%10*.1+.02*Math.floor(t/10)}s`}},t)),(0,D.jsxs)("div",{className:"shield-structure",children:[(0,D.jsx)("div",{className:"structure-line line-1"}),(0,D.jsx)("div",{className:"structure-line line-2"}),(0,D.jsx)("div",{className:"structure-line line-3"}),(0,D.jsx)("div",{className:"structure-line line-4"})]})]}),(0,D.jsx)("div",{className:"loading-text",children:"LDT..."})]}),eF=K("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),eI=K("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),eD=K("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),eM=K("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]),eU=K("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),eL=K("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);var eB=e.i(47167);let eK=Object.create(null),eZ=e=>globalThis.process?.env||globalThis.Deno?.env.toObject()||globalThis.__env__||(e?eK:globalThis),eq=new Proxy(eK,{get:(e,t)=>eZ()[t]??eK[t],has:(e,t)=>t in eZ()||t in eK,set:(e,t,r)=>(eZ(!0)[t]=r,!0),deleteProperty(e,t){if(!t)return!1;let r=eZ(!0);return delete r[t],!0},ownKeys:()=>Object.keys(eZ(!0))});function eV(e,t){return void 0!==eB.default&&eB.default.env?eB.default.env[e]??t:"u">typeof Deno?Deno.env.get(e)??t:"u">typeof Bun?Bun.env[e]??t:t}void 0!==eB.default&&eB.default.env,Object.freeze({get BETTER_AUTH_SECRET(){return eV("BETTER_AUTH_SECRET")},get AUTH_SECRET(){return eV("AUTH_SECRET")},get BETTER_AUTH_TELEMETRY(){return eV("BETTER_AUTH_TELEMETRY")},get BETTER_AUTH_TELEMETRY_ID(){return eV("BETTER_AUTH_TELEMETRY_ID")},get NODE_ENV(){return eV("NODE_ENV","development")},get PACKAGE_VERSION(){return eV("PACKAGE_VERSION","0.0.0")},get BETTER_AUTH_TELEMETRY_ENDPOINT(){return eV("BETTER_AUTH_TELEMETRY_ENDPOINT","https://telemetry.better-auth.com/v1/track")}});let eJ={eterm:4,cons25:4,console:4,cygwin:4,dtterm:4,gnome:4,hurd:4,jfbterm:4,konsole:4,kterm:4,mlterm:4,mosh:24,putty:4,st:4,"rxvt-unicode-24bit":24,terminator:24,"xterm-kitty":24},eW=new Map(Object.entries({APPVEYOR:8,BUILDKITE:8,CIRCLECI:24,DRONE:8,GITEA_ACTIONS:24,GITHUB_ACTIONS:24,GITLAB_CI:8,TRAVIS:8})),eG=[/ansi/,/color/,/linux/,/direct/,/^con[0-9]*x[0-9]/,/^rxvt/,/^screen/,/^xterm/,/^vt100/,/^vt220/],eH="\x1b[0m",eQ="\x1b[31m",eY="\x1b[32m",eX="\x1b[33m",e0="\x1b[34m",e1="\x1b[35m",e2=["debug","info","success","warn","error"],e3={info:e0,success:eY,warn:eX,error:eQ,debug:e1};function e4(e,t,r){function n(r,n){if(r._zod||Object.defineProperty(r,"_zod",{value:{def:n,constr:a,traits:new Set},enumerable:!1}),r._zod.traits.has(e))return;r._zod.traits.add(e),t(r,n);let i=a.prototype,s=Object.keys(i);for(let e=0;e<s.length;e++){let t=s[e];t in r||(r[t]=i[t].bind(r))}}let i=r?.Parent??Object;class s extends i{}function a(e){var t;let i=r?.Parent?new s:this;for(let r of(n(i,e),(t=i._zod).deferred??(t.deferred=[]),i._zod.deferred))r();return i}return Object.defineProperty(s,"name",{value:e}),Object.defineProperty(a,"init",{value:n}),Object.defineProperty(a,Symbol.hasInstance,{value:t=>!!r?.Parent&&t instanceof r.Parent||t?._zod?.traits?.has(e)}),Object.defineProperty(a,"name",{value:e}),a}t=c?.disabled!==!0,r=c?.level??"error",n=c?.disableColors!==void 0?!c.disableColors:1!==function(){if(void 0!==eV("FORCE_COLOR"))switch(eV("FORCE_COLOR")){case"":case"1":case"true":return 4;case"2":return 8;case"3":return 24;default:return 1}if(void 0!==eV("NODE_DISABLE_COLORS")&&""!==eV("NODE_DISABLE_COLORS")||void 0!==eV("NO_COLOR")&&""!==eV("NO_COLOR")||"dumb"===eV("TERM"))return 1;if(eV("TMUX"))return 24;if("TF_BUILD"in eq&&"AGENT_NAME"in eq)return 4;if("CI"in eq){for(let{0:e,1:t}of eW)if(e in eq)return t;return"codeship"===eV("CI_NAME")?8:1}if("TEAMCITY_VERSION"in eq)return null!==/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.exec(eV("TEAMCITY_VERSION"))?4:1;switch(eV("TERM_PROGRAM")){case"iTerm.app":if(!eV("TERM_PROGRAM_VERSION")||null!==/^[0-2]\./.exec(eV("TERM_PROGRAM_VERSION")))return 8;return 24;case"HyperTerm":case"MacTerm":return 24;case"Apple_Terminal":return 8}if("truecolor"===eV("COLORTERM")||"24bit"===eV("COLORTERM"))return 24;if(eV("TERM")){if(null!==/truecolor/.exec(eV("TERM")))return 24;if(null!==/^xterm-256/.exec(eV("TERM")))return 8;let e=eV("TERM").toLowerCase();if(eJ[e])return eJ[e];if(eG.some(t=>null!==t.exec(e)))return 4}return eV("COLORTERM")?4:1}(),Object.fromEntries(e2.map(e=>[e,(...[i,...s])=>((e,i,s=[])=>{let a;if(!t||!(e2.indexOf(e)>=e2.indexOf(r)))return;let o=(a=new Date().toISOString(),n?`\x1b[2m${a}${eH} ${e3[e]}${e.toUpperCase()}${eH} \x1b[1m[Better Auth]:${eH} ${i}`:`${a} ${e.toUpperCase()} [Better Auth]: ${i}`);c&&"function"==typeof c.log?c.log("success"===e?"info":e,i,...s):"error"===e?console.error(o,...s):"warn"===e?console.warn(o,...s):console.log(o,...s)})(e,i,s)])),Object.freeze({status:"aborted"}),Symbol("zod_brand");class e5 extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}class e6 extends Error{constructor(e){super(`Encountered unidirectional transform during encode: ${e}`),this.name="ZodEncodeError"}}let e8={};function e7(e){return e&&Object.assign(e8,e),e8}function e9(e){return e}function te(e){return e}function tt(e){}function tr(e){throw Error("Unexpected value in exhaustive check")}function tn(e){}function ti(e){let t=Object.values(e).filter(e=>"number"==typeof e);return Object.entries(e).filter(([e,r])=>-1===t.indexOf(+e)).map(([e,t])=>t)}function ts(e,t="|"){return e.map(e=>tR(e)).join(t)}function ta(e,t){return"bigint"==typeof t?t.toString():t}function to(e){return{get value(){{let t=e();return Object.defineProperty(this,"value",{value:t}),t}}}}function tl(e){return null==e}function tu(e){let t=+!!e.startsWith("^"),r=e.endsWith("$")?e.length-1:e.length;return e.slice(t,r)}function tc(e,t){let r=(e.toString().split(".")[1]||"").length,n=t.toString(),i=(n.split(".")[1]||"").length;if(0===i&&/\d?e-\d?/.test(n)){let e=n.match(/\d?e-(\d?)/);e?.[1]&&(i=Number.parseInt(e[1]))}let s=r>i?r:i;return Number.parseInt(e.toFixed(s).replace(".",""))%Number.parseInt(t.toFixed(s).replace(".",""))/10**s}let td=Symbol("evaluating");function th(e,t,r){let n;Object.defineProperty(e,t,{get(){if(n!==td)return void 0===n&&(n=td,n=r()),n},set(r){Object.defineProperty(e,t,{value:r})},configurable:!0})}function tf(e){return Object.create(Object.getPrototypeOf(e),Object.getOwnPropertyDescriptors(e))}function tp(e,t,r){Object.defineProperty(e,t,{value:r,writable:!0,enumerable:!0,configurable:!0})}function tm(...e){let t={};for(let r of e)Object.assign(t,Object.getOwnPropertyDescriptors(r));return Object.defineProperties({},t)}function tg(e){return tm(e._zod.def)}function ty(e,t){return t?t.reduce((e,t)=>e?.[t],e):e}function tv(e){let t=Object.keys(e);return Promise.all(t.map(t=>e[t])).then(e=>{let r={};for(let n=0;n<t.length;n++)r[t[n]]=e[n];return r})}function tb(e=10){let t="abcdefghijklmnopqrstuvwxyz",r="";for(let n=0;n<e;n++)r+=t[Math.floor(Math.random()*t.length)];return r}function tx(e){return JSON.stringify(e)}function tw(e){return e.toLowerCase().trim().replace(/[^\w\s-]/g,"").replace(/[\s_-]+/g,"-").replace(/^-+|-+$/g,"")}let t_="captureStackTrace"in Error?Error.captureStackTrace:(...e)=>{};function tk(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)}let tj=to(()=>{if("u">typeof navigator&&navigator?.userAgent?.includes("Cloudflare"))return!1;try{return Function(""),!0}catch(e){return!1}});function tE(e){if(!1===tk(e))return!1;let t=e.constructor;if(void 0===t||"function"!=typeof t)return!0;let r=t.prototype;return!1!==tk(r)&&!1!==Object.prototype.hasOwnProperty.call(r,"isPrototypeOf")}function tS(e){return tE(e)?{...e}:Array.isArray(e)?[...e]:e}function tO(e){let t=0;for(let r in e)Object.prototype.hasOwnProperty.call(e,r)&&t++;return t}let tT=new Set(["string","number","symbol"]),tN=new Set(["string","number","bigint","boolean","symbol","undefined"]);function tA(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function tP(e,t,r){let n=new e._zod.constr(t??e._zod.def);return(!t||r?.parent)&&(n._zod.parent=e),n}function tC(e){if(!e)return{};if("string"==typeof e)return{error:()=>e};if(e?.message!==void 0){if(e?.error!==void 0)throw Error("Cannot specify both `message` and `error` params");e.error=e.message}return(delete e.message,"string"==typeof e.error)?{...e,error:()=>e.error}:e}function tz(e){let t;return new Proxy({},{get:(r,n,i)=>(t??(t=e()),Reflect.get(t,n,i)),set:(r,n,i,s)=>(t??(t=e()),Reflect.set(t,n,i,s)),has:(r,n)=>(t??(t=e()),Reflect.has(t,n)),deleteProperty:(r,n)=>(t??(t=e()),Reflect.deleteProperty(t,n)),ownKeys:r=>(t??(t=e()),Reflect.ownKeys(t)),getOwnPropertyDescriptor:(r,n)=>(t??(t=e()),Reflect.getOwnPropertyDescriptor(t,n)),defineProperty:(r,n,i)=>(t??(t=e()),Reflect.defineProperty(t,n,i))})}function tR(e){return"bigint"==typeof e?e.toString()+"n":"string"==typeof e?`"${e}"`:`${e}`}function t$(e){return Object.keys(e).filter(t=>"optional"===e[t]._zod.optin&&"optional"===e[t]._zod.optout)}let tF={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-0x80000000,0x7fffffff],uint32:[0,0xffffffff],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]},tI={int64:[BigInt("-9223372036854775808"),BigInt("9223372036854775807")],uint64:[BigInt(0),BigInt("18446744073709551615")]};function tD(e,t){let r=e._zod.def,n=r.checks;if(n&&n.length>0)throw Error(".pick() cannot be used on object schemas containing refinements");let i=tm(e._zod.def,{get shape(){let e={};for(let n in t){if(!(n in r.shape))throw Error(`Unrecognized key: "${n}"`);t[n]&&(e[n]=r.shape[n])}return tp(this,"shape",e),e},checks:[]});return tP(e,i)}function tM(e,t){let r=e._zod.def,n=r.checks;if(n&&n.length>0)throw Error(".omit() cannot be used on object schemas containing refinements");let i=tm(e._zod.def,{get shape(){let n={...e._zod.def.shape};for(let e in t){if(!(e in r.shape))throw Error(`Unrecognized key: "${e}"`);t[e]&&delete n[e]}return tp(this,"shape",n),n},checks:[]});return tP(e,i)}function tU(e,t){if(!tE(t))throw Error("Invalid input to extend: expected a plain object");let r=e._zod.def.checks;if(r&&r.length>0){let r=e._zod.def.shape;for(let e in t)if(void 0!==Object.getOwnPropertyDescriptor(r,e))throw Error("Cannot overwrite keys on object schemas containing refinements. Use `.safeExtend()` instead.")}let n=tm(e._zod.def,{get shape(){let r={...e._zod.def.shape,...t};return tp(this,"shape",r),r}});return tP(e,n)}function tL(e,t){if(!tE(t))throw Error("Invalid input to safeExtend: expected a plain object");let r=tm(e._zod.def,{get shape(){let r={...e._zod.def.shape,...t};return tp(this,"shape",r),r}});return tP(e,r)}function tB(e,t){let r=tm(e._zod.def,{get shape(){let r={...e._zod.def.shape,...t._zod.def.shape};return tp(this,"shape",r),r},get catchall(){return t._zod.def.catchall},checks:[]});return tP(e,r)}function tK(e,t,r){let n=t._zod.def.checks;if(n&&n.length>0)throw Error(".partial() cannot be used on object schemas containing refinements");let i=tm(t._zod.def,{get shape(){let n=t._zod.def.shape,i={...n};if(r)for(let t in r){if(!(t in n))throw Error(`Unrecognized key: "${t}"`);r[t]&&(i[t]=e?new e({type:"optional",innerType:n[t]}):n[t])}else for(let t in n)i[t]=e?new e({type:"optional",innerType:n[t]}):n[t];return tp(this,"shape",i),i},checks:[]});return tP(t,i)}function tZ(e,t,r){let n=tm(t._zod.def,{get shape(){let n=t._zod.def.shape,i={...n};if(r)for(let t in r){if(!(t in i))throw Error(`Unrecognized key: "${t}"`);r[t]&&(i[t]=new e({type:"nonoptional",innerType:n[t]}))}else for(let t in n)i[t]=new e({type:"nonoptional",innerType:n[t]});return tp(this,"shape",i),i}});return tP(t,n)}function tq(e,t=0){if(!0===e.aborted)return!0;for(let r=t;r<e.issues.length;r++)if(e.issues[r]?.continue!==!0)return!0;return!1}function tV(e,t){return t.map(t=>(t.path??(t.path=[]),t.path.unshift(e),t))}function tJ(e){return"string"==typeof e?e:e?.message}function tW(e,t,r){let n={...e,path:e.path??[]};return e.message||(n.message=tJ(e.inst?._zod.def?.error?.(e))??tJ(t?.error?.(e))??tJ(r.customError?.(e))??tJ(r.localeError?.(e))??"Invalid input"),delete n.inst,delete n.continue,t?.reportInput||delete n.input,n}function tG(e){return e instanceof Set?"set":e instanceof Map?"map":e instanceof File?"file":"unknown"}function tH(e){return Array.isArray(e)?"array":"string"==typeof e?"string":"unknown"}function tQ(e){let t=typeof e;switch(t){case"number":return Number.isNaN(e)?"nan":"number";case"object":if(null===e)return"null";if(Array.isArray(e))return"array";if(e&&Object.getPrototypeOf(e)!==Object.prototype&&"constructor"in e&&e.constructor)return e.constructor.name}return t}function tY(...e){let[t,r,n]=e;return"string"==typeof t?{message:t,code:"custom",input:r,inst:n}:{...t}}function tX(e){return Object.entries(e).filter(([e,t])=>Number.isNaN(Number.parseInt(e,10))).map(e=>e[1])}function t0(e){let t=atob(e),r=new Uint8Array(t.length);for(let e=0;e<t.length;e++)r[e]=t.charCodeAt(e);return r}function t1(e){let t="";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return btoa(t)}function t2(e){let t=e.replace(/-/g,"+").replace(/_/g,"/"),r="=".repeat((4-t.length%4)%4);return t0(t+r)}function t3(e){return t1(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function t4(e){let t=e.replace(/^0x/,"");if(t.length%2!=0)throw Error("Invalid hex string length");let r=new Uint8Array(t.length/2);for(let e=0;e<t.length;e+=2)r[e/2]=Number.parseInt(t.slice(e,e+2),16);return r}function t5(e){return Array.from(e).map(e=>e.toString(16).padStart(2,"0")).join("")}class t6{constructor(...e){}}e.s(["BIGINT_FORMAT_RANGES",0,tI,"Class",()=>t6,"NUMBER_FORMAT_RANGES",0,tF,"aborted",()=>tq,"allowsEval",0,tj,"assert",()=>tn,"assertEqual",()=>e9,"assertIs",()=>tt,"assertNever",()=>tr,"assertNotEqual",()=>te,"assignProp",()=>tp,"base64ToUint8Array",()=>t0,"base64urlToUint8Array",()=>t2,"cached",()=>to,"captureStackTrace",0,t_,"cleanEnum",()=>tX,"cleanRegex",()=>tu,"clone",()=>tP,"cloneDef",()=>tg,"createTransparentProxy",()=>tz,"defineLazy",()=>th,"esc",()=>tx,"escapeRegex",()=>tA,"extend",()=>tU,"finalizeIssue",()=>tW,"floatSafeRemainder",()=>tc,"getElementAtPath",()=>ty,"getEnumValues",()=>ti,"getLengthableOrigin",()=>tH,"getParsedType",0,e=>{let t=typeof e;switch(t){case"undefined":return"undefined";case"string":return"string";case"number":return Number.isNaN(e)?"nan":"number";case"boolean":return"boolean";case"function":return"function";case"bigint":return"bigint";case"symbol":return"symbol";case"object":if(Array.isArray(e))return"array";if(null===e)return"null";if(e.then&&"function"==typeof e.then&&e.catch&&"function"==typeof e.catch)return"promise";if("u">typeof Map&&e instanceof Map)return"map";if("u">typeof Set&&e instanceof Set)return"set";if("u">typeof Date&&e instanceof Date)return"date";if("u">typeof File&&e instanceof File)return"file";return"object";default:throw Error(`Unknown data type: ${t}`)}},"getSizableOrigin",()=>tG,"hexToUint8Array",()=>t4,"isObject",()=>tk,"isPlainObject",()=>tE,"issue",()=>tY,"joinValues",()=>ts,"jsonStringifyReplacer",()=>ta,"merge",()=>tB,"mergeDefs",()=>tm,"normalizeParams",()=>tC,"nullish",()=>tl,"numKeys",()=>tO,"objectClone",()=>tf,"omit",()=>tM,"optionalKeys",()=>t$,"parsedType",()=>tQ,"partial",()=>tK,"pick",()=>tD,"prefixIssues",()=>tV,"primitiveTypes",0,tN,"promiseAllObject",()=>tv,"propertyKeyTypes",0,tT,"randomString",()=>tb,"required",()=>tZ,"safeExtend",()=>tL,"shallowClone",()=>tS,"slugify",()=>tw,"stringifyPrimitive",()=>tR,"uint8ArrayToBase64",()=>t1,"uint8ArrayToBase64url",()=>t3,"uint8ArrayToHex",()=>t5,"unwrapMessage",()=>tJ],22143);let t8=(e,t)=>{e.name="$ZodError",Object.defineProperty(e,"_zod",{value:e._zod,enumerable:!1}),Object.defineProperty(e,"issues",{value:t,enumerable:!1}),e.message=JSON.stringify(t,ta,2),Object.defineProperty(e,"toString",{value:()=>e.message,enumerable:!1})},t7=e4("$ZodError",t8),t9=e4("$ZodError",t8,{Parent:Error}),re=e=>(t,r,n,i)=>{let s=n?Object.assign(n,{async:!1}):{async:!1},a=t._zod.run({value:r,issues:[]},s);if(a instanceof Promise)throw new e5;if(a.issues.length){let t=new(i?.Err??e)(a.issues.map(e=>tW(e,s,e7())));throw t_(t,i?.callee),t}return a.value},rt=re(t9),rr=e=>async(t,r,n,i)=>{let s=n?Object.assign(n,{async:!0}):{async:!0},a=t._zod.run({value:r,issues:[]},s);if(a instanceof Promise&&(a=await a),a.issues.length){let t=new(i?.Err??e)(a.issues.map(e=>tW(e,s,e7())));throw t_(t,i?.callee),t}return a.value},rn=rr(t9),ri=e=>(t,r,n)=>{let i=n?{...n,async:!1}:{async:!1},s=t._zod.run({value:r,issues:[]},i);if(s instanceof Promise)throw new e5;return s.issues.length?{success:!1,error:new(e??t7)(s.issues.map(e=>tW(e,i,e7())))}:{success:!0,data:s.value}},rs=ri(t9),ra=e=>async(t,r,n)=>{let i=n?Object.assign(n,{async:!0}):{async:!0},s=t._zod.run({value:r,issues:[]},i);return s instanceof Promise&&(s=await s),s.issues.length?{success:!1,error:new e(s.issues.map(e=>tW(e,i,e7())))}:{success:!0,data:s.value}},ro=ra(t9),rl=/^[cC][^\s-]{8,}$/,ru=/^[0-9a-z]+$/,rc=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,rd=/^[0-9a-vA-V]{20}$/,rh=/^[A-Za-z0-9]{27}$/,rf=/^[a-zA-Z0-9_-]{21}$/,rp=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/,rm=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,rg=e=>e?RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${e}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/,ry=rg(4),rv=rg(6),rb=rg(7),rx=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/,rw=/^[^\s@"]{1,64}@[^\s@]{1,255}$/u;function r_(){return RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")}let rk=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,rj=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:))$/,rE=e=>{let t=tA(e??":");return RegExp(`^(?:[0-9A-F]{2}${t}){5}[0-9A-F]{2}$|^(?:[0-9a-f]{2}${t}){5}[0-9a-f]{2}$`)},rS=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,rO=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,rT=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,rN=/^[A-Za-z0-9_-]*$/,rA=/^\+[1-9]\d{6,14}$/,rP="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",rC=RegExp(`^${rP}$`);function rz(e){let t="(?:[01]\\d|2[0-3]):[0-5]\\d";return"number"==typeof e.precision?-1===e.precision?`${t}`:0===e.precision?`${t}:[0-5]\\d`:`${t}:[0-5]\\d\\.\\d{${e.precision}}`:`${t}(?::[0-5]\\d(?:\\.\\d+)?)?`}function rR(e){return RegExp(`^${rz(e)}$`)}function r$(e){let t=rz({precision:e.precision}),r=["Z"];e.local&&r.push(""),e.offset&&r.push("([+-](?:[01]\\d|2[0-3]):[0-5]\\d)");let n=`${t}(?:${r.join("|")})`;return RegExp(`^${rP}T(?:${n})$`)}let rF=e=>{let t=e?`[\\s\\S]{${e?.minimum??0},${e?.maximum??""}}`:"[\\s\\S]*";return RegExp(`^${t}$`)},rI=/^-?\d+n?$/,rD=/^-?\d+$/,rM=/^-?\d+(?:\.\d+)?$/,rU=/^(?:true|false)$/i,rL=/^null$/i,rB=/^undefined$/i,rK=/^[^A-Z]*$/,rZ=/^[^a-z]*$/;function rq(e,t){return RegExp(`^[A-Za-z0-9+/]{${e}}${t}$`)}function rV(e){return RegExp(`^[A-Za-z0-9_-]{${e}}$`)}let rJ=rq(22,"=="),rW=rV(22),rG=rq(27,"="),rH=rV(27),rQ=rq(43,"="),rY=rV(43),rX=rq(64,""),r0=rV(64),r1=rq(86,"=="),r2=rV(86);e.s(["base64",0,rT,"base64url",0,rN,"bigint",0,rI,"boolean",0,rU,"browserEmail",0,/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,"cidrv4",0,rS,"cidrv6",0,rO,"cuid",0,rl,"cuid2",0,ru,"date",0,rC,"datetime",()=>r$,"domain",0,/^([a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?\.)+[a-zA-Z]{2,}$/,"duration",0,rp,"e164",0,rA,"email",0,rx,"emoji",()=>r_,"extendedDuration",0,/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,"guid",0,rm,"hex",0,/^[0-9a-fA-F]*$/,"hostname",0,/^(?=.{1,253}\.?$)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[-0-9a-zA-Z]{0,61}[0-9a-zA-Z])?)*\.?$/,"html5Email",0,/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,"idnEmail",0,rw,"integer",0,rD,"ipv4",0,rk,"ipv6",0,rj,"ksuid",0,rh,"lowercase",0,rK,"mac",0,rE,"md5_base64",0,rJ,"md5_base64url",0,rW,"md5_hex",0,/^[0-9a-fA-F]{32}$/,"nanoid",0,rf,"null",()=>rL,"number",0,rM,"rfc5322Email",0,/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,"sha1_base64",0,rG,"sha1_base64url",0,rH,"sha1_hex",0,/^[0-9a-fA-F]{40}$/,"sha256_base64",0,rQ,"sha256_base64url",0,rY,"sha256_hex",0,/^[0-9a-fA-F]{64}$/,"sha384_base64",0,rX,"sha384_base64url",0,r0,"sha384_hex",0,/^[0-9a-fA-F]{96}$/,"sha512_base64",0,r1,"sha512_base64url",0,r2,"sha512_hex",0,/^[0-9a-fA-F]{128}$/,"string",0,rF,"time",()=>rR,"ulid",0,rc,"undefined",()=>rB,"unicodeEmail",0,rw,"uppercase",0,rZ,"uuid",0,rg,"uuid4",0,ry,"uuid6",0,rv,"uuid7",0,rb,"xid",0,rd],82358);let r3=e4("$ZodCheck",(e,t)=>{var r;e._zod??(e._zod={}),e._zod.def=t,(r=e._zod).onattach??(r.onattach=[])}),r4={number:"number",bigint:"bigint",object:"date"},r5=e4("$ZodCheckLessThan",(e,t)=>{r3.init(e,t);let r=r4[typeof t.value];e._zod.onattach.push(e=>{let r=e._zod.bag,n=(t.inclusive?r.maximum:r.exclusiveMaximum)??1/0;t.value<n&&(t.inclusive?r.maximum=t.value:r.exclusiveMaximum=t.value)}),e._zod.check=n=>{(t.inclusive?n.value<=t.value:n.value<t.value)||n.issues.push({origin:r,code:"too_big",maximum:"object"==typeof t.value?t.value.getTime():t.value,input:n.value,inclusive:t.inclusive,inst:e,continue:!t.abort})}}),r6=e4("$ZodCheckGreaterThan",(e,t)=>{r3.init(e,t);let r=r4[typeof t.value];e._zod.onattach.push(e=>{let r=e._zod.bag,n=(t.inclusive?r.minimum:r.exclusiveMinimum)??-1/0;t.value>n&&(t.inclusive?r.minimum=t.value:r.exclusiveMinimum=t.value)}),e._zod.check=n=>{(t.inclusive?n.value>=t.value:n.value>t.value)||n.issues.push({origin:r,code:"too_small",minimum:"object"==typeof t.value?t.value.getTime():t.value,input:n.value,inclusive:t.inclusive,inst:e,continue:!t.abort})}}),r8=e4("$ZodCheckMultipleOf",(e,t)=>{r3.init(e,t),e._zod.onattach.push(e=>{var r;(r=e._zod.bag).multipleOf??(r.multipleOf=t.value)}),e._zod.check=r=>{if(typeof r.value!=typeof t.value)throw Error("Cannot mix number and bigint in multiple_of check.");("bigint"==typeof r.value?r.value%t.value===BigInt(0):0===tc(r.value,t.value))||r.issues.push({origin:typeof r.value,code:"not_multiple_of",divisor:t.value,input:r.value,inst:e,continue:!t.abort})}}),r7=e4("$ZodCheckNumberFormat",(e,t)=>{r3.init(e,t),t.format=t.format||"float64";let r=t.format?.includes("int"),n=r?"int":"number",[i,s]=tF[t.format];e._zod.onattach.push(e=>{let n=e._zod.bag;n.format=t.format,n.minimum=i,n.maximum=s,r&&(n.pattern=rD)}),e._zod.check=a=>{let o=a.value;if(r){if(!Number.isInteger(o))return void a.issues.push({expected:n,format:t.format,code:"invalid_type",continue:!1,input:o,inst:e});if(!Number.isSafeInteger(o))return void(o>0?a.issues.push({input:o,code:"too_big",maximum:Number.MAX_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:e,origin:n,inclusive:!0,continue:!t.abort}):a.issues.push({input:o,code:"too_small",minimum:Number.MIN_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:e,origin:n,inclusive:!0,continue:!t.abort}))}o<i&&a.issues.push({origin:"number",input:o,code:"too_small",minimum:i,inclusive:!0,inst:e,continue:!t.abort}),o>s&&a.issues.push({origin:"number",input:o,code:"too_big",maximum:s,inclusive:!0,inst:e,continue:!t.abort})}}),r9=e4("$ZodCheckBigIntFormat",(e,t)=>{r3.init(e,t);let[r,n]=tI[t.format];e._zod.onattach.push(e=>{let i=e._zod.bag;i.format=t.format,i.minimum=r,i.maximum=n}),e._zod.check=i=>{let s=i.value;s<r&&i.issues.push({origin:"bigint",input:s,code:"too_small",minimum:r,inclusive:!0,inst:e,continue:!t.abort}),s>n&&i.issues.push({origin:"bigint",input:s,code:"too_big",maximum:n,inclusive:!0,inst:e,continue:!t.abort})}}),ne=e4("$ZodCheckMaxSize",(e,t)=>{var r;r3.init(e,t),(r=e._zod.def).when??(r.when=e=>{let t=e.value;return!tl(t)&&void 0!==t.size}),e._zod.onattach.push(e=>{let r=e._zod.bag.maximum??1/0;t.maximum<r&&(e._zod.bag.maximum=t.maximum)}),e._zod.check=r=>{let n=r.value;n.size<=t.maximum||r.issues.push({origin:tG(n),code:"too_big",maximum:t.maximum,inclusive:!0,input:n,inst:e,continue:!t.abort})}}),nt=e4("$ZodCheckMinSize",(e,t)=>{var r;r3.init(e,t),(r=e._zod.def).when??(r.when=e=>{let t=e.value;return!tl(t)&&void 0!==t.size}),e._zod.onattach.push(e=>{let r=e._zod.bag.minimum??-1/0;t.minimum>r&&(e._zod.bag.minimum=t.minimum)}),e._zod.check=r=>{let n=r.value;n.size>=t.minimum||r.issues.push({origin:tG(n),code:"too_small",minimum:t.minimum,inclusive:!0,input:n,inst:e,continue:!t.abort})}}),nr=e4("$ZodCheckSizeEquals",(e,t)=>{var r;r3.init(e,t),(r=e._zod.def).when??(r.when=e=>{let t=e.value;return!tl(t)&&void 0!==t.size}),e._zod.onattach.push(e=>{let r=e._zod.bag;r.minimum=t.size,r.maximum=t.size,r.size=t.size}),e._zod.check=r=>{let n=r.value,i=n.size;if(i===t.size)return;let s=i>t.size;r.issues.push({origin:tG(n),...s?{code:"too_big",maximum:t.size}:{code:"too_small",minimum:t.size},inclusive:!0,exact:!0,input:r.value,inst:e,continue:!t.abort})}}),nn=e4("$ZodCheckMaxLength",(e,t)=>{var r;r3.init(e,t),(r=e._zod.def).when??(r.when=e=>{let t=e.value;return!tl(t)&&void 0!==t.length}),e._zod.onattach.push(e=>{let r=e._zod.bag.maximum??1/0;t.maximum<r&&(e._zod.bag.maximum=t.maximum)}),e._zod.check=r=>{let n=r.value;if(n.length<=t.maximum)return;let i=tH(n);r.issues.push({origin:i,code:"too_big",maximum:t.maximum,inclusive:!0,input:n,inst:e,continue:!t.abort})}}),ni=e4("$ZodCheckMinLength",(e,t)=>{var r;r3.init(e,t),(r=e._zod.def).when??(r.when=e=>{let t=e.value;return!tl(t)&&void 0!==t.length}),e._zod.onattach.push(e=>{let r=e._zod.bag.minimum??-1/0;t.minimum>r&&(e._zod.bag.minimum=t.minimum)}),e._zod.check=r=>{let n=r.value;if(n.length>=t.minimum)return;let i=tH(n);r.issues.push({origin:i,code:"too_small",minimum:t.minimum,inclusive:!0,input:n,inst:e,continue:!t.abort})}}),ns=e4("$ZodCheckLengthEquals",(e,t)=>{var r;r3.init(e,t),(r=e._zod.def).when??(r.when=e=>{let t=e.value;return!tl(t)&&void 0!==t.length}),e._zod.onattach.push(e=>{let r=e._zod.bag;r.minimum=t.length,r.maximum=t.length,r.length=t.length}),e._zod.check=r=>{let n=r.value,i=n.length;if(i===t.length)return;let s=tH(n),a=i>t.length;r.issues.push({origin:s,...a?{code:"too_big",maximum:t.length}:{code:"too_small",minimum:t.length},inclusive:!0,exact:!0,input:r.value,inst:e,continue:!t.abort})}}),na=e4("$ZodCheckStringFormat",(e,t)=>{var r,n;r3.init(e,t),e._zod.onattach.push(e=>{let r=e._zod.bag;r.format=t.format,t.pattern&&(r.patterns??(r.patterns=new Set),r.patterns.add(t.pattern))}),t.pattern?(r=e._zod).check??(r.check=r=>{t.pattern.lastIndex=0,t.pattern.test(r.value)||r.issues.push({origin:"string",code:"invalid_format",format:t.format,input:r.value,...t.pattern?{pattern:t.pattern.toString()}:{},inst:e,continue:!t.abort})}):(n=e._zod).check??(n.check=()=>{})}),no=e4("$ZodCheckRegex",(e,t)=>{na.init(e,t),e._zod.check=r=>{t.pattern.lastIndex=0,t.pattern.test(r.value)||r.issues.push({origin:"string",code:"invalid_format",format:"regex",input:r.value,pattern:t.pattern.toString(),inst:e,continue:!t.abort})}}),nl=e4("$ZodCheckLowerCase",(e,t)=>{t.pattern??(t.pattern=rK),na.init(e,t)}),nu=e4("$ZodCheckUpperCase",(e,t)=>{t.pattern??(t.pattern=rZ),na.init(e,t)}),nc=e4("$ZodCheckIncludes",(e,t)=>{r3.init(e,t);let r=tA(t.includes),n=new RegExp("number"==typeof t.position?`^.{${t.position}}${r}`:r);t.pattern=n,e._zod.onattach.push(e=>{let t=e._zod.bag;t.patterns??(t.patterns=new Set),t.patterns.add(n)}),e._zod.check=r=>{r.value.includes(t.includes,t.position)||r.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:t.includes,input:r.value,inst:e,continue:!t.abort})}}),nd=e4("$ZodCheckStartsWith",(e,t)=>{r3.init(e,t);let r=RegExp(`^${tA(t.prefix)}.*`);t.pattern??(t.pattern=r),e._zod.onattach.push(e=>{let t=e._zod.bag;t.patterns??(t.patterns=new Set),t.patterns.add(r)}),e._zod.check=r=>{r.value.startsWith(t.prefix)||r.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:t.prefix,input:r.value,inst:e,continue:!t.abort})}}),nh=e4("$ZodCheckEndsWith",(e,t)=>{r3.init(e,t);let r=RegExp(`.*${tA(t.suffix)}$`);t.pattern??(t.pattern=r),e._zod.onattach.push(e=>{let t=e._zod.bag;t.patterns??(t.patterns=new Set),t.patterns.add(r)}),e._zod.check=r=>{r.value.endsWith(t.suffix)||r.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:t.suffix,input:r.value,inst:e,continue:!t.abort})}});(e,t)=>{r3.init(e,t);let r=new Set(t.mime);e._zod.onattach.push(e=>{e._zod.bag.mime=t.mime}),e._zod.check=n=>{r.has(n.value.type)||n.issues.push({code:"invalid_value",values:t.mime,input:n.value.type,inst:e,continue:!t.abort})}};let nf=e4("$ZodCheckOverwrite",(e,t)=>{r3.init(e,t),e._zod.check=e=>{e.value=t.tx(e.value)}});class np{constructor(e=[]){this.content=[],this.indent=0,this&&(this.args=e)}indented(e){this.indent+=1,e(this),this.indent-=1}write(e){if("function"==typeof e){e(this,{execution:"sync"}),e(this,{execution:"async"});return}let t=e.split("\n").filter(e=>e),r=Math.min(...t.map(e=>e.length-e.trimStart().length));for(let e of t.map(e=>e.slice(r)).map(e=>" ".repeat(2*this.indent)+e))this.content.push(e)}compile(){return Function(...this?.args,[...(this?.content??[""]).map(e=>`  ${e}`)].join("\n"))}}let nm={major:4,minor:3,patch:5},ng=e4("$ZodType",(e,t)=>{var r;e??(e={}),e._zod.def=t,e._zod.bag=e._zod.bag||{},e._zod.version=nm;let n=[...e._zod.def.checks??[]];for(let t of(e._zod.traits.has("$ZodCheck")&&n.unshift(e),n))for(let r of t._zod.onattach)r(e);if(0===n.length)(r=e._zod).deferred??(r.deferred=[]),e._zod.deferred?.push(()=>{e._zod.run=e._zod.parse});else{let t=(e,t,r)=>{let n,i=tq(e);for(let s of t){if(s._zod.def.when){if(!s._zod.def.when(e))continue}else if(i)continue;let t=e.issues.length,a=s._zod.check(e);if(a instanceof Promise&&r?.async===!1)throw new e5;if(n||a instanceof Promise)n=(n??Promise.resolve()).then(async()=>{await a,e.issues.length!==t&&(i||(i=tq(e,t)))});else{if(e.issues.length===t)continue;i||(i=tq(e,t))}}return n?n.then(()=>e):e},r=(r,i,s)=>{if(tq(r))return r.aborted=!0,r;let a=t(i,n,s);if(a instanceof Promise){if(!1===s.async)throw new e5;return a.then(t=>e._zod.parse(t,s))}return e._zod.parse(a,s)};e._zod.run=(i,s)=>{if(s.skipChecks)return e._zod.parse(i,s);if("backward"===s.direction){let t=e._zod.parse({value:i.value,issues:[]},{...s,skipChecks:!0});return t instanceof Promise?t.then(e=>r(e,i,s)):r(t,i,s)}let a=e._zod.parse(i,s);if(a instanceof Promise){if(!1===s.async)throw new e5;return a.then(e=>t(e,n,s))}return t(a,n,s)}}th(e,"~standard",()=>({validate:t=>{try{let r=rs(e,t);return r.success?{value:r.data}:{issues:r.error?.issues}}catch(r){return ro(e,t).then(e=>e.success?{value:e.data}:{issues:e.error?.issues})}},vendor:"zod",version:1}))}),ny=e4("$ZodString",(e,t)=>{ng.init(e,t),e._zod.pattern=[...e?._zod.bag?.patterns??[]].pop()??rF(e._zod.bag),e._zod.parse=(r,n)=>{if(t.coerce)try{r.value=String(r.value)}catch(e){}return"string"==typeof r.value||r.issues.push({expected:"string",code:"invalid_type",input:r.value,inst:e}),r}}),nv=e4("$ZodStringFormat",(e,t)=>{na.init(e,t),ny.init(e,t)}),nb=e4("$ZodGUID",(e,t)=>{t.pattern??(t.pattern=rm),nv.init(e,t)}),nx=e4("$ZodUUID",(e,t)=>{if(t.version){let e={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[t.version];if(void 0===e)throw Error(`Invalid UUID version: "${t.version}"`);t.pattern??(t.pattern=rg(e))}else t.pattern??(t.pattern=rg());nv.init(e,t)}),nw=e4("$ZodEmail",(e,t)=>{t.pattern??(t.pattern=rx),nv.init(e,t)}),n_=e4("$ZodURL",(e,t)=>{nv.init(e,t),e._zod.check=r=>{try{let n=r.value.trim(),i=new URL(n);t.hostname&&(t.hostname.lastIndex=0,t.hostname.test(i.hostname)||r.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:t.hostname.source,input:r.value,inst:e,continue:!t.abort})),t.protocol&&(t.protocol.lastIndex=0,t.protocol.test(i.protocol.endsWith(":")?i.protocol.slice(0,-1):i.protocol)||r.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:t.protocol.source,input:r.value,inst:e,continue:!t.abort})),t.normalize?r.value=i.href:r.value=n;return}catch(n){r.issues.push({code:"invalid_format",format:"url",input:r.value,inst:e,continue:!t.abort})}}}),nk=e4("$ZodEmoji",(e,t)=>{t.pattern??(t.pattern=r_()),nv.init(e,t)}),nj=e4("$ZodNanoID",(e,t)=>{t.pattern??(t.pattern=rf),nv.init(e,t)}),nE=e4("$ZodCUID",(e,t)=>{t.pattern??(t.pattern=rl),nv.init(e,t)}),nS=e4("$ZodCUID2",(e,t)=>{t.pattern??(t.pattern=ru),nv.init(e,t)}),nO=e4("$ZodULID",(e,t)=>{t.pattern??(t.pattern=rc),nv.init(e,t)}),nT=e4("$ZodXID",(e,t)=>{t.pattern??(t.pattern=rd),nv.init(e,t)}),nN=e4("$ZodKSUID",(e,t)=>{t.pattern??(t.pattern=rh),nv.init(e,t)}),nA=e4("$ZodISODateTime",(e,t)=>{t.pattern??(t.pattern=r$(t)),nv.init(e,t)}),nP=e4("$ZodISODate",(e,t)=>{t.pattern??(t.pattern=rC),nv.init(e,t)}),nC=e4("$ZodISOTime",(e,t)=>{t.pattern??(t.pattern=rR(t)),nv.init(e,t)}),nz=e4("$ZodISODuration",(e,t)=>{t.pattern??(t.pattern=rp),nv.init(e,t)}),nR=e4("$ZodIPv4",(e,t)=>{t.pattern??(t.pattern=rk),nv.init(e,t),e._zod.bag.format="ipv4"}),n$=e4("$ZodIPv6",(e,t)=>{t.pattern??(t.pattern=rj),nv.init(e,t),e._zod.bag.format="ipv6",e._zod.check=r=>{try{new URL(`http://[${r.value}]`)}catch{r.issues.push({code:"invalid_format",format:"ipv6",input:r.value,inst:e,continue:!t.abort})}}}),nF=e4("$ZodMAC",(e,t)=>{t.pattern??(t.pattern=rE(t.delimiter)),nv.init(e,t),e._zod.bag.format="mac"}),nI=e4("$ZodCIDRv4",(e,t)=>{t.pattern??(t.pattern=rS),nv.init(e,t)}),nD=e4("$ZodCIDRv6",(e,t)=>{t.pattern??(t.pattern=rO),nv.init(e,t),e._zod.check=r=>{let n=r.value.split("/");try{if(2!==n.length)throw Error();let[e,t]=n;if(!t)throw Error();let r=Number(t);if(`${r}`!==t||r<0||r>128)throw Error();new URL(`http://[${e}]`)}catch{r.issues.push({code:"invalid_format",format:"cidrv6",input:r.value,inst:e,continue:!t.abort})}}});function nM(e){if(""===e)return!0;if(e.length%4!=0)return!1;try{return atob(e),!0}catch{return!1}}let nU=e4("$ZodBase64",(e,t)=>{t.pattern??(t.pattern=rT),nv.init(e,t),e._zod.bag.contentEncoding="base64",e._zod.check=r=>{nM(r.value)||r.issues.push({code:"invalid_format",format:"base64",input:r.value,inst:e,continue:!t.abort})}});function nL(e){if(!rN.test(e))return!1;let t=e.replace(/[-_]/g,e=>"-"===e?"+":"/");return nM(t.padEnd(4*Math.ceil(t.length/4),"="))}let nB=e4("$ZodBase64URL",(e,t)=>{t.pattern??(t.pattern=rN),nv.init(e,t),e._zod.bag.contentEncoding="base64url",e._zod.check=r=>{nL(r.value)||r.issues.push({code:"invalid_format",format:"base64url",input:r.value,inst:e,continue:!t.abort})}}),nK=e4("$ZodE164",(e,t)=>{t.pattern??(t.pattern=rA),nv.init(e,t)});function nZ(e,t=null){try{let r=e.split(".");if(3!==r.length)return!1;let[n]=r;if(!n)return!1;let i=JSON.parse(atob(n));if("typ"in i&&i?.typ!=="JWT"||!i.alg||t&&(!("alg"in i)||i.alg!==t))return!1;return!0}catch{return!1}}let nq=e4("$ZodJWT",(e,t)=>{nv.init(e,t),e._zod.check=r=>{nZ(r.value,t.alg)||r.issues.push({code:"invalid_format",format:"jwt",input:r.value,inst:e,continue:!t.abort})}}),nV=e4("$ZodCustomStringFormat",(e,t)=>{nv.init(e,t),e._zod.check=r=>{t.fn(r.value)||r.issues.push({code:"invalid_format",format:t.format,input:r.value,inst:e,continue:!t.abort})}}),nJ=e4("$ZodNumber",(e,t)=>{ng.init(e,t),e._zod.pattern=e._zod.bag.pattern??rM,e._zod.parse=(r,n)=>{if(t.coerce)try{r.value=Number(r.value)}catch(e){}let i=r.value;if("number"==typeof i&&!Number.isNaN(i)&&Number.isFinite(i))return r;let s="number"==typeof i?Number.isNaN(i)?"NaN":Number.isFinite(i)?void 0:"Infinity":void 0;return r.issues.push({expected:"number",code:"invalid_type",input:i,inst:e,...s?{received:s}:{}}),r}}),nW=e4("$ZodNumberFormat",(e,t)=>{r7.init(e,t),nJ.init(e,t)}),nG=e4("$ZodBoolean",(e,t)=>{ng.init(e,t),e._zod.pattern=rU,e._zod.parse=(r,n)=>{if(t.coerce)try{r.value=!!r.value}catch(e){}let i=r.value;return"boolean"==typeof i||r.issues.push({expected:"boolean",code:"invalid_type",input:i,inst:e}),r}}),nH=e4("$ZodBigInt",(e,t)=>{ng.init(e,t),e._zod.pattern=rI,e._zod.parse=(r,n)=>{if(t.coerce)try{r.value=BigInt(r.value)}catch(e){}return"bigint"==typeof r.value||r.issues.push({expected:"bigint",code:"invalid_type",input:r.value,inst:e}),r}}),nQ=e4("$ZodBigIntFormat",(e,t)=>{r9.init(e,t),nH.init(e,t)}),nY=e4("$ZodSymbol",(e,t)=>{ng.init(e,t),e._zod.parse=(t,r)=>{let n=t.value;return"symbol"==typeof n||t.issues.push({expected:"symbol",code:"invalid_type",input:n,inst:e}),t}}),nX=e4("$ZodUndefined",(e,t)=>{ng.init(e,t),e._zod.pattern=rB,e._zod.values=new Set([void 0]),e._zod.optin="optional",e._zod.optout="optional",e._zod.parse=(t,r)=>{let n=t.value;return void 0===n||t.issues.push({expected:"undefined",code:"invalid_type",input:n,inst:e}),t}}),n0=e4("$ZodNull",(e,t)=>{ng.init(e,t),e._zod.pattern=rL,e._zod.values=new Set([null]),e._zod.parse=(t,r)=>{let n=t.value;return null===n||t.issues.push({expected:"null",code:"invalid_type",input:n,inst:e}),t}}),n1=e4("$ZodAny",(e,t)=>{ng.init(e,t),e._zod.parse=e=>e}),n2=e4("$ZodUnknown",(e,t)=>{ng.init(e,t),e._zod.parse=e=>e}),n3=e4("$ZodNever",(e,t)=>{ng.init(e,t),e._zod.parse=(t,r)=>(t.issues.push({expected:"never",code:"invalid_type",input:t.value,inst:e}),t)}),n4=e4("$ZodVoid",(e,t)=>{ng.init(e,t),e._zod.parse=(t,r)=>{let n=t.value;return void 0===n||t.issues.push({expected:"void",code:"invalid_type",input:n,inst:e}),t}}),n5=e4("$ZodDate",(e,t)=>{ng.init(e,t),e._zod.parse=(r,n)=>{if(t.coerce)try{r.value=new Date(r.value)}catch(e){}let i=r.value,s=i instanceof Date;return s&&!Number.isNaN(i.getTime())||r.issues.push({expected:"date",code:"invalid_type",input:i,...s?{received:"Invalid Date"}:{},inst:e}),r}});function n6(e,t,r){e.issues.length&&t.issues.push(...tV(r,e.issues)),t.value[r]=e.value}let n8=e4("$ZodArray",(e,t)=>{ng.init(e,t),e._zod.parse=(r,n)=>{let i=r.value;if(!Array.isArray(i))return r.issues.push({expected:"array",code:"invalid_type",input:i,inst:e}),r;r.value=Array(i.length);let s=[];for(let e=0;e<i.length;e++){let a=i[e],o=t.element._zod.run({value:a,issues:[]},n);o instanceof Promise?s.push(o.then(t=>n6(t,r,e))):n6(o,r,e)}return s.length?Promise.all(s).then(()=>r):r}});function n7(e,t,r,n,i){if(e.issues.length){if(i&&!(r in n))return;t.issues.push(...tV(r,e.issues))}void 0===e.value?r in n&&(t.value[r]=void 0):t.value[r]=e.value}function n9(e){let t=Object.keys(e.shape);for(let r of t)if(!e.shape?.[r]?._zod?.traits?.has("$ZodType"))throw Error(`Invalid element at key "${r}": expected a Zod schema`);let r=t$(e.shape);return{...e,keys:t,keySet:new Set(t),numKeys:t.length,optionalKeys:new Set(r)}}function ie(e,t,r,n,i,s){let a=[],o=i.keySet,l=i.catchall._zod,u=l.def.type,c="optional"===l.optout;for(let i in t){if(o.has(i))continue;if("never"===u){a.push(i);continue}let s=l.run({value:t[i],issues:[]},n);s instanceof Promise?e.push(s.then(e=>n7(e,r,i,t,c))):n7(s,r,i,t,c)}return(a.length&&r.issues.push({code:"unrecognized_keys",keys:a,input:t,inst:s}),e.length)?Promise.all(e).then(()=>r):r}let it=e4("$ZodObject",(e,t)=>{let r;ng.init(e,t);let n=Object.getOwnPropertyDescriptor(t,"shape");if(!n?.get){let e=t.shape;Object.defineProperty(t,"shape",{get:()=>{let r={...e};return Object.defineProperty(t,"shape",{value:r}),r}})}let i=to(()=>n9(t));th(e._zod,"propValues",()=>{let e=t.shape,r={};for(let t in e){let n=e[t]._zod;if(n.values)for(let e of(r[t]??(r[t]=new Set),n.values))r[t].add(e)}return r});let s=t.catchall;e._zod.parse=(t,n)=>{r??(r=i.value);let a=t.value;if(!tk(a))return t.issues.push({expected:"object",code:"invalid_type",input:a,inst:e}),t;t.value={};let o=[],l=r.shape;for(let e of r.keys){let r=l[e],i="optional"===r._zod.optout,s=r._zod.run({value:a[e],issues:[]},n);s instanceof Promise?o.push(s.then(r=>n7(r,t,e,a,i))):n7(s,t,e,a,i)}return s?ie(o,a,t,n,i.value,e):o.length?Promise.all(o).then(()=>t):t}}),ir=e4("$ZodObjectJIT",(e,t)=>{let r,n;it.init(e,t);let i=e._zod.parse,s=to(()=>n9(t)),a=!e8.jitless,o=a&&tj.value,l=t.catchall;e._zod.parse=(u,c)=>{n??(n=s.value);let d=u.value;return tk(d)?a&&o&&c?.async===!1&&!0!==c.jitless?(r||(r=(e=>{let t=new np(["shape","payload","ctx"]),r=s.value,n=e=>{let t=tx(e);return`shape[${t}]._zod.run({ value: input[${t}], issues: [] }, ctx)`};t.write("const input = payload.value;");let i=Object.create(null),a=0;for(let e of r.keys)i[e]=`key_${a++}`;for(let s of(t.write("const newResult = {};"),r.keys)){let r=i[s],a=tx(s),o=e[s],l=o?._zod?.optout==="optional";t.write(`const ${r} = ${n(s)};`),l?t.write(`
        if (${r}.issues.length) {
          if (${a} in input) {
            payload.issues = payload.issues.concat(${r}.issues.map(iss => ({
              ...iss,
              path: iss.path ? [${a}, ...iss.path] : [${a}]
            })));
          }
        }
        
        if (${r}.value === undefined) {
          if (${a} in input) {
            newResult[${a}] = undefined;
          }
        } else {
          newResult[${a}] = ${r}.value;
        }
        
      `):t.write(`
        if (${r}.issues.length) {
          payload.issues = payload.issues.concat(${r}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${a}, ...iss.path] : [${a}]
          })));
        }
        
        if (${r}.value === undefined) {
          if (${a} in input) {
            newResult[${a}] = undefined;
          }
        } else {
          newResult[${a}] = ${r}.value;
        }
        
      `)}t.write("payload.value = newResult;"),t.write("return payload;");let o=t.compile();return(t,r)=>o(e,t,r)})(t.shape)),u=r(u,c),l)?ie([],d,u,c,n,e):u:i(u,c):(u.issues.push({expected:"object",code:"invalid_type",input:d,inst:e}),u)}});function ii(e,t,r,n){for(let r of e)if(0===r.issues.length)return t.value=r.value,t;let i=e.filter(e=>!tq(e));return 1===i.length?(t.value=i[0].value,i[0]):(t.issues.push({code:"invalid_union",input:t.value,inst:r,errors:e.map(e=>e.issues.map(e=>tW(e,n,e7())))}),t)}let is=e4("$ZodUnion",(e,t)=>{ng.init(e,t),th(e._zod,"optin",()=>t.options.some(e=>"optional"===e._zod.optin)?"optional":void 0),th(e._zod,"optout",()=>t.options.some(e=>"optional"===e._zod.optout)?"optional":void 0),th(e._zod,"values",()=>{if(t.options.every(e=>e._zod.values))return new Set(t.options.flatMap(e=>Array.from(e._zod.values)))}),th(e._zod,"pattern",()=>{if(t.options.every(e=>e._zod.pattern)){let e=t.options.map(e=>e._zod.pattern);return RegExp(`^(${e.map(e=>tu(e.source)).join("|")})$`)}});let r=1===t.options.length,n=t.options[0]._zod.run;e._zod.parse=(i,s)=>{if(r)return n(i,s);let a=!1,o=[];for(let e of t.options){let t=e._zod.run({value:i.value,issues:[]},s);if(t instanceof Promise)o.push(t),a=!0;else{if(0===t.issues.length)return t;o.push(t)}}return a?Promise.all(o).then(t=>ii(t,i,e,s)):ii(o,i,e,s)}});function ia(e,t,r,n){let i=e.filter(e=>0===e.issues.length);return 1===i.length?t.value=i[0].value:0===i.length?t.issues.push({code:"invalid_union",input:t.value,inst:r,errors:e.map(e=>e.issues.map(e=>tW(e,n,e7())))}):t.issues.push({code:"invalid_union",input:t.value,inst:r,errors:[],inclusive:!1}),t}let io=e4("$ZodXor",(e,t)=>{is.init(e,t),t.inclusive=!1;let r=1===t.options.length,n=t.options[0]._zod.run;e._zod.parse=(i,s)=>{if(r)return n(i,s);let a=!1,o=[];for(let e of t.options){let t=e._zod.run({value:i.value,issues:[]},s);t instanceof Promise?(o.push(t),a=!0):o.push(t)}return a?Promise.all(o).then(t=>ia(t,i,e,s)):ia(o,i,e,s)}}),il=e4("$ZodDiscriminatedUnion",(e,t)=>{t.inclusive=!1,is.init(e,t);let r=e._zod.parse;th(e._zod,"propValues",()=>{let e={};for(let r of t.options){let n=r._zod.propValues;if(!n||0===Object.keys(n).length)throw Error(`Invalid discriminated union option at index "${t.options.indexOf(r)}"`);for(let[t,r]of Object.entries(n))for(let n of(e[t]||(e[t]=new Set),r))e[t].add(n)}return e});let n=to(()=>{let e=t.options,r=new Map;for(let n of e){let e=n._zod.propValues?.[t.discriminator];if(!e||0===e.size)throw Error(`Invalid discriminated union option at index "${t.options.indexOf(n)}"`);for(let t of e){if(r.has(t))throw Error(`Duplicate discriminator value "${String(t)}"`);r.set(t,n)}}return r});e._zod.parse=(i,s)=>{let a=i.value;if(!tk(a))return i.issues.push({code:"invalid_type",expected:"object",input:a,inst:e}),i;let o=n.value.get(a?.[t.discriminator]);return o?o._zod.run(i,s):t.unionFallback?r(i,s):(i.issues.push({code:"invalid_union",errors:[],note:"No matching discriminator",discriminator:t.discriminator,input:a,path:[t.discriminator],inst:e}),i)}}),iu=e4("$ZodIntersection",(e,t)=>{ng.init(e,t),e._zod.parse=(e,r)=>{let n=e.value,i=t.left._zod.run({value:n,issues:[]},r),s=t.right._zod.run({value:n,issues:[]},r);return i instanceof Promise||s instanceof Promise?Promise.all([i,s]).then(([t,r])=>ic(e,t,r)):ic(e,i,s)}});function ic(e,t,r){let n,i=new Map;for(let r of t.issues)if("unrecognized_keys"===r.code)for(let e of(n??(n=r),r.keys))i.has(e)||i.set(e,{}),i.get(e).l=!0;else e.issues.push(r);for(let t of r.issues)if("unrecognized_keys"===t.code)for(let e of t.keys)i.has(e)||i.set(e,{}),i.get(e).r=!0;else e.issues.push(t);let s=[...i].filter(([,e])=>e.l&&e.r).map(([e])=>e);if(s.length&&n&&e.issues.push({...n,keys:s}),tq(e))return e;let a=function e(t,r){if(t===r||t instanceof Date&&r instanceof Date&&+t==+r)return{valid:!0,data:t};if(tE(t)&&tE(r)){let n=Object.keys(r),i=Object.keys(t).filter(e=>-1!==n.indexOf(e)),s={...t,...r};for(let n of i){let i=e(t[n],r[n]);if(!i.valid)return{valid:!1,mergeErrorPath:[n,...i.mergeErrorPath]};s[n]=i.data}return{valid:!0,data:s}}if(Array.isArray(t)&&Array.isArray(r)){if(t.length!==r.length)return{valid:!1,mergeErrorPath:[]};let n=[];for(let i=0;i<t.length;i++){let s=e(t[i],r[i]);if(!s.valid)return{valid:!1,mergeErrorPath:[i,...s.mergeErrorPath]};n.push(s.data)}return{valid:!0,data:n}}return{valid:!1,mergeErrorPath:[]}}(t.value,r.value);if(!a.valid)throw Error(`Unmergable intersection. Error path: ${JSON.stringify(a.mergeErrorPath)}`);return e.value=a.data,e}let id=e4("$ZodTuple",(e,t)=>{ng.init(e,t);let r=t.items;e._zod.parse=(n,i)=>{let s=n.value;if(!Array.isArray(s))return n.issues.push({input:s,inst:e,expected:"tuple",code:"invalid_type"}),n;n.value=[];let a=[],o=[...r].reverse().findIndex(e=>"optional"!==e._zod.optin),l=-1===o?0:r.length-o;if(!t.rest){let t=s.length>r.length,i=s.length<l-1;if(t||i)return n.issues.push({...t?{code:"too_big",maximum:r.length,inclusive:!0}:{code:"too_small",minimum:r.length},input:s,inst:e,origin:"array"}),n}let u=-1;for(let e of r){if(++u>=s.length&&u>=l)continue;let t=e._zod.run({value:s[u],issues:[]},i);t instanceof Promise?a.push(t.then(e=>ih(e,n,u))):ih(t,n,u)}if(t.rest)for(let e of s.slice(r.length)){u++;let r=t.rest._zod.run({value:e,issues:[]},i);r instanceof Promise?a.push(r.then(e=>ih(e,n,u))):ih(r,n,u)}return a.length?Promise.all(a).then(()=>n):n}});function ih(e,t,r){e.issues.length&&t.issues.push(...tV(r,e.issues)),t.value[r]=e.value}let ip=e4("$ZodRecord",(e,t)=>{ng.init(e,t),e._zod.parse=(r,n)=>{let i=r.value;if(!tE(i))return r.issues.push({expected:"record",code:"invalid_type",input:i,inst:e}),r;let s=[],a=t.keyType._zod.values;if(a){let o;r.value={};let l=new Set;for(let e of a)if("string"==typeof e||"number"==typeof e||"symbol"==typeof e){l.add("number"==typeof e?e.toString():e);let a=t.valueType._zod.run({value:i[e],issues:[]},n);a instanceof Promise?s.push(a.then(t=>{t.issues.length&&r.issues.push(...tV(e,t.issues)),r.value[e]=t.value})):(a.issues.length&&r.issues.push(...tV(e,a.issues)),r.value[e]=a.value)}for(let e in i)l.has(e)||(o=o??[]).push(e);o&&o.length>0&&r.issues.push({code:"unrecognized_keys",input:i,inst:e,keys:o})}else for(let a of(r.value={},Reflect.ownKeys(i))){if("__proto__"===a)continue;let o=t.keyType._zod.run({value:a,issues:[]},n);if(o instanceof Promise)throw Error("Async schemas not supported in object keys currently");if("string"==typeof a&&rM.test(a)&&o.issues.length&&o.issues.some(e=>"invalid_type"===e.code&&"number"===e.expected)){let e=t.keyType._zod.run({value:Number(a),issues:[]},n);if(e instanceof Promise)throw Error("Async schemas not supported in object keys currently");0===e.issues.length&&(o=e)}if(o.issues.length){"loose"===t.mode?r.value[a]=i[a]:r.issues.push({code:"invalid_key",origin:"record",issues:o.issues.map(e=>tW(e,n,e7())),input:a,path:[a],inst:e});continue}let l=t.valueType._zod.run({value:i[a],issues:[]},n);l instanceof Promise?s.push(l.then(e=>{e.issues.length&&r.issues.push(...tV(a,e.issues)),r.value[o.value]=e.value})):(l.issues.length&&r.issues.push(...tV(a,l.issues)),r.value[o.value]=l.value)}return s.length?Promise.all(s).then(()=>r):r}}),im=e4("$ZodMap",(e,t)=>{ng.init(e,t),e._zod.parse=(r,n)=>{let i=r.value;if(!(i instanceof Map))return r.issues.push({expected:"map",code:"invalid_type",input:i,inst:e}),r;let s=[];for(let[a,o]of(r.value=new Map,i)){let l=t.keyType._zod.run({value:a,issues:[]},n),u=t.valueType._zod.run({value:o,issues:[]},n);l instanceof Promise||u instanceof Promise?s.push(Promise.all([l,u]).then(([t,s])=>{ig(t,s,r,a,i,e,n)})):ig(l,u,r,a,i,e,n)}return s.length?Promise.all(s).then(()=>r):r}});function ig(e,t,r,n,i,s,a){e.issues.length&&(tT.has(typeof n)?r.issues.push(...tV(n,e.issues)):r.issues.push({code:"invalid_key",origin:"map",input:i,inst:s,issues:e.issues.map(e=>tW(e,a,e7()))})),t.issues.length&&(tT.has(typeof n)?r.issues.push(...tV(n,t.issues)):r.issues.push({origin:"map",code:"invalid_element",input:i,inst:s,key:n,issues:t.issues.map(e=>tW(e,a,e7()))})),r.value.set(e.value,t.value)}let iy=e4("$ZodSet",(e,t)=>{ng.init(e,t),e._zod.parse=(r,n)=>{let i=r.value;if(!(i instanceof Set))return r.issues.push({input:i,inst:e,expected:"set",code:"invalid_type"}),r;let s=[];for(let e of(r.value=new Set,i)){let i=t.valueType._zod.run({value:e,issues:[]},n);i instanceof Promise?s.push(i.then(e=>iv(e,r))):iv(i,r)}return s.length?Promise.all(s).then(()=>r):r}});function iv(e,t){e.issues.length&&t.issues.push(...e.issues),t.value.add(e.value)}let ib=e4("$ZodEnum",(e,t)=>{ng.init(e,t);let r=ti(t.entries),n=new Set(r);e._zod.values=n,e._zod.pattern=RegExp(`^(${r.filter(e=>tT.has(typeof e)).map(e=>"string"==typeof e?tA(e):e.toString()).join("|")})$`),e._zod.parse=(t,i)=>{let s=t.value;return n.has(s)||t.issues.push({code:"invalid_value",values:r,input:s,inst:e}),t}}),ix=e4("$ZodLiteral",(e,t)=>{if(ng.init(e,t),0===t.values.length)throw Error("Cannot create literal schema with no valid values");let r=new Set(t.values);e._zod.values=r,e._zod.pattern=RegExp(`^(${t.values.map(e=>"string"==typeof e?tA(e):e?tA(e.toString()):String(e)).join("|")})$`),e._zod.parse=(n,i)=>{let s=n.value;return r.has(s)||n.issues.push({code:"invalid_value",values:t.values,input:s,inst:e}),n}}),iw=e4("$ZodFile",(e,t)=>{ng.init(e,t),e._zod.parse=(t,r)=>{let n=t.value;return n instanceof File||t.issues.push({expected:"file",code:"invalid_type",input:n,inst:e}),t}}),i_=e4("$ZodTransform",(e,t)=>{ng.init(e,t),e._zod.parse=(r,n)=>{if("backward"===n.direction)throw new e6(e.constructor.name);let i=t.transform(r.value,r);if(n.async)return(i instanceof Promise?i:Promise.resolve(i)).then(e=>(r.value=e,r));if(i instanceof Promise)throw new e5;return r.value=i,r}});function ik(e,t){return e.issues.length&&void 0===t?{issues:[],value:void 0}:e}let ij=e4("$ZodOptional",(e,t)=>{ng.init(e,t),e._zod.optin="optional",e._zod.optout="optional",th(e._zod,"values",()=>t.innerType._zod.values?new Set([...t.innerType._zod.values,void 0]):void 0),th(e._zod,"pattern",()=>{let e=t.innerType._zod.pattern;return e?RegExp(`^(${tu(e.source)})?$`):void 0}),e._zod.parse=(e,r)=>{if("optional"===t.innerType._zod.optin){let n=t.innerType._zod.run(e,r);return n instanceof Promise?n.then(t=>ik(t,e.value)):ik(n,e.value)}return void 0===e.value?e:t.innerType._zod.run(e,r)}}),iE=e4("$ZodExactOptional",(e,t)=>{ij.init(e,t),th(e._zod,"values",()=>t.innerType._zod.values),th(e._zod,"pattern",()=>t.innerType._zod.pattern),e._zod.parse=(e,r)=>t.innerType._zod.run(e,r)}),iS=e4("$ZodNullable",(e,t)=>{ng.init(e,t),th(e._zod,"optin",()=>t.innerType._zod.optin),th(e._zod,"optout",()=>t.innerType._zod.optout),th(e._zod,"pattern",()=>{let e=t.innerType._zod.pattern;return e?RegExp(`^(${tu(e.source)}|null)$`):void 0}),th(e._zod,"values",()=>t.innerType._zod.values?new Set([...t.innerType._zod.values,null]):void 0),e._zod.parse=(e,r)=>null===e.value?e:t.innerType._zod.run(e,r)}),iO=e4("$ZodDefault",(e,t)=>{ng.init(e,t),e._zod.optin="optional",th(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(e,r)=>{if("backward"===r.direction)return t.innerType._zod.run(e,r);if(void 0===e.value)return e.value=t.defaultValue,e;let n=t.innerType._zod.run(e,r);return n instanceof Promise?n.then(e=>iT(e,t)):iT(n,t)}});function iT(e,t){return void 0===e.value&&(e.value=t.defaultValue),e}let iN=e4("$ZodPrefault",(e,t)=>{ng.init(e,t),e._zod.optin="optional",th(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(e,r)=>("backward"===r.direction||void 0===e.value&&(e.value=t.defaultValue),t.innerType._zod.run(e,r))}),iA=e4("$ZodNonOptional",(e,t)=>{ng.init(e,t),th(e._zod,"values",()=>{let e=t.innerType._zod.values;return e?new Set([...e].filter(e=>void 0!==e)):void 0}),e._zod.parse=(r,n)=>{let i=t.innerType._zod.run(r,n);return i instanceof Promise?i.then(t=>iP(t,e)):iP(i,e)}});function iP(e,t){return e.issues.length||void 0!==e.value||e.issues.push({code:"invalid_type",expected:"nonoptional",input:e.value,inst:t}),e}let iC=e4("$ZodSuccess",(e,t)=>{ng.init(e,t),e._zod.parse=(e,r)=>{if("backward"===r.direction)throw new e6("ZodSuccess");let n=t.innerType._zod.run(e,r);return n instanceof Promise?n.then(t=>(e.value=0===t.issues.length,e)):(e.value=0===n.issues.length,e)}}),iz=e4("$ZodCatch",(e,t)=>{ng.init(e,t),th(e._zod,"optin",()=>t.innerType._zod.optin),th(e._zod,"optout",()=>t.innerType._zod.optout),th(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(e,r)=>{if("backward"===r.direction)return t.innerType._zod.run(e,r);let n=t.innerType._zod.run(e,r);return n instanceof Promise?n.then(n=>(e.value=n.value,n.issues.length&&(e.value=t.catchValue({...e,error:{issues:n.issues.map(e=>tW(e,r,e7()))},input:e.value}),e.issues=[]),e)):(e.value=n.value,n.issues.length&&(e.value=t.catchValue({...e,error:{issues:n.issues.map(e=>tW(e,r,e7()))},input:e.value}),e.issues=[]),e)}}),iR=e4("$ZodNaN",(e,t)=>{ng.init(e,t),e._zod.parse=(t,r)=>("number"==typeof t.value&&Number.isNaN(t.value)||t.issues.push({input:t.value,inst:e,expected:"nan",code:"invalid_type"}),t)}),i$=e4("$ZodPipe",(e,t)=>{ng.init(e,t),th(e._zod,"values",()=>t.in._zod.values),th(e._zod,"optin",()=>t.in._zod.optin),th(e._zod,"optout",()=>t.out._zod.optout),th(e._zod,"propValues",()=>t.in._zod.propValues),e._zod.parse=(e,r)=>{if("backward"===r.direction){let n=t.out._zod.run(e,r);return n instanceof Promise?n.then(e=>iF(e,t.in,r)):iF(n,t.in,r)}let n=t.in._zod.run(e,r);return n instanceof Promise?n.then(e=>iF(e,t.out,r)):iF(n,t.out,r)}});function iF(e,t,r){return e.issues.length?(e.aborted=!0,e):t._zod.run({value:e.value,issues:e.issues},r)}let iI=e4("$ZodCodec",(e,t)=>{ng.init(e,t),th(e._zod,"values",()=>t.in._zod.values),th(e._zod,"optin",()=>t.in._zod.optin),th(e._zod,"optout",()=>t.out._zod.optout),th(e._zod,"propValues",()=>t.in._zod.propValues),e._zod.parse=(e,r)=>{if("forward"===(r.direction||"forward")){let n=t.in._zod.run(e,r);return n instanceof Promise?n.then(e=>iD(e,t,r)):iD(n,t,r)}{let n=t.out._zod.run(e,r);return n instanceof Promise?n.then(e=>iD(e,t,r)):iD(n,t,r)}}});function iD(e,t,r){if(e.issues.length)return e.aborted=!0,e;if("forward"===(r.direction||"forward")){let n=t.transform(e.value,e);return n instanceof Promise?n.then(n=>iM(e,n,t.out,r)):iM(e,n,t.out,r)}{let n=t.reverseTransform(e.value,e);return n instanceof Promise?n.then(n=>iM(e,n,t.in,r)):iM(e,n,t.in,r)}}function iM(e,t,r,n){return e.issues.length?(e.aborted=!0,e):r._zod.run({value:t,issues:e.issues},n)}let iU=e4("$ZodReadonly",(e,t)=>{ng.init(e,t),th(e._zod,"propValues",()=>t.innerType._zod.propValues),th(e._zod,"values",()=>t.innerType._zod.values),th(e._zod,"optin",()=>t.innerType?._zod?.optin),th(e._zod,"optout",()=>t.innerType?._zod?.optout),e._zod.parse=(e,r)=>{if("backward"===r.direction)return t.innerType._zod.run(e,r);let n=t.innerType._zod.run(e,r);return n instanceof Promise?n.then(iL):iL(n)}});function iL(e){return e.value=Object.freeze(e.value),e}let iB=e4("$ZodTemplateLiteral",(e,t)=>{ng.init(e,t);let r=[];for(let e of t.parts)if("object"==typeof e&&null!==e){if(!e._zod.pattern)throw Error(`Invalid template literal part, no pattern found: ${[...e._zod.traits].shift()}`);let t=e._zod.pattern instanceof RegExp?e._zod.pattern.source:e._zod.pattern;if(!t)throw Error(`Invalid template literal part: ${e._zod.traits}`);let n=+!!t.startsWith("^"),i=t.endsWith("$")?t.length-1:t.length;r.push(t.slice(n,i))}else if(null===e||tN.has(typeof e))r.push(tA(`${e}`));else throw Error(`Invalid template literal part: ${e}`);e._zod.pattern=RegExp(`^${r.join("")}$`),e._zod.parse=(r,n)=>("string"!=typeof r.value?r.issues.push({input:r.value,inst:e,expected:"string",code:"invalid_type"}):(e._zod.pattern.lastIndex=0,e._zod.pattern.test(r.value)||r.issues.push({input:r.value,inst:e,code:"invalid_format",format:t.format??"template_literal",pattern:e._zod.pattern.source})),r)}),iK=e4("$ZodFunction",(e,t)=>(ng.init(e,t),e._def=t,e._zod.def=t,e.implement=t=>{if("function"!=typeof t)throw Error("implement() must be called with a function");return function(...r){let n=Reflect.apply(t,this,e._def.input?rt(e._def.input,r):r);return e._def.output?rt(e._def.output,n):n}},e.implementAsync=t=>{if("function"!=typeof t)throw Error("implementAsync() must be called with a function");return async function(...r){let n=e._def.input?await rn(e._def.input,r):r,i=await Reflect.apply(t,this,n);return e._def.output?await rn(e._def.output,i):i}},e._zod.parse=(t,r)=>("function"!=typeof t.value?t.issues.push({code:"invalid_type",expected:"function",input:t.value,inst:e}):e._def.output&&"promise"===e._def.output._zod.def.type?t.value=e.implementAsync(t.value):t.value=e.implement(t.value),t),e.input=(...t)=>{let r=e.constructor;return new r(Array.isArray(t[0])?{type:"function",input:new id({type:"tuple",items:t[0],rest:t[1]}),output:e._def.output}:{type:"function",input:t[0],output:e._def.output})},e.output=t=>new e.constructor({type:"function",input:e._def.input,output:t}),e)),iZ=e4("$ZodPromise",(e,t)=>{ng.init(e,t),e._zod.parse=(e,r)=>Promise.resolve(e.value).then(e=>t.innerType._zod.run({value:e,issues:[]},r))}),iq=e4("$ZodLazy",(e,t)=>{ng.init(e,t),th(e._zod,"innerType",()=>t.getter()),th(e._zod,"pattern",()=>e._zod.innerType?._zod?.pattern),th(e._zod,"propValues",()=>e._zod.innerType?._zod?.propValues),th(e._zod,"optin",()=>e._zod.innerType?._zod?.optin??void 0),th(e._zod,"optout",()=>e._zod.innerType?._zod?.optout??void 0),e._zod.parse=(t,r)=>e._zod.innerType._zod.run(t,r)}),iV=e4("$ZodCustom",(e,t)=>{r3.init(e,t),ng.init(e,t),e._zod.parse=(e,t)=>e,e._zod.check=r=>{let n=r.value,i=t.fn(n);if(i instanceof Promise)return i.then(t=>iJ(t,r,n,e));iJ(i,r,n,e)}});function iJ(e,t,r,n){if(!e){let e={code:"custom",input:r,inst:n,path:[...n._zod.def.path??[]],continue:!n._zod.def.abort};n._zod.def.params&&(e.params=n._zod.def.params),t.issues.push(tY(e))}}e.s(["$ZodAny",0,n1,"$ZodArray",0,n8,"$ZodBase64",0,nU,"$ZodBase64URL",0,nB,"$ZodBigInt",0,nH,"$ZodBigIntFormat",0,nQ,"$ZodBoolean",0,nG,"$ZodCIDRv4",0,nI,"$ZodCIDRv6",0,nD,"$ZodCUID",0,nE,"$ZodCUID2",0,nS,"$ZodCatch",0,iz,"$ZodCodec",0,iI,"$ZodCustom",0,iV,"$ZodCustomStringFormat",0,nV,"$ZodDate",0,n5,"$ZodDefault",0,iO,"$ZodDiscriminatedUnion",0,il,"$ZodE164",0,nK,"$ZodEmail",0,nw,"$ZodEmoji",0,nk,"$ZodEnum",0,ib,"$ZodExactOptional",0,iE,"$ZodFile",0,iw,"$ZodFunction",0,iK,"$ZodGUID",0,nb,"$ZodIPv4",0,nR,"$ZodIPv6",0,n$,"$ZodISODate",0,nP,"$ZodISODateTime",0,nA,"$ZodISODuration",0,nz,"$ZodISOTime",0,nC,"$ZodIntersection",0,iu,"$ZodJWT",0,nq,"$ZodKSUID",0,nN,"$ZodLazy",0,iq,"$ZodLiteral",0,ix,"$ZodMAC",0,nF,"$ZodMap",0,im,"$ZodNaN",0,iR,"$ZodNanoID",0,nj,"$ZodNever",0,n3,"$ZodNonOptional",0,iA,"$ZodNull",0,n0,"$ZodNullable",0,iS,"$ZodNumber",0,nJ,"$ZodNumberFormat",0,nW,"$ZodObject",0,it,"$ZodObjectJIT",0,ir,"$ZodOptional",0,ij,"$ZodPipe",0,i$,"$ZodPrefault",0,iN,"$ZodPromise",0,iZ,"$ZodReadonly",0,iU,"$ZodRecord",0,ip,"$ZodSet",0,iy,"$ZodString",0,ny,"$ZodStringFormat",0,nv,"$ZodSuccess",0,iC,"$ZodSymbol",0,nY,"$ZodTemplateLiteral",0,iB,"$ZodTransform",0,i_,"$ZodTuple",0,id,"$ZodType",0,ng,"$ZodULID",0,nO,"$ZodURL",0,n_,"$ZodUUID",0,nx,"$ZodUndefined",0,nX,"$ZodUnion",0,is,"$ZodUnknown",0,n2,"$ZodVoid",0,n4,"$ZodXID",0,nT,"$ZodXor",0,io,"isValidBase64",()=>nM,"isValidBase64URL",()=>nL,"isValidJWT",()=>nZ],76094),Symbol("ZodOutput"),Symbol("ZodInput");(E=globalThis).__zod_globalRegistry??(E.__zod_globalRegistry=new class e{constructor(){this._map=new WeakMap,this._idmap=new Map}add(e,...t){let r=t[0];return this._map.set(e,r),r&&"object"==typeof r&&"id"in r&&this._idmap.set(r.id,e),this}clear(){return this._map=new WeakMap,this._idmap=new Map,this}remove(e){let t=this._map.get(e);return t&&"object"==typeof t&&"id"in t&&this._idmap.delete(t.id),this._map.delete(e),this}get(e){let t=e._zod.parent;if(t){let r={...this.get(t)??{}};delete r.id;let n={...r,...this._map.get(e)};return Object.keys(n).length?n:void 0}return this._map.get(e)}has(e){return this._map.has(e)}});let iW=globalThis.__zod_globalRegistry;function iG(e,t){return new r5({check:"less_than",...tC(t),value:e,inclusive:!1})}function iH(e,t){return new r5({check:"less_than",...tC(t),value:e,inclusive:!0})}function iQ(e,t){return new r6({check:"greater_than",...tC(t),value:e,inclusive:!1})}function iY(e,t){return new r6({check:"greater_than",...tC(t),value:e,inclusive:!0})}function iX(e,t){return new r8({check:"multiple_of",...tC(t),value:e})}function i0(e,t){return new nn({check:"max_length",...tC(t),maximum:e})}function i1(e,t){return new ni({check:"min_length",...tC(t),minimum:e})}function i2(e,t){return new ns({check:"length_equals",...tC(t),length:e})}function i3(e){return new nf({check:"overwrite",tx:e})}function i4(e){let t=e?.target??"draft-2020-12";return"draft-4"===t&&(t="draft-04"),"draft-7"===t&&(t="draft-07"),{processors:e.processors??{},metadataRegistry:e?.metadata??iW,target:t,unrepresentable:e?.unrepresentable??"throw",override:e?.override??(()=>{}),io:e?.io??"output",counter:0,seen:new Map,cycles:e?.cycles??"ref",reused:e?.reused??"inline",external:e?.external??void 0}}function i5(e,t,r={path:[],schemaPath:[]}){var n;let i=e._zod.def,s=t.seen.get(e);if(s)return s.count++,r.schemaPath.includes(e)&&(s.cycle=r.path),s.schema;let a={schema:{},count:1,cycle:void 0,path:r.path};t.seen.set(e,a);let o=e._zod.toJSONSchema?.();if(o)a.schema=o;else{let n={...r,schemaPath:[...r.schemaPath,e],path:r.path};if(e._zod.processJSONSchema)e._zod.processJSONSchema(t,a.schema,n);else{let r=a.schema,s=t.processors[i.type];if(!s)throw Error(`[toJSONSchema]: Non-representable type encountered: ${i.type}`);s(e,t,r,n)}let s=e._zod.parent;s&&(a.ref||(a.ref=s),i5(s,t,n),t.seen.get(s).isParent=!0)}let l=t.metadataRegistry.get(e);return l&&Object.assign(a.schema,l),"input"===t.io&&function e(t,r){let n=r??{seen:new Set};if(n.seen.has(t))return!1;n.seen.add(t);let i=t._zod.def;if("transform"===i.type)return!0;if("array"===i.type)return e(i.element,n);if("set"===i.type)return e(i.valueType,n);if("lazy"===i.type)return e(i.getter(),n);if("promise"===i.type||"optional"===i.type||"nonoptional"===i.type||"nullable"===i.type||"readonly"===i.type||"default"===i.type||"prefault"===i.type)return e(i.innerType,n);if("intersection"===i.type)return e(i.left,n)||e(i.right,n);if("record"===i.type||"map"===i.type)return e(i.keyType,n)||e(i.valueType,n);if("pipe"===i.type)return e(i.in,n)||e(i.out,n);if("object"===i.type){for(let t in i.shape)if(e(i.shape[t],n))return!0;return!1}if("union"===i.type){for(let t of i.options)if(e(t,n))return!0;return!1}if("tuple"===i.type){for(let t of i.items)if(e(t,n))return!0;if(i.rest&&e(i.rest,n))return!0}return!1}(e)&&(delete a.schema.examples,delete a.schema.default),"input"===t.io&&a.schema._prefault&&((n=a.schema).default??(n.default=a.schema._prefault)),delete a.schema._prefault,t.seen.get(e).schema}function i6(e,t){let r=e.seen.get(t);if(!r)throw Error("Unprocessed schema. This is a bug in Zod.");let n=new Map;for(let t of e.seen.entries()){let r=e.metadataRegistry.get(t[0])?.id;if(r){let e=n.get(r);if(e&&e!==t[0])throw Error(`Duplicate schema id "${r}" detected during JSON Schema conversion. Two different schemas cannot share the same id when converted together.`);n.set(r,t[0])}}let i=t=>{if(t[1].schema.$ref)return;let n=t[1],{ref:i,defId:s}=(t=>{let n="draft-2020-12"===e.target?"$defs":"definitions";if(e.external){let r=e.external.registry.get(t[0])?.id,i=e.external.uri??(e=>e);if(r)return{ref:i(r)};let s=t[1].defId??t[1].schema.id??`schema${e.counter++}`;return t[1].defId=s,{defId:s,ref:`${i("__shared")}#/${n}/${s}`}}if(t[1]===r)return{ref:"#"};let i=`#/${n}/`,s=t[1].schema.id??`__schema${e.counter++}`;return{defId:s,ref:i+s}})(t);n.def={...n.schema},s&&(n.defId=s);let a=n.schema;for(let e in a)delete a[e];a.$ref=i};if("throw"===e.cycles)for(let t of e.seen.entries()){let e=t[1];if(e.cycle)throw Error(`Cycle detected: #/${e.cycle?.join("/")}/<root>

Set the \`cycles\` parameter to \`"ref"\` to resolve cyclical schemas with defs.`)}for(let r of e.seen.entries()){let n=r[1];if(t===r[0]){i(r);continue}if(e.external){let n=e.external.registry.get(r[0])?.id;if(t!==r[0]&&n){i(r);continue}}if(e.metadataRegistry.get(r[0])?.id||n.cycle||n.count>1&&"ref"===e.reused){i(r);continue}}}function i8(e,t){let r=e.seen.get(t);if(!r)throw Error("Unprocessed schema. This is a bug in Zod.");let n=t=>{let r=e.seen.get(t);if(null===r.ref)return;let i=r.def??r.schema,s={...i},a=r.ref;if(r.ref=null,a){n(a);let r=e.seen.get(a),o=r.schema;if(o.$ref&&("draft-07"===e.target||"draft-04"===e.target||"openapi-3.0"===e.target)?(i.allOf=i.allOf??[],i.allOf.push(o)):Object.assign(i,o),Object.assign(i,s),t._zod.parent===a)for(let e in i)"$ref"!==e&&"allOf"!==e&&(e in s||delete i[e]);if(o.$ref)for(let e in i)"$ref"!==e&&"allOf"!==e&&e in r.def&&JSON.stringify(i[e])===JSON.stringify(r.def[e])&&delete i[e]}let o=t._zod.parent;if(o&&o!==a){n(o);let t=e.seen.get(o);if(t?.schema.$ref&&(i.$ref=t.schema.$ref,t.def))for(let e in i)"$ref"!==e&&"allOf"!==e&&e in t.def&&JSON.stringify(i[e])===JSON.stringify(t.def[e])&&delete i[e]}e.override({zodSchema:t,jsonSchema:i,path:r.path??[]})};for(let t of[...e.seen.entries()].reverse())n(t[0]);let i={};if("draft-2020-12"===e.target?i.$schema="https://json-schema.org/draft/2020-12/schema":"draft-07"===e.target?i.$schema="http://json-schema.org/draft-07/schema#":"draft-04"===e.target?i.$schema="http://json-schema.org/draft-04/schema#":e.target,e.external?.uri){let r=e.external.registry.get(t)?.id;if(!r)throw Error("Schema is missing an `id` property");i.$id=e.external.uri(r)}Object.assign(i,r.def??r.schema);let s=e.external?.defs??{};for(let t of e.seen.entries()){let e=t[1];e.def&&e.defId&&(s[e.defId]=e.def)}e.external||Object.keys(s).length>0&&("draft-2020-12"===e.target?i.$defs=s:i.definitions=s);try{let r=JSON.parse(JSON.stringify(i));return Object.defineProperty(r,"~standard",{value:{...t["~standard"],jsonSchema:{input:i7(t,"input",e.processors),output:i7(t,"output",e.processors)}},enumerable:!1,writable:!1}),r}catch(e){throw Error("Error converting schema to JSON.")}}let i7=(e,t,r={})=>n=>{let{libraryOptions:i,target:s}=n??{},a=i4({...i??{},target:s,io:t,processors:r});return i5(e,a),i6(a,e),i8(a,e)},i9={guid:"uuid",url:"uri",datetime:"date-time",json_string:"json-string",regex:""},se=(e,t,r,n)=>{let i=e._zod.def;i5(i.innerType,t,n),t.seen.get(e).ref=i.innerType};e.i(76094),e.i(82358);var st=e.i(22143),st=st;(e,t)=>{nA.init(e,t),sy.init(e,t)},(e,t)=>{nz.init(e,t),sy.init(e,t)};let sr=e4("ZodError",(e,t)=>{t7.init(e,t),e.name="ZodError",Object.defineProperties(e,{format:{value:t=>(function(e,t=e=>e.message){let r={_errors:[]},n=e=>{for(let i of e.issues)if("invalid_union"===i.code&&i.errors.length)i.errors.map(e=>n({issues:e}));else if("invalid_key"===i.code)n({issues:i.issues});else if("invalid_element"===i.code)n({issues:i.issues});else if(0===i.path.length)r._errors.push(t(i));else{let e=r,n=0;for(;n<i.path.length;){let r=i.path[n];n===i.path.length-1?(e[r]=e[r]||{_errors:[]},e[r]._errors.push(t(i))):e[r]=e[r]||{_errors:[]},e=e[r],n++}}};return n(e),r})(e,t)},flatten:{value:t=>(function(e,t=e=>e.message){let r={},n=[];for(let i of e.issues)i.path.length>0?(r[i.path[0]]=r[i.path[0]]||[],r[i.path[0]].push(t(i))):n.push(t(i));return{formErrors:n,fieldErrors:r}})(e,t)},addIssue:{value:t=>{e.issues.push(t),e.message=JSON.stringify(e.issues,ta,2)}},addIssues:{value:t=>{e.issues.push(...t),e.message=JSON.stringify(e.issues,ta,2)}},isEmpty:{get:()=>0===e.issues.length}})},{Parent:Error}),sn=re(sr),si=rr(sr),ss=ri(sr),sa=ra(sr),so=(e,t,r)=>{let n=r?Object.assign(r,{direction:"backward"}):{direction:"backward"};return re(sr)(e,t,n)},sl=(e,t,r)=>re(sr)(e,t,r),su=async(e,t,r)=>{let n=r?Object.assign(r,{direction:"backward"}):{direction:"backward"};return rr(sr)(e,t,n)},sc=async(e,t,r)=>rr(sr)(e,t,r),sd=(e,t,r)=>{let n=r?Object.assign(r,{direction:"backward"}):{direction:"backward"};return ri(sr)(e,t,n)},sh=(e,t,r)=>ri(sr)(e,t,r),sf=async(e,t,r)=>{let n=r?Object.assign(r,{direction:"backward"}):{direction:"backward"};return ra(sr)(e,t,n)},sp=async(e,t,r)=>ra(sr)(e,t,r),sm=e4("ZodType",(e,t)=>(ng.init(e,t),Object.assign(e["~standard"],{jsonSchema:{input:i7(e,"input"),output:i7(e,"output")}}),e.toJSONSchema=((e,t={})=>r=>{let n=i4({...r,processors:t});return i5(e,n),i6(n,e),i8(n,e)})(e,{}),e.def=t,e.type=t.type,Object.defineProperty(e,"_def",{value:t}),e.check=(...r)=>e.clone(st.mergeDefs(t,{checks:[...t.checks??[],...r.map(e=>"function"==typeof e?{_zod:{check:e,def:{check:"custom"},onattach:[]}}:e)]}),{parent:!0}),e.with=e.check,e.clone=(t,r)=>tP(e,t,r),e.brand=()=>e,e.register=(t,r)=>(t.add(e,r),e),e.parse=(t,r)=>sn(e,t,r,{callee:e.parse}),e.safeParse=(t,r)=>ss(e,t,r),e.parseAsync=async(t,r)=>si(e,t,r,{callee:e.parseAsync}),e.safeParseAsync=async(t,r)=>sa(e,t,r),e.spa=e.safeParseAsync,e.encode=(t,r)=>so(e,t,r),e.decode=(t,r)=>sl(e,t,r),e.encodeAsync=async(t,r)=>su(e,t,r),e.decodeAsync=async(t,r)=>sc(e,t,r),e.safeEncode=(t,r)=>sd(e,t,r),e.safeDecode=(t,r)=>sh(e,t,r),e.safeEncodeAsync=async(t,r)=>sf(e,t,r),e.safeDecodeAsync=async(t,r)=>sp(e,t,r),e.refine=(t,r)=>e.check(function(e,t={}){return new sD({type:"custom",check:"custom",fn:e,...tC(t)})}(t,r)),e.superRefine=t=>e.check(function(e){var t;let r,n;return t=t=>(t.addIssue=e=>{"string"==typeof e?t.issues.push(tY(e,t.value,r._zod.def)):(e.fatal&&(e.continue=!1),e.code??(e.code="custom"),e.input??(e.input=t.value),e.inst??(e.inst=r),e.continue??(e.continue=!r._zod.def.abort),t.issues.push(tY(e)))},e(t.value,t)),(n=new r3({check:"custom",...tC(void 0)}))._zod.check=t,r=n}(t)),e.overwrite=t=>e.check(i3(t)),e.optional=()=>sO(e),e.exactOptional=()=>new sT({type:"optional",innerType:e}),e.nullable=()=>sA(e),e.nullish=()=>sO(sA(e)),e.nonoptional=t=>{var r,n;return r=e,n=t,new sz({type:"nonoptional",innerType:r,...st.normalizeParams(n)})},e.array=()=>(function(e,t){return new sw({type:"array",element:e,...tC(void 0)})})(e),e.or=t=>new s_({type:"union",options:[e,t],...st.normalizeParams(void 0)}),e.and=t=>new sk({type:"intersection",left:e,right:t}),e.transform=t=>sF(e,new sE({type:"transform",transform:t})),e.default=t=>{var r,n;return r=e,n=t,new sP({type:"default",innerType:r,get defaultValue(){return"function"==typeof n?n():st.shallowClone(n)}})},e.prefault=t=>{var r,n;return r=e,n=t,new sC({type:"prefault",innerType:r,get defaultValue(){return"function"==typeof n?n():st.shallowClone(n)}})},e.catch=t=>{var r;return new sR({type:"catch",innerType:e,catchValue:"function"==typeof(r=t)?r:()=>r})},e.pipe=t=>sF(e,t),e.readonly=()=>new sI({type:"readonly",innerType:e}),e.describe=t=>{let r=e.clone();return iW.add(r,{description:t}),r},Object.defineProperty(e,"description",{get:()=>iW.get(e)?.description,configurable:!0}),e.meta=(...t)=>{if(0===t.length)return iW.get(e);let r=e.clone();return iW.add(r,t[0]),r},e.isOptional=()=>e.safeParse(void 0).success,e.isNullable=()=>e.safeParse(null).success,e.apply=t=>t(e),e)),sg=e4("_ZodString",(e,t)=>{ny.init(e,t),sm.init(e,t),e._zod.processJSONSchema=(t,r,n)=>((e,t,r,n)=>{r.type="string";let{minimum:i,maximum:s,format:a,patterns:o,contentEncoding:l}=e._zod.bag;if("number"==typeof i&&(r.minLength=i),"number"==typeof s&&(r.maxLength=s),a&&(r.format=i9[a]??a,""===r.format&&delete r.format,"time"===a&&delete r.format),l&&(r.contentEncoding=l),o&&o.size>0){let e=[...o];1===e.length?r.pattern=e[0].source:e.length>1&&(r.allOf=[...e.map(e=>({..."draft-07"===t.target||"draft-04"===t.target||"openapi-3.0"===t.target?{type:"string"}:{},pattern:e.source}))])}})(e,t,r,0);let r=e._zod.bag;e.format=r.format??null,e.minLength=r.minimum??null,e.maxLength=r.maximum??null,e.regex=(...t)=>e.check(function(e,t){return new no({check:"string_format",format:"regex",...tC(t),pattern:e})}(...t)),e.includes=(...t)=>e.check(function(e,t){return new nc({check:"string_format",format:"includes",...tC(t),includes:e})}(...t)),e.startsWith=(...t)=>e.check(function(e,t){return new nd({check:"string_format",format:"starts_with",...tC(t),prefix:e})}(...t)),e.endsWith=(...t)=>e.check(function(e,t){return new nh({check:"string_format",format:"ends_with",...tC(t),suffix:e})}(...t)),e.min=(...t)=>e.check(i1(...t)),e.max=(...t)=>e.check(i0(...t)),e.length=(...t)=>e.check(i2(...t)),e.nonempty=(...t)=>e.check(i1(1,...t)),e.lowercase=t=>e.check(new nl({check:"string_format",format:"lowercase",...tC(t)})),e.uppercase=t=>e.check(new nu({check:"string_format",format:"uppercase",...tC(t)})),e.trim=()=>e.check(i3(e=>e.trim())),e.normalize=(...t)=>e.check(function(e){return i3(t=>t.normalize(e))}(...t)),e.toLowerCase=()=>e.check(i3(e=>e.toLowerCase())),e.toUpperCase=()=>e.check(i3(e=>e.toUpperCase())),e.slugify=()=>e.check(i3(e=>tw(e)))}),sy=e4("ZodStringFormat",(e,t)=>{nv.init(e,t),sg.init(e,t)}),sv=((e,t)=>{nw.init(e,t),sy.init(e,t)},e4("ZodNumber",(e,t)=>{nJ.init(e,t),sm.init(e,t),e._zod.processJSONSchema=(t,r,n)=>((e,t,r,n)=>{let{minimum:i,maximum:s,format:a,multipleOf:o,exclusiveMaximum:l,exclusiveMinimum:u}=e._zod.bag;"string"==typeof a&&a.includes("int")?r.type="integer":r.type="number","number"==typeof u&&("draft-04"===t.target||"openapi-3.0"===t.target?(r.minimum=u,r.exclusiveMinimum=!0):r.exclusiveMinimum=u),"number"==typeof i&&(r.minimum=i,"number"==typeof u&&"draft-04"!==t.target&&(u>=i?delete r.minimum:delete r.exclusiveMinimum)),"number"==typeof l&&("draft-04"===t.target||"openapi-3.0"===t.target?(r.maximum=l,r.exclusiveMaximum=!0):r.exclusiveMaximum=l),"number"==typeof s&&(r.maximum=s,"number"==typeof l&&"draft-04"!==t.target&&(l<=s?delete r.maximum:delete r.exclusiveMaximum)),"number"==typeof o&&(r.multipleOf=o)})(e,t,r,0),e.gt=(t,r)=>e.check(iQ(t,r)),e.gte=(t,r)=>e.check(iY(t,r)),e.min=(t,r)=>e.check(iY(t,r)),e.lt=(t,r)=>e.check(iG(t,r)),e.lte=(t,r)=>e.check(iH(t,r)),e.max=(t,r)=>e.check(iH(t,r)),e.int=t=>e.check(sx(t)),e.safe=t=>e.check(sx(t)),e.positive=t=>e.check(iQ(0,t)),e.nonnegative=t=>e.check(iY(0,t)),e.negative=t=>e.check(iG(0,t)),e.nonpositive=t=>e.check(iH(0,t)),e.multipleOf=(t,r)=>e.check(iX(t,r)),e.step=(t,r)=>e.check(iX(t,r)),e.finite=()=>e;let r=e._zod.bag;e.minValue=Math.max(r.minimum??-1/0,r.exclusiveMinimum??-1/0)??null,e.maxValue=Math.min(r.maximum??1/0,r.exclusiveMaximum??1/0)??null,e.isInt=(r.format??"").includes("int")||Number.isSafeInteger(r.multipleOf??.5),e.isFinite=!0,e.format=r.format??null})),sb=e4("ZodNumberFormat",(e,t)=>{nW.init(e,t),sv.init(e,t)});function sx(e){return new sb({type:"number",check:"number_format",abort:!1,format:"safeint",...tC(e)})}(e,t)=>{nH.init(e,t),sm.init(e,t),e._zod.processJSONSchema=(e,t,r)=>((e,t,r,n)=>{if("throw"===t.unrepresentable)throw Error("BigInt cannot be represented in JSON Schema")})(0,e,0,0),e.gte=(t,r)=>e.check(iY(t,r)),e.min=(t,r)=>e.check(iY(t,r)),e.gt=(t,r)=>e.check(iQ(t,r)),e.gte=(t,r)=>e.check(iY(t,r)),e.min=(t,r)=>e.check(iY(t,r)),e.lt=(t,r)=>e.check(iG(t,r)),e.lte=(t,r)=>e.check(iH(t,r)),e.max=(t,r)=>e.check(iH(t,r)),e.positive=t=>e.check(iQ(BigInt(0),t)),e.negative=t=>e.check(iG(BigInt(0),t)),e.nonpositive=t=>e.check(iH(BigInt(0),t)),e.nonnegative=t=>e.check(iY(BigInt(0),t)),e.multipleOf=(t,r)=>e.check(iX(t,r));let r=e._zod.bag;e.minValue=r.minimum??null,e.maxValue=r.maximum??null,e.format=r.format??null};(e,t)=>{n2.init(e,t),sm.init(e,t),e._zod.processJSONSchema=(e,t,r)=>{}};(e,t)=>{n3.init(e,t),sm.init(e,t),e._zod.processJSONSchema=(e,t,r)=>{t.not={}}};let sw=e4("ZodArray",(e,t)=>{n8.init(e,t),sm.init(e,t),e._zod.processJSONSchema=(t,r,n)=>((e,t,r,n)=>{let i=e._zod.def,{minimum:s,maximum:a}=e._zod.bag;"number"==typeof s&&(r.minItems=s),"number"==typeof a&&(r.maxItems=a),r.type="array",r.items=i5(i.element,t,{...n,path:[...n.path,"items"]})})(e,t,r,n),e.element=t.element,e.min=(t,r)=>e.check(i1(t,r)),e.nonempty=t=>e.check(i1(1,t)),e.max=(t,r)=>e.check(i0(t,r)),e.length=(t,r)=>e.check(i2(t,r)),e.unwrap=()=>e.element}),s_=e4("ZodUnion",(e,t)=>{is.init(e,t),sm.init(e,t),e._zod.processJSONSchema=(t,r,n)=>{var i,s,a,o;let l,u,c;return i=e,s=t,a=r,o=n,u=!1===(l=i._zod.def).inclusive,c=l.options.map((e,t)=>i5(e,s,{...o,path:[...o.path,u?"oneOf":"anyOf",t]})),void(u?a.oneOf=c:a.anyOf=c)},e.options=t.options}),sk=e4("ZodIntersection",(e,t)=>{iu.init(e,t),sm.init(e,t),e._zod.processJSONSchema=(t,r,n)=>{let i,s,a,o;return s=i5((i=e._zod.def).left,t,{...n,path:[...n.path,"allOf",0]}),a=i5(i.right,t,{...n,path:[...n.path,"allOf",1]}),void(r.allOf=[...(o=e=>"allOf"in e&&1===Object.keys(e).length)(s)?s.allOf:[s],...o(a)?a.allOf:[a]])}}),sj=e4("ZodEnum",(e,t)=>{ib.init(e,t),sm.init(e,t),e._zod.processJSONSchema=(t,r,n)=>{let i;(i=ti(e._zod.def.entries)).every(e=>"number"==typeof e)&&(r.type="number"),i.every(e=>"string"==typeof e)&&(r.type="string"),r.enum=i},e.enum=t.entries,e.options=Object.values(t.entries);let r=new Set(Object.keys(t.entries));e.extract=(e,n)=>{let i={};for(let n of e)if(r.has(n))i[n]=t.entries[n];else throw Error(`Key ${n} not found in enum`);return new sj({...t,checks:[],...st.normalizeParams(n),entries:i})},e.exclude=(e,n)=>{let i={...t.entries};for(let t of e)if(r.has(t))delete i[t];else throw Error(`Key ${t} not found in enum`);return new sj({...t,checks:[],...st.normalizeParams(n),entries:i})}}),sE=e4("ZodTransform",(e,t)=>{i_.init(e,t),sm.init(e,t),e._zod.processJSONSchema=(e,t,r)=>((e,t,r,n)=>{if("throw"===t.unrepresentable)throw Error("Transforms cannot be represented in JSON Schema")})(0,e,0,0),e._zod.parse=(r,n)=>{if("backward"===n.direction)throw new e6(e.constructor.name);r.addIssue=n=>{"string"==typeof n?r.issues.push(st.issue(n,r.value,t)):(n.fatal&&(n.continue=!1),n.code??(n.code="custom"),n.input??(n.input=r.value),n.inst??(n.inst=e),r.issues.push(st.issue(n)))};let i=t.transform(r.value,r);return i instanceof Promise?i.then(e=>(r.value=e,r)):(r.value=i,r)}}),sS=e4("ZodOptional",(e,t)=>{ij.init(e,t),sm.init(e,t),e._zod.processJSONSchema=(t,r,n)=>se(e,t,r,n),e.unwrap=()=>e._zod.def.innerType});function sO(e){return new sS({type:"optional",innerType:e})}let sT=e4("ZodExactOptional",(e,t)=>{iE.init(e,t),sm.init(e,t),e._zod.processJSONSchema=(t,r,n)=>se(e,t,r,n),e.unwrap=()=>e._zod.def.innerType}),sN=e4("ZodNullable",(e,t)=>{iS.init(e,t),sm.init(e,t),e._zod.processJSONSchema=(t,r,n)=>{let i,s,a;return s=i5((i=e._zod.def).innerType,t,n),a=t.seen.get(e),void("openapi-3.0"===t.target?(a.ref=i.innerType,r.nullable=!0):r.anyOf=[s,{type:"null"}])},e.unwrap=()=>e._zod.def.innerType});function sA(e){return new sN({type:"nullable",innerType:e})}let sP=e4("ZodDefault",(e,t)=>{iO.init(e,t),sm.init(e,t),e._zod.processJSONSchema=(t,r,n)=>{let i;i5((i=e._zod.def).innerType,t,n),t.seen.get(e).ref=i.innerType,r.default=JSON.parse(JSON.stringify(i.defaultValue))},e.unwrap=()=>e._zod.def.innerType,e.removeDefault=e.unwrap}),sC=e4("ZodPrefault",(e,t)=>{iN.init(e,t),sm.init(e,t),e._zod.processJSONSchema=(t,r,n)=>{let i;i5((i=e._zod.def).innerType,t,n),t.seen.get(e).ref=i.innerType,"input"===t.io&&(r._prefault=JSON.parse(JSON.stringify(i.defaultValue)))},e.unwrap=()=>e._zod.def.innerType}),sz=e4("ZodNonOptional",(e,t)=>{iA.init(e,t),sm.init(e,t),e._zod.processJSONSchema=(t,r,n)=>{let i;i5((i=e._zod.def).innerType,t,n),t.seen.get(e).ref=i.innerType},e.unwrap=()=>e._zod.def.innerType}),sR=e4("ZodCatch",(e,t)=>{iz.init(e,t),sm.init(e,t),e._zod.processJSONSchema=(t,r,n)=>((e,t,r,n)=>{let i,s=e._zod.def;i5(s.innerType,t,n),t.seen.get(e).ref=s.innerType;try{i=s.catchValue(void 0)}catch{throw Error("Dynamic catch values are not supported in JSON Schema")}r.default=i})(e,t,r,n),e.unwrap=()=>e._zod.def.innerType,e.removeCatch=e.unwrap}),s$=e4("ZodPipe",(e,t)=>{i$.init(e,t),sm.init(e,t),e._zod.processJSONSchema=(t,r,n)=>{let i,s;return i=e._zod.def,void(i5(s="input"===t.io?"transform"===i.in._zod.def.type?i.out:i.in:i.out,t,n),t.seen.get(e).ref=s)},e.in=t.in,e.out=t.out});function sF(e,t){return new s$({type:"pipe",in:e,out:t})}let sI=e4("ZodReadonly",(e,t)=>{iU.init(e,t),sm.init(e,t),e._zod.processJSONSchema=(t,r,n)=>{let i;i5((i=e._zod.def).innerType,t,n),t.seen.get(e).ref=i.innerType,r.readOnly=!0},e.unwrap=()=>e._zod.def.innerType}),sD=e4("ZodCustom",(e,t)=>{iV.init(e,t),sm.init(e,t),e._zod.processJSONSchema=(e,t,r)=>((e,t,r,n)=>{if("throw"===t.unrepresentable)throw Error("Custom types cannot be represented in JSON Schema")})(0,e,0,0)});var sM=class extends Error{constructor(e,t){super(e,t),this.name="BetterAuthError",this.message=e,this.stack=""}};function sU(e,t="/api/auth"){try{let t=new URL(e);if("http:"!==t.protocol&&"https:"!==t.protocol)throw new sM(`Invalid base URL: ${e}. URL must include 'http://' or 'https://'`)}catch(t){if(t instanceof sM)throw t;throw new sM(`Invalid base URL: ${e}. Please provide a valid base URL.`,{cause:t})}if(function(e){try{return"/"!==(new URL(e).pathname.replace(/\/+$/,"")||"/")}catch{throw new sM(`Invalid base URL: ${e}. Please provide a valid base URL.`)}}(e))return e;let r=e.replace(/\/+$/,"");return t&&"/"!==t?(t=t.startsWith("/")?t:`/${t}`,`${r}${t}`):r}let sL={id:"redirect",name:"Redirect",hooks:{onSuccess(e){if(e.data?.url&&e.data?.redirect&&"u">typeof window&&window.location&&window.location)try{window.location.href=e.data.url}catch{}}}},sB={proto:/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,constructor:/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,protoShort:/"__proto__"\s*:/,constructorShort:/"constructor"\s*:/},sK=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/,sZ={true:!0,false:!1,null:null,undefined:void 0,nan:NaN,infinity:1/0,"-infinity":-1/0},sq=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})(?:\.(\d{1,7}))?(?:Z|([+-])(\d{2}):(\d{2}))$/,sV=[],sJ=0,sW=0,sG=e=>{let t=[],r={get:()=>(r.lc||r.listen(()=>{})(),r.value),lc:0,listen:e=>(r.lc=t.push(e),()=>{for(let t=sJ+4;t<sV.length;)sV[t]===e?sV.splice(t,4):t+=4;let n=t.indexOf(e);~n&&(t.splice(n,1),--r.lc||r.off())}),notify(e,n){sW++;let i=!sV.length;for(let i of t)sV.push(i,r.value,e,n);if(i){for(sJ=0;sJ<sV.length;sJ+=4)sV[sJ](sV[sJ+1],sV[sJ+2],sV[sJ+3]);sV.length=0}},off(){},set(e){let t=r.value;t!==e&&(r.value=e,r.notify(t))},subscribe(e){let t=r.listen(e);return e(r.value),t},value:e};return r},sH=(e,t)=>{var r,n;return r=r=>{let n=t(r);n&&e.events[6].push(n)},n=t=>{let r=e.listen;e.listen=(...n)=>(e.lc||e.active||(e.active=!0,t()),r(...n));let n=e.off;return e.events[6]=[],e.off=()=>{n(),setTimeout(()=>{if(e.active&&!e.lc){for(let t of(e.active=!1,e.events[6]))t();e.events[6]=[]}},1e3)},()=>{e.listen=r,e.off=n}},e.events=e.events||{},e.events[15]||(e.events[15]=n(t=>{e.events[5].reduceRight((e,t)=>(t(e),e),{shared:{},...t})})),e.events[5]=e.events[5]||[],e.events[5].push(r),()=>{let t=e.events[5],n=t.indexOf(r);t.splice(n,1),t.length||(delete e.events[5],e.events[15](),delete e.events[15])}},sQ=()=>"u"<typeof window,sY=Symbol.for("better-auth:broadcast-channel");var sX=class{listeners=new Set;name;constructor(e="better-auth.message"){this.name=e}subscribe(e){return this.listeners.add(e),()=>{this.listeners.delete(e)}}post(e){if("u">typeof window)try{localStorage.setItem(this.name,JSON.stringify({...e,timestamp:Math.floor(Date.now()/1e3)}))}catch{}}setup(){if("u"<typeof window||void 0===window.addEventListener)return()=>{};let e=e=>{if(e.key!==this.name)return;let t=JSON.parse(e.newValue??"{}");t?.event==="session"&&t?.data&&this.listeners.forEach(e=>e(t))};return window.addEventListener("storage",e),()=>{window.removeEventListener("storage",e)}}};function s0(e="better-auth.message"){return globalThis[sY]||(globalThis[sY]=new sX(e)),globalThis[sY]}let s1=Symbol.for("better-auth:focus-manager");var s2=class{listeners=new Set;subscribe(e){return this.listeners.add(e),()=>{this.listeners.delete(e)}}setFocused(e){this.listeners.forEach(t=>t(e))}setup(){if("u"<typeof window||"u"<typeof document||void 0===window.addEventListener)return()=>{};let e=()=>{"visible"===document.visibilityState&&this.setFocused(!0)};return document.addEventListener("visibilitychange",e,!1),()=>{document.removeEventListener("visibilitychange",e,!1)}}};function s3(){return globalThis[s1]||(globalThis[s1]=new s2),globalThis[s1]}let s4=Symbol.for("better-auth:online-manager");var s5=class{listeners=new Set;isOnline="u"<typeof navigator||navigator.onLine;subscribe(e){return this.listeners.add(e),()=>{this.listeners.delete(e)}}setOnline(e){this.isOnline=e,this.listeners.forEach(t=>t(e))}setup(){if("u"<typeof window||void 0===window.addEventListener)return()=>{};let e=()=>this.setOnline(!0),t=()=>this.setOnline(!1);return window.addEventListener("online",e,!1),window.addEventListener("offline",t,!1),()=>{window.removeEventListener("online",e,!1),window.removeEventListener("offline",t,!1)}}};function s6(){return globalThis[s4]||(globalThis[s4]=new s5),globalThis[s4]}let s8=()=>Math.floor(Date.now()/1e3);function s7(e){if(null===e||"object"!=typeof e)return!1;let t=Object.getPrototypeOf(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&!(Symbol.iterator in e)&&(!(Symbol.toStringTag in e)||"[object Module]"===Object.prototype.toString.call(e))}function s9(e){return(...t)=>t.reduce((t,r)=>(function e(t,r,n=".",i){if(!s7(r))return e(t,{},n,i);let s=Object.assign({},r);for(let r in t){if("__proto__"===r||"constructor"===r)continue;let a=t[r];null!=a&&(i&&i(s,r,a,n)||(Array.isArray(a)&&Array.isArray(s[r])?s[r]=[...a,...s[r]]:s7(a)&&s7(s[r])?s[r]=e(a,s[r],(n?`${n}.`:"")+r.toString(),i):s[r]=a))}return s})(t,r,"",e),{})}let ae=s9();s9((e,t,r)=>{if(void 0!==e[t]&&"function"==typeof r)return e[t]=r(e[t]),!0}),s9((e,t,r)=>{if(Array.isArray(e[t])&&"function"==typeof r)return e[t]=r(e[t]),!0});var at=Object.defineProperty,ar=Object.defineProperties,an=Object.getOwnPropertyDescriptors,ai=Object.getOwnPropertySymbols,as=Object.prototype.hasOwnProperty,aa=Object.prototype.propertyIsEnumerable,ao=(e,t,r)=>t in e?at(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,al=(e,t)=>{for(var r in t||(t={}))as.call(t,r)&&ao(e,r,t[r]);if(ai)for(var r of ai(t))aa.call(t,r)&&ao(e,r,t[r]);return e},au=(e,t)=>ar(e,an(t)),ac=class extends Error{constructor(e,t,r){super(t||e.toString(),{cause:r}),this.status=e,this.statusText=t,this.error=r,Error.captureStackTrace(this,this.constructor)}},ad=async(e,t)=>{var r,n,i,s,a,o;let l=t||{},u={onRequest:[null==t?void 0:t.onRequest],onResponse:[null==t?void 0:t.onResponse],onSuccess:[null==t?void 0:t.onSuccess],onError:[null==t?void 0:t.onError],onRetry:[null==t?void 0:t.onRetry]};if(!t||!(null==t?void 0:t.plugins))return{url:e,options:l,hooks:u};for(let c of(null==t?void 0:t.plugins)||[]){if(c.init){let n=await (null==(r=c.init)?void 0:r.call(c,e.toString(),t));l=n.options||l,e=n.url}u.onRequest.push(null==(n=c.hooks)?void 0:n.onRequest),u.onResponse.push(null==(i=c.hooks)?void 0:i.onResponse),u.onSuccess.push(null==(s=c.hooks)?void 0:s.onSuccess),u.onError.push(null==(a=c.hooks)?void 0:a.onError),u.onRetry.push(null==(o=c.hooks)?void 0:o.onRetry)}return{url:e,options:l,hooks:u}},ah=class{constructor(e){this.options=e}shouldAttemptRetry(e,t){return this.options.shouldRetry?Promise.resolve(e<this.options.attempts&&this.options.shouldRetry(t)):Promise.resolve(e<this.options.attempts)}getDelay(){return this.options.delay}},af=class{constructor(e){this.options=e}shouldAttemptRetry(e,t){return this.options.shouldRetry?Promise.resolve(e<this.options.attempts&&this.options.shouldRetry(t)):Promise.resolve(e<this.options.attempts)}getDelay(e){return Math.min(this.options.maxDelay,this.options.baseDelay*2**e)}},ap=async e=>{let t={},r=async e=>"function"==typeof e?await e():e;if(null==e?void 0:e.auth){if("Bearer"===e.auth.type){let n=await r(e.auth.token);if(!n)return t;t.authorization=`Bearer ${n}`}else if("Basic"===e.auth.type){let[n,i]=await Promise.all([r(e.auth.username),r(e.auth.password)]);if(!n||!i)return t;t.authorization=`Basic ${btoa(`${n}:${i}`)}`}else if("Custom"===e.auth.type){let[n,i]=await Promise.all([r(e.auth.prefix),r(e.auth.value)]);if(!i)return t;t.authorization=`${null!=n?n:""} ${i}`}}return t},am=/^application\/(?:[\w!#$%&*.^`~-]*\+)?json(;.+)?$/i;function ag(e){if(void 0===e)return!1;let t=typeof e;return"string"===t||"number"===t||"boolean"===t||null===t||"object"===t&&(!!Array.isArray(e)||!e.buffer&&(e.constructor&&"Object"===e.constructor.name||"function"==typeof e.toJSON))}function ay(e){try{return JSON.parse(e)}catch(t){return e}}function av(e){return"function"==typeof e}async function ab(e){let t=new Headers(null==e?void 0:e.headers);for(let[r,n]of Object.entries(await ap(e)||{}))t.set(r,n);if(!t.has("content-type")){let r=ag(null==e?void 0:e.body)?"application/json":null;r&&t.set("content-type",r)}return t}var ax=class e extends Error{constructor(t,r){super(r||JSON.stringify(t,null,2)),this.issues=t,Object.setPrototypeOf(this,e.prototype)}};async function aw(e,t){let r=await e["~standard"].validate(t);if(r.issues)throw new ax(r.issues);return r.value}var a_=["get","post","put","patch","delete"],ak=async(e,t)=>{var r,n,i,s,a,o,l,u;let c,{hooks:d,url:h,options:f}=await ad(e,t),p=function(e){if(null==e?void 0:e.customFetchImpl)return e.customFetchImpl;if("u">typeof globalThis&&av(globalThis.fetch))return globalThis.fetch;if("u">typeof window&&av(window.fetch))return window.fetch;throw Error("No fetch implementation found")}(f),m=new AbortController,g=null!=(r=f.signal)?r:m.signal,y=function(e,t){let{baseURL:r,params:n,query:i}=t||{query:{},params:{},baseURL:""},s=e.startsWith("http")?e.split("/").slice(0,3).join("/"):r||"";if(e.startsWith("@")){let t=e.toString().split("@")[1].split("/")[0];a_.includes(t)&&(e=e.replace(`@${t}/`,"/"))}s.endsWith("/")||(s+="/");let[a,o]=e.replace(s,"").split("?"),l=new URLSearchParams(o);for(let[e,t]of Object.entries(i||{})){let r;if(null!=t){if("string"==typeof t)r=t;else if(Array.isArray(t)){for(let r of t)l.append(e,r);continue}else r=JSON.stringify(t);l.set(e,r)}}if(n)if(Array.isArray(n))for(let[e,t]of a.split("/").filter(e=>e.startsWith(":")).entries()){let r=n[e];a=a.replace(t,r)}else for(let[e,t]of Object.entries(n))a=a.replace(`:${e}`,String(t));(a=a.split("/").map(encodeURIComponent).join("/")).startsWith("/")&&(a=a.slice(1));let u=l.toString();return(u=u.length>0?`?${u}`.replace(/\+/g,"%20"):"",s.startsWith("http"))?new URL(`${a}${u}`,s):`${s}${a}${u}`}(h,f),v=function(e){if(!(null==e?void 0:e.body))return null;let t=new Headers(null==e?void 0:e.headers);if(ag(e.body)&&!t.has("content-type")){for(let[t,r]of Object.entries(null==e?void 0:e.body))r instanceof Date&&(e.body[t]=r.toISOString());return JSON.stringify(e.body)}return t.has("content-type")&&"application/x-www-form-urlencoded"===t.get("content-type")&&ag(e.body)?new URLSearchParams(e.body).toString():e.body}(f),b=await ab(f),x=function(e,t){var r;if(null==t?void 0:t.method)return t.method.toUpperCase();if(e.startsWith("@")){let n=null==(r=e.split("@")[1])?void 0:r.split("/")[0];return a_.includes(n)?n.toUpperCase():(null==t?void 0:t.body)?"POST":"GET"}return(null==t?void 0:t.body)?"POST":"GET"}(h,f),w=au(al({},f),{url:y,headers:b,body:v,method:x,signal:g});for(let e of d.onRequest)if(e){let t=await e(w);"object"==typeof t&&null!==t&&(w=t)}("pipeTo"in w&&"function"==typeof w.pipeTo||"function"==typeof(null==(n=null==t?void 0:t.body)?void 0:n.pipe))&&!("duplex"in w)&&(w.duplex="half");let{clearTimeout:_}=(!(null==f?void 0:f.signal)&&(null==f?void 0:f.timeout)&&(c=setTimeout(()=>null==m?void 0:m.abort(),null==f?void 0:f.timeout)),{abortTimeout:c,clearTimeout:()=>{c&&clearTimeout(c)}}),k=await p(w.url,w);_();let j={response:k,request:w};for(let e of d.onResponse)if(e){let r=await e(au(al({},j),{response:(null==(i=null==t?void 0:t.hookOptions)?void 0:i.cloneResponse)?k.clone():k}));r instanceof Response?k=r:"object"==typeof r&&null!==r&&(k=r.response)}if(k.ok){if("HEAD"===w.method)return{data:"",error:null};let e=function(e){let t=e.headers.get("content-type"),r=new Set(["image/svg","application/xml","application/xhtml","application/html"]);if(!t)return"json";let n=t.split(";").shift()||"";return am.test(n)?"json":r.has(n)||n.startsWith("text/")?"text":"blob"}(k),r={data:null,response:k,request:w};if("json"===e||"text"===e){let e=await k.text(),t=null!=(s=w.jsonParser)?s:ay;r.data=await t(e)}else r.data=await k[e]();for(let e of((null==w?void 0:w.output)&&w.output&&!w.disableValidation&&(r.data=await aw(w.output,r.data)),d.onSuccess))e&&await e(au(al({},r),{response:(null==(a=null==t?void 0:t.hookOptions)?void 0:a.cloneResponse)?k.clone():k}));return(null==t?void 0:t.throw)?r.data:{data:r.data,error:null}}let E=null!=(o=null==t?void 0:t.jsonParser)?o:ay,S=await k.text(),O=function(e){try{return JSON.parse(e),!0}catch(e){return!1}}(S),T=O?await E(S):null,N={response:k,responseText:S,request:w,error:au(al({},T),{status:k.status,statusText:k.statusText})};for(let e of d.onError)e&&await e(au(al({},N),{response:(null==(l=null==t?void 0:t.hookOptions)?void 0:l.cloneResponse)?k.clone():k}));if(null==t?void 0:t.retry){let r=function(e){if("number"==typeof e)return new ah({type:"linear",attempts:e,delay:1e3});switch(e.type){case"linear":return new ah(e);case"exponential":return new af(e);default:throw Error("Invalid retry strategy")}}(t.retry),n=null!=(u=t.retryAttempt)?u:0;if(await r.shouldAttemptRetry(n,k)){for(let e of d.onRetry)e&&await e(j);let i=r.getDelay(n);return await new Promise(e=>setTimeout(e,i)),await ak(e,au(al({},t),{retryAttempt:n+1}))}}if(null==t?void 0:t.throw)throw new ac(k.status,k.statusText,O?T:S);return{data:null,error:au(al({},T),{status:k.status,statusText:k.statusText})}};let{signIn:aj,signUp:aE,signOut:aS,useSession:aO,getSession:aT}=function(e){var t;let{pluginPathMethods:r,pluginsActions:n,pluginsAtoms:i,$fetch:s,$store:a,atomListeners:o}=((e,t)=>{var r;let n,i,s="credentials"in Request.prototype,a=function(e,t,r,n,i){if(e)return sU(e,t);if(!1!==n){let e=eq.BETTER_AUTH_URL||eq.NEXT_PUBLIC_BETTER_AUTH_URL||eq.PUBLIC_BETTER_AUTH_URL||eq.NUXT_PUBLIC_BETTER_AUTH_URL||eq.NUXT_PUBLIC_AUTH_URL||("/"!==eq.BASE_URL?eq.BASE_URL:void 0);if(e)return sU(e,t)}r?.headers.get("x-forwarded-host"),r?.headers.get("x-forwarded-proto");if(r){let e=function(e){try{let t=new URL(e);return"null"===t.origin?null:t.origin}catch{return null}}(r.url);if(!e)throw new sM("Could not get origin from request. Please provide a valid base URL.");return sU(e,t)}if("u">typeof window&&window.location)return sU(window.location.origin,t)}(e?.baseURL,e?.basePath,void 0,t)??"/api/auth",o=e?.plugins?.flatMap(e=>e.fetchPlugins).filter(e=>void 0!==e)||[],l={id:"lifecycle-hooks",name:"lifecycle-hooks",hooks:{onSuccess:e?.fetchOptions?.onSuccess,onError:e?.fetchOptions?.onError,onRequest:e?.fetchOptions?.onRequest,onResponse:e?.fetchOptions?.onResponse}},{onSuccess:u,onError:c,onRequest:d,onResponse:h,...f}=e?.fetchOptions||{},p=(r={baseURL:a,...s?{credentials:"include"}:{},method:"GET",jsonParser:e=>e?function(e,t={strict:!0}){return function(e,t={}){let{strict:r=!1,warnings:n=!1,reviver:i,parseDates:s=!0}=t;if("string"!=typeof e)return e;let a=e.trim();if(a.length>0&&'"'===a[0]&&a.endsWith('"')&&!a.slice(1,-1).includes('"'))return a.slice(1,-1);let o=a.toLowerCase();if(o.length<=9&&o in sZ)return sZ[o];if(!sK.test(a)){if(r)throw SyntaxError("[better-json] Invalid JSON");return e}if(Object.entries(sB).some(([e,t])=>{let r=t.test(a);return r&&n&&console.warn(`[better-json] Detected potential prototype pollution attempt using ${e} pattern`),r})&&r)throw Error("[better-json] Potential prototype pollution attempt detected");try{return JSON.parse(a,(e,t)=>{if("__proto__"===e||"constructor"===e&&t&&"object"==typeof t&&"prototype"in t){n&&console.warn(`[better-json] Dropping "${e}" key to prevent prototype pollution`);return}if(s&&"string"==typeof t){let e=function(e){let t=sq.exec(e);if(!t)return null;let[,r,n,i,s,a,o,l,u,c,d]=t,h=new Date(Date.UTC(parseInt(r,10),parseInt(n,10)-1,parseInt(i,10),parseInt(s,10),parseInt(a,10),parseInt(o,10),l?parseInt(l.padEnd(3,"0"),10):0));if(u){let e=(60*parseInt(c,10)+parseInt(d,10))*("+"===u?-1:1);h.setUTCMinutes(h.getUTCMinutes()+e)}return h instanceof Date&&!isNaN(h.getTime())?h:null}(t);if(e)return e}return i?i(e,t):t})}catch(t){if(r)throw t;return e}}(e,t)}(e,{strict:!1}):null,customFetchImpl:fetch,...f,plugins:[l,...f.plugins||[],...e?.disableDefaultFetchPlugins?[]:[sL],...o]},async function(e,t){let n,i=au(al(al({},r),t),{plugins:[...(null==r?void 0:r.plugins)||[],(n=r||{},{id:"apply-schema",name:"Apply Schema",version:"1.0.0",async init(e,t){var r,i,s,a;let o=(null==(i=null==(r=n.plugins)?void 0:r.find(t=>{var r;return null!=(r=t.schema)&&!!r.config&&(e.startsWith(t.schema.config.baseURL||"")||e.startsWith(t.schema.config.prefix||""))}))?void 0:i.schema)||n.schema;if(o){let r=e;(null==(s=o.config)?void 0:s.prefix)&&r.startsWith(o.config.prefix)&&(r=r.replace(o.config.prefix,""),o.config.baseURL&&(e=e.replace(o.config.prefix,o.config.baseURL))),(null==(a=o.config)?void 0:a.baseURL)&&r.startsWith(o.config.baseURL)&&(r=r.replace(o.config.baseURL,""));let n=o.schema[r];if(n){let r=au(al({},t),{method:n.method,output:n.output});return(null==t?void 0:t.disableValidation)||(r=au(al({},r),{body:n.input?await aw(n.input,null==t?void 0:t.body):null==t?void 0:t.body,params:n.params?await aw(n.params,null==t?void 0:t.params):null==t?void 0:t.params,query:n.query?await aw(n.query,null==t?void 0:t.query):null==t?void 0:t.query})),{url:e,options:r}}}return{url:e,options:t}}}),...(null==t?void 0:t.plugins)||[]]});if(null==r?void 0:r.catchAllError)try{return await ak(e,i)}catch(e){return{data:null,error:{status:500,statusText:"Fetch Error",message:"Fetch related error. Captured by catchAllError option. See error property for more details.",error:e}}}return await ak(e,i)}),{$sessionSignal:m,session:g}=(i=((e,t,r,n)=>{let i=sG({data:null,error:null,isPending:!0,isRefetching:!1,refetch:e=>s(e)}),s=async e=>new Promise(s=>{let a="function"==typeof n?n({data:i.get().data,error:i.get().error,isPending:i.get().isPending}):n;r(t,{...a,query:{...a?.query,...e?.query},async onSuccess(e){i.set({data:e.data,error:null,isPending:!1,isRefetching:!1,refetch:i.value.refetch}),await a?.onSuccess?.(e)},async onError(e){let{request:t}=e,r="number"==typeof t.retry?t.retry:t.retry?.attempts,n=t.retryAttempt||0;r&&n<r||(i.set({error:e.error,data:null,isPending:!1,isRefetching:!1,refetch:i.value.refetch}),await a?.onError?.(e))},async onRequest(e){let t=i.get();i.set({isPending:null===t.data,data:t.data,error:null,isRefetching:!0,refetch:i.value.refetch}),await a?.onRequest?.(e)}}).catch(e=>{i.set({error:e,data:null,isPending:!1,isRefetching:!1,refetch:i.value.refetch})}).finally(()=>{s(void 0)})});e=Array.isArray(e)?e:[e];let a=!1;for(let t of e)t.subscribe(async()=>{sQ()||(a?await s():sH(i,()=>{let e=setTimeout(async()=>{a||(await s(),a=!0)},0);return()=>{i.off(),t.off(),clearTimeout(e)}}))});return i})(n=sG(!1),"/get-session",p,{method:"GET"}),sH(i,()=>{let t=function(e){let{sessionAtom:t,sessionSignal:r,$fetch:n,options:i={}}=e,s=i.sessionOptions?.refetchInterval??0,a=i.sessionOptions?.refetchOnWindowFocus??!0,o=i.sessionOptions?.refetchWhenOffline??!1,l={lastSync:0,lastSessionRequest:0,cachedSession:void 0},u=e=>{if(!(o||s6().isOnline))return;if(e?.event==="storage"){l.lastSync=s8(),r.set(!r.get());return}let i=t.get();if(e?.event==="poll"){l.lastSessionRequest=s8(),n("/get-session").then(e=>{e.error?t.set({...i,data:null,error:e.error}):t.set({...i,data:e.data,error:null}),l.lastSync=s8(),r.set(!r.get())}).catch(()=>{});return}if(e?.event==="visibilitychange"){if(s8()-l.lastSessionRequest<5)return;l.lastSessionRequest=s8()}(i?.data===null||i?.data===void 0||e?.event==="visibilitychange")&&(l.lastSync=s8(),r.set(!r.get()))};return{init:()=>{s&&s>0&&(l.pollInterval=setInterval(()=>{t.get()?.data&&u({event:"poll"})},1e3*s)),l.unsubscribeBroadcast=s0().subscribe(()=>{u({event:"storage"})}),a&&(l.unsubscribeFocus=s3().subscribe(()=>{u({event:"visibilitychange"})})),l.unsubscribeOnline=s6().subscribe(e=>{e&&u({event:"visibilitychange"})}),s0().setup(),s3().setup(),s6().setup()},cleanup:()=>{l.pollInterval&&(clearInterval(l.pollInterval),l.pollInterval=void 0),l.unsubscribeBroadcast&&(l.unsubscribeBroadcast(),l.unsubscribeBroadcast=void 0),l.unsubscribeFocus&&(l.unsubscribeFocus(),l.unsubscribeFocus=void 0),l.unsubscribeOnline&&(l.unsubscribeOnline(),l.unsubscribeOnline=void 0),l.lastSync=0,l.lastSessionRequest=0,l.cachedSession=void 0},triggerRefetch:u,broadcastSessionUpdate:e=>{s0().post({event:"session",data:{trigger:e},clientId:Math.random().toString(36).substring(7)})}}}({sessionAtom:i,sessionSignal:n,$fetch:p,options:e});return t.init(),()=>{t.cleanup()}}),{session:i,$sessionSignal:n}),y=e?.plugins||[],v={},b={$sessionSignal:m,session:g},x={"/sign-out":"POST","/revoke-sessions":"POST","/revoke-other-sessions":"POST","/delete-user":"POST"},w=[{signal:"$sessionSignal",matcher:e=>"/sign-out"===e||"/update-user"===e||"/sign-up/email"===e||"/sign-in/email"===e||"/delete-user"===e||"/verify-email"===e||"/revoke-sessions"===e||"/revoke-session"===e||"/change-email"===e}];for(let e of y)e.getAtoms&&Object.assign(b,e.getAtoms?.(p)),e.pathMethods&&Object.assign(x,e.pathMethods),e.atomListeners&&w.push(...e.atomListeners);let _={notify:e=>{b[e].set(!b[e].get())},listen:(e,t)=>{b[e].subscribe(t)},atoms:b};for(let t of y)t.getActions&&(v=ae(t.getActions?.(p,_,e)??{},v));return{get baseURL(){return a},pluginsActions:v,pluginsAtoms:b,pluginPathMethods:x,atomListeners:w,$fetch:p,$store:_}})(e),l={};for(let[e,t]of Object.entries(i))l[function(e){return`use${e.charAt(0).toUpperCase()+e.slice(1)}`}(e)]=()=>(function(e,t={}){let r=(0,M.useRef)(e.get()),{keys:n,deps:i=[e,n]}=t,s=(0,M.useCallback)(t=>{let i=e=>{r.current!==e&&(r.current=e,t())};if(i(e.value),n?.length){let t;return t=new Set(n).add(void 0),e.listen((e,r,n)=>{t.has(n)&&i(e,r,n)})}return e.listen(i)},i),a=()=>r.current;return(0,M.useSyncExternalStore)(s,a,a)})(t);return t={...n,...l,$fetch:s,$store:a},function e(n=[]){return new Proxy(function(){},{get(r,i){var s;if("string"!=typeof i||"then"===i||"catch"===i||"finally"===i)return;let a=[...n,i],o=t;for(let e of a)if(o&&"object"==typeof o&&e in o)o=o[e];else{o=void 0;break}return"function"==typeof o?o:"object"==typeof(s=o)&&null!==s&&"get"in s&&"function"==typeof s.get&&"lc"in s&&"number"==typeof s.lc?o:e(a)},apply:async(e,t,a)=>{let l="/"+n.map(e=>e.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)).join("/"),u=a[0]||{},c=a[1]||{},{query:d,fetchOptions:h,...f}=u,p={...c,...h},m=function(e,t,r){let n=t[e],{fetchOptions:i,query:s,...a}=r||{};return n||(i?.method?i.method:a&&Object.keys(a).length>0?"POST":"GET")}(l,r,u);return await s(l,{...p,body:"GET"===m?void 0:{...f,...p?.body||{}},query:d||p?.query,method:m,async onSuccess(e){if(await p?.onSuccess?.(e),!o||p.disableSignal)return;let t=o.filter(e=>e.matcher(l));if(!t.length)return;let r=new Set;for(let e of t){let t=i[e.signal];if(!t)return;if(r.has(e.signal))continue;r.add(e.signal);let n=t.get();setTimeout(()=>{t.set(!n)},10)}}})}})}()}({baseURL:"https://photovault-mu.vercel.app"});function aN({onSuccess:e}){let[t,r]=(0,M.useState)("welcome"),[n,i]=(0,M.useState)(""),[s,a]=(0,M.useState)(""),[o,l]=(0,M.useState)(""),[u,c]=(0,M.useState)(!1),[d,h]=(0,M.useState)(!1),[f,p]=(0,M.useState)(null),m=async()=>{if(!n||!s)return void p("Bitte E-Mail und Passwort eingeben");h(!0),p(null);try{let t=await aj.email({email:n,password:s});if(t.error)return void p(t.error.message||"Anmeldung fehlgeschlagen");t.data?.user&&e({id:t.data.user.id,email:t.data.user.email,vaultKeyHash:t.data.user.vault_key_hash||null})}catch(e){console.error("Login error:",e),p("Ein Fehler ist aufgetreten. Bitte versuche es erneut.")}finally{h(!1)}},g=async()=>{if(!n||!s||!o)return void p("Bitte alle Felder ausfuellen");if(s.length<8)return void p("Passwort muss mindestens 8 Zeichen haben");h(!0),p(null);try{let t=await aE.email({email:n,password:s,name:o});if(t.error)return void p(t.error.message||"Registrierung fehlgeschlagen");t.data?.user&&e({id:t.data.user.id,email:t.data.user.email,vaultKeyHash:null})}catch(e){console.error("Signup error:",e),p("Ein Fehler ist aufgetreten. Bitte versuche es erneut.")}finally{h(!1)}};return"welcome"===t?(0,D.jsxs)("div",{className:"min-h-screen flex flex-col px-6 pt-16 pb-8 safe-area-inset bg-[#F2F2F7]",children:[(0,D.jsxs)("div",{className:"flex-1 flex flex-col items-center justify-center text-center",children:[(0,D.jsx)("div",{className:"w-24 h-24 rounded-3xl bg-gradient-to-br from-[#007AFF] to-[#5856D6] flex items-center justify-center mb-8 shadow-lg",children:(0,D.jsx)(ez,{name:"shield",size:48,className:"text-white"})}),(0,D.jsx)("h1",{className:"sf-pro-display text-[34px] font-bold leading-tight text-[#1D1D1F] mb-3",children:"PhotoVault"}),(0,D.jsx)("p",{className:"text-[17px] leading-relaxed text-[#6E6E73] max-w-[280px] mb-8",children:"Sichere deine Fotos mit Zero-Knowledge Verschluesselung"}),(0,D.jsxs)("div",{className:"w-full max-w-[320px] space-y-3 mb-12",children:[(0,D.jsx)(aA,{icon:"lock",text:"Ende-zu-Ende verschluesselt"}),(0,D.jsx)(aA,{icon:"smartphone",text:"Multi-Device Sync"}),(0,D.jsx)(aA,{icon:"cloud",text:"Dezentrales IPFS Backup"})]})]}),(0,D.jsxs)("div",{className:"space-y-3",children:[(0,D.jsxs)("button",{onClick:()=>r("signup"),className:"w-full h-[54px] bg-[#007AFF] text-white text-[17px] font-semibold rounded-2xl ios-tap-target flex items-center justify-center gap-2 shadow-lg shadow-[#007AFF]/25",children:["Konto erstellen",(0,D.jsx)(eU,{className:"w-5 h-5"})]}),(0,D.jsx)("button",{onClick:()=>r("login"),className:"w-full h-[50px] text-[#007AFF] text-[17px] font-medium ios-tap-target",children:"Ich habe bereits ein Konto"})]})]}):(0,D.jsxs)("div",{className:"min-h-screen flex flex-col px-6 pt-12 pb-8 safe-area-inset bg-[#F2F2F7]",children:[(0,D.jsx)("button",{onClick:()=>r("welcome"),className:"self-start text-[#007AFF] text-[17px] mb-8 ios-tap-target",children:"Zurueck"}),(0,D.jsxs)("div",{className:"flex-1",children:[(0,D.jsx)("h1",{className:"sf-pro-display text-[28px] font-bold text-[#1D1D1F] mb-2",children:"login"===t?"Willkommen zurueck":"Konto erstellen"}),(0,D.jsx)("p",{className:"text-[15px] text-[#6E6E73] mb-8",children:"login"===t?"Melde dich an, um auf deinen Vault zuzugreifen":"Erstelle ein Konto, um deinen Vault zu sichern"}),(0,D.jsxs)("div",{className:"space-y-4",children:["signup"===t&&(0,D.jsxs)("div",{className:"relative",children:[(0,D.jsx)("input",{type:"text",value:o,onChange:e=>l(e.target.value),placeholder:"Name",className:"w-full h-[54px] bg-white rounded-xl px-4 pl-12 text-[17px] text-[#1D1D1F] placeholder:text-[#8E8E93] border border-[#E5E5EA] focus:border-[#007AFF] focus:outline-none transition-colors"}),(0,D.jsx)(eL,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-[#8E8E93]"})]}),(0,D.jsxs)("div",{className:"relative",children:[(0,D.jsx)("input",{type:"email",value:n,onChange:e=>i(e.target.value),placeholder:"E-Mail",autoComplete:"email",className:"w-full h-[54px] bg-white rounded-xl px-4 pl-12 text-[17px] text-[#1D1D1F] placeholder:text-[#8E8E93] border border-[#E5E5EA] focus:border-[#007AFF] focus:outline-none transition-colors"}),(0,D.jsx)(eF,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-[#8E8E93]"})]}),(0,D.jsxs)("div",{className:"relative",children:[(0,D.jsx)("input",{type:u?"text":"password",value:s,onChange:e=>a(e.target.value),placeholder:"Passwort",autoComplete:"login"===t?"current-password":"new-password",className:"w-full h-[54px] bg-white rounded-xl px-4 pl-12 pr-12 text-[17px] text-[#1D1D1F] placeholder:text-[#8E8E93] border border-[#E5E5EA] focus:border-[#007AFF] focus:outline-none transition-colors"}),(0,D.jsx)(eI,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-[#8E8E93]"}),(0,D.jsx)("button",{type:"button",onClick:()=>c(!u),className:"absolute right-4 top-1/2 -translate-y-1/2 text-[#8E8E93] ios-tap-target",children:u?(0,D.jsx)(eM,{className:"w-5 h-5"}):(0,D.jsx)(eD,{className:"w-5 h-5"})})]}),"signup"===t&&(0,D.jsx)("p",{className:"text-[13px] text-[#8E8E93]",children:"Mindestens 8 Zeichen"}),f&&(0,D.jsx)("div",{className:"bg-[#FF3B30]/10 rounded-xl p-3",children:(0,D.jsx)("p",{className:"text-[14px] text-[#FF3B30] text-center",children:f})})]})]}),(0,D.jsxs)("div",{className:"space-y-3",children:[(0,D.jsx)("button",{onClick:"login"===t?m:g,disabled:d,className:"w-full h-[54px] bg-[#007AFF] text-white text-[17px] font-semibold rounded-2xl ios-tap-target disabled:opacity-50 flex items-center justify-center",children:d?(0,D.jsx)("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}):"login"===t?"Anmelden":"Registrieren"}),(0,D.jsx)("button",{onClick:()=>r("login"===t?"signup":"login"),className:"w-full h-[44px] text-[#007AFF] text-[15px] ios-tap-target",children:"login"===t?"Noch kein Konto? Registrieren":"Bereits ein Konto? Anmelden"})]})]})}function aA({icon:e,text:t}){return(0,D.jsxs)("div",{className:"flex items-center gap-3 bg-white/80 backdrop-blur-sm rounded-xl p-3",children:[(0,D.jsx)("div",{className:"w-8 h-8 rounded-full bg-[#007AFF]/10 flex items-center justify-center",children:(0,D.jsx)(ez,{name:e,size:18,className:"text-[#007AFF]"})}),(0,D.jsx)("span",{className:"text-[15px] text-[#1D1D1F]",children:t})]})}let aP=K("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);var aC=e.i(3809);function az({userEmail:e,expectedKeyHash:t,onUnlock:r,onCreateNewVault:n,onLogout:i}){let[s,a]=(0,M.useState)(""),[o,l]=(0,M.useState)(!1),[u,c]=(0,M.useState)(null),d=async()=>{if(!s.trim())return void c("Bitte gib deine Recovery-Phrase ein");l(!0),c(null);try{let e=s.trim().replace(/[\s\n]+/g,"-").replace(/-+/g,"-"),n=(0,aC.recoveryPhraseToKey)(e);if(!n||32!==n.length){c("Ungueltige Recovery-Phrase"),l(!1);return}let i=await (0,aC.getUserKeyHash)(n);if(t&&i!==t){c("Diese Recovery-Phrase gehoert nicht zu diesem Konto. Bitte ueberpruefe deine Eingabe."),l(!1);return}(0,aC.saveKeyToStorage)(n),r(n,i)}catch(e){console.error("Unlock error:",e),c("Ungueltige Recovery-Phrase. Bitte ueberpruefe deine Eingabe.")}finally{l(!1)}};return(0,D.jsxs)("div",{className:"min-h-screen flex flex-col px-6 pt-12 pb-8 safe-area-inset bg-[#F2F2F7]",children:[(0,D.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,D.jsxs)("div",{className:"text-[13px] text-[#6E6E73]",children:["Angemeldet als",(0,D.jsx)("br",{}),(0,D.jsx)("span",{className:"text-[#1D1D1F] font-medium",children:e})]}),(0,D.jsx)("button",{onClick:i,className:"text-[#FF3B30] text-[15px] ios-tap-target",children:"Abmelden"})]}),(0,D.jsxs)("div",{className:"flex-1 flex flex-col",children:[(0,D.jsxs)("div",{className:"flex flex-col items-center text-center mb-8",children:[(0,D.jsx)("div",{className:"w-20 h-20 rounded-full bg-[#007AFF]/10 flex items-center justify-center mb-6",children:(0,D.jsx)(ez,{name:"lock",size:40})}),(0,D.jsx)("h1",{className:"sf-pro-display text-[28px] font-bold text-[#1D1D1F] mb-2",children:"Vault entsperren"}),(0,D.jsx)("p",{className:"text-[15px] text-[#6E6E73] max-w-[300px]",children:t?"Gib deine Recovery-Phrase ein, um auf deine verschluesselten Fotos zuzugreifen":"Du hast noch keinen Vault. Erstelle einen neuen oder stelle einen bestehenden wieder her."})]}),(0,D.jsxs)("div",{className:"mb-6",children:[(0,D.jsx)("label",{className:"text-[13px] text-[#6E6E73] mb-2 block",children:"Recovery-Phrase (12 Woerter)"}),(0,D.jsx)("textarea",{value:s,onChange:e=>{a(e.target.value),c(null)},placeholder:"abc123XY-def456AB-ghi789CD-...",className:"w-full h-[120px] bg-white rounded-xl p-4 text-[15px] text-[#1D1D1F] font-mono resize-none border border-[#E5E5EA] focus:border-[#007AFF] focus:outline-none transition-colors"}),(0,D.jsx)("p",{className:"text-[12px] text-[#8E8E93] mt-2",children:"Mit Bindestrichen oder Leerzeichen getrennt"})]}),u&&(0,D.jsx)("div",{className:"bg-[#FF3B30]/10 rounded-xl p-3 mb-6",children:(0,D.jsx)("p",{className:"text-[14px] text-[#FF3B30] text-center",children:u})}),(0,D.jsx)("div",{className:"bg-[#007AFF]/5 rounded-xl p-4 mb-6",children:(0,D.jsxs)("div",{className:"flex items-start gap-3",children:[(0,D.jsx)(aP,{className:"w-5 h-5 text-[#007AFF] mt-0.5 flex-shrink-0"}),(0,D.jsxs)("div",{children:[(0,D.jsx)("p",{className:"text-[13px] text-[#1D1D1F] font-medium mb-1",children:"Warum brauche ich die Phrase?"}),(0,D.jsx)("p",{className:"text-[12px] text-[#6E6E73]",children:"Deine Fotos sind lokal verschluesselt. Nur mit der Recovery-Phrase kannst du sie entschluesseln. Wir speichern sie niemals."})]})]})})]}),(0,D.jsxs)("div",{className:"space-y-3",children:[(0,D.jsx)("button",{onClick:d,disabled:o||!s.trim(),className:"w-full h-[54px] bg-[#007AFF] text-white text-[17px] font-semibold rounded-2xl ios-tap-target disabled:opacity-50 flex items-center justify-center",children:o?(0,D.jsx)("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}):"Vault entsperren"}),!t&&(0,D.jsx)("button",{onClick:n,className:"w-full h-[50px] text-[#007AFF] text-[17px] ios-tap-target",children:"Neuen Vault erstellen"})]})]})}let aR=K("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),a$=K("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),aF=K("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);function aI(){let[e,t]=(0,M.useState)(null),[r,n]=(0,M.useState)(!1),[i,s]=(0,M.useState)(null),[a,o]=(0,M.useState)(!1),[l,u]=(0,M.useState)(null);(0,M.useEffect)(()=>{(async()=>{let e=(0,aC.loadKeyFromStorage)();e&&(t(e),s((0,aC.keyToRecoveryPhrase)(e)),u(await (0,aC.getUserKeyHash)(e))),n(!0)})()},[]);let c=(0,M.useCallback)(()=>new Promise(e=>{o(!0),setTimeout(async()=>{let r=(0,aC.generateKeyPair)().secretKey;t(r),(0,aC.saveKeyToStorage)(r);let n=(0,aC.keyToRecoveryPhrase)(r);s(n),u(await (0,aC.getUserKeyHash)(r)),o(!1),e(n)},1500)}),[]);return{secretKey:e,isInitialized:r,hasKey:!!e,recoveryPhrase:i,userKeyHash:l,isGeneratingKey:a,generateNewKey:c,restoreFromPhrase:(0,M.useCallback)(e=>{try{let r=(0,aC.recoveryPhraseToKey)(e);return t(r),(0,aC.saveKeyToStorage)(r),s(e),!0}catch{return!1}},[]),clearKey:(0,M.useCallback)(()=>{t(null),s(null),(0,aC.clearKeyFromStorage)()},[])}}function aD({userId:e,onComplete:t,onBack:r}){let[n,i]=(0,M.useState)("intro"),[s,a]=(0,M.useState)(!1),[o,l]=(0,M.useState)(!1),{isGeneratingKey:u,generateNewKey:c,recoveryPhrase:d,userKeyHash:h}=aI(),f=async()=>{i("generating");try{await c(),i("phrase")}catch(e){console.error("Failed to generate key:",e),i("intro")}},p=async()=>{d&&(await navigator.clipboard.writeText(d),l(!0),setTimeout(()=>l(!1),2e3))},m=d?.split("-").slice(0,12)||[];return"generating"===n||u?(0,D.jsx)(e$,{}):"intro"===n?(0,D.jsxs)("div",{className:"min-h-screen flex flex-col px-6 pt-12 pb-8 safe-area-inset bg-[#F2F2F7]",children:[(0,D.jsx)("button",{onClick:r,className:"self-start text-[#007AFF] text-[17px] mb-8 ios-tap-target",children:"Zurueck"}),(0,D.jsxs)("div",{className:"flex-1 flex flex-col items-center justify-center text-center",children:[(0,D.jsx)("div",{className:"w-20 h-20 rounded-full bg-[#007AFF]/10 flex items-center justify-center mb-6",children:(0,D.jsx)(ez,{name:"key",size:40})}),(0,D.jsx)("h1",{className:"sf-pro-display text-[28px] font-bold text-[#1D1D1F] mb-3",children:"Erstelle deinen Vault"}),(0,D.jsx)("p",{className:"text-[17px] text-[#6E6E73] max-w-[300px] mb-8",children:"Dein persoenlicher Verschluesselungsschluessel schuetzt alle deine Fotos"}),(0,D.jsxs)("div",{className:"w-full max-w-[320px] space-y-3 mb-8",children:[(0,D.jsxs)("div",{className:"bg-white rounded-xl p-4 flex items-start gap-3",children:[(0,D.jsx)("div",{className:"w-8 h-8 rounded-full bg-[#30D158]/10 flex items-center justify-center flex-shrink-0",children:(0,D.jsx)(aF,{className:"w-5 h-5 text-[#30D158]"})}),(0,D.jsxs)("div",{className:"text-left",children:[(0,D.jsx)("p",{className:"text-[15px] text-[#1D1D1F] font-medium",children:"Zero-Knowledge"}),(0,D.jsx)("p",{className:"text-[13px] text-[#6E6E73]",children:"Nur du kannst deine Fotos entschluesseln"})]})]}),(0,D.jsxs)("div",{className:"bg-white rounded-xl p-4 flex items-start gap-3",children:[(0,D.jsx)("div",{className:"w-8 h-8 rounded-full bg-[#30D158]/10 flex items-center justify-center flex-shrink-0",children:(0,D.jsx)(aF,{className:"w-5 h-5 text-[#30D158]"})}),(0,D.jsxs)("div",{className:"text-left",children:[(0,D.jsx)("p",{className:"text-[15px] text-[#1D1D1F] font-medium",children:"Recovery-Phrase"}),(0,D.jsx)("p",{className:"text-[13px] text-[#6E6E73]",children:"12 Woerter zum Wiederherstellen auf neuen Geraeten"})]})]}),(0,D.jsxs)("div",{className:"bg-white rounded-xl p-4 flex items-start gap-3",children:[(0,D.jsx)("div",{className:"w-8 h-8 rounded-full bg-[#30D158]/10 flex items-center justify-center flex-shrink-0",children:(0,D.jsx)(aF,{className:"w-5 h-5 text-[#30D158]"})}),(0,D.jsxs)("div",{className:"text-left",children:[(0,D.jsx)("p",{className:"text-[15px] text-[#1D1D1F] font-medium",children:"Multi-Device"}),(0,D.jsx)("p",{className:"text-[13px] text-[#6E6E73]",children:"Synchronisiere bis zu 3 Geraete"})]})]})]})]}),(0,D.jsx)("button",{onClick:f,className:"w-full h-[54px] bg-[#007AFF] text-white text-[17px] font-semibold rounded-2xl ios-tap-target shadow-lg shadow-[#007AFF]/25",children:"Vault erstellen"})]}):"phrase"===n?(0,D.jsxs)("div",{className:"min-h-screen flex flex-col px-6 pt-12 pb-8 safe-area-inset bg-[#F2F2F7]",children:[(0,D.jsxs)("div",{className:"flex-1",children:[(0,D.jsxs)("div",{className:"text-center mb-6",children:[(0,D.jsx)("h1",{className:"sf-pro-display text-[28px] font-bold text-[#1D1D1F] mb-2",children:"Deine Recovery-Phrase"}),(0,D.jsx)("p",{className:"text-[15px] text-[#6E6E73]",children:"Notiere diese Woerter sicher. Du brauchst sie zur Wiederherstellung."})]}),(0,D.jsx)("div",{className:"grid grid-cols-3 gap-2 mb-4",children:m.map((e,t)=>(0,D.jsxs)("div",{className:"bg-white rounded-lg p-3 text-center border border-[#E5E5EA]",children:[(0,D.jsx)("span",{className:"text-[11px] text-[#8E8E93] block mb-0.5",children:t+1}),(0,D.jsx)("span",{className:"text-[14px] text-[#1D1D1F] font-mono break-all",children:e})]},t))}),(0,D.jsx)("button",{onClick:p,className:"w-full flex items-center justify-center gap-2 py-3 text-[#007AFF] text-[15px] ios-tap-target mb-4",children:o?(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(aR,{className:"w-5 h-5"}),"Kopiert!"]}):(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(a$,{className:"w-5 h-5"}),"Phrase kopieren"]})}),(0,D.jsx)("div",{className:"bg-[#FF3B30]/10 rounded-xl p-4 mb-6",children:(0,D.jsx)("p",{className:"text-[13px] text-[#FF3B30] text-center",children:"Teile diese Woerter niemals mit anderen. Wer sie hat, kann auf deine Fotos zugreifen."})}),(0,D.jsxs)("button",{onClick:()=>a(!s),className:"w-full flex items-center gap-3 p-4 bg-white rounded-xl ios-tap-target",children:[(0,D.jsx)("div",{className:`w-6 h-6 rounded-md border-2 flex items-center justify-center transition-colors ${s?"bg-[#007AFF] border-[#007AFF]":"border-[#C7C7CC]"}`,children:s&&(0,D.jsx)(aR,{className:"w-4 h-4 text-white"})}),(0,D.jsx)("span",{className:"text-[17px] text-[#1D1D1F]",children:"Ich habe die Woerter sicher gespeichert"})]})]}),(0,D.jsx)("button",{onClick:()=>{h&&t(h)},disabled:!s,className:`w-full h-[54px] text-[17px] font-semibold rounded-2xl ios-tap-target transition-colors ${s?"bg-[#007AFF] text-white shadow-lg shadow-[#007AFF]/25":"bg-[#E5E5EA] text-[#8E8E93]"}`,children:"Weiter"})]}):null}let aM=K("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),aU=K("Link2",[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]]),aL=K("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);var aB=e.i(75555),aK=e.i(40143),aZ=e.i(86491),aq=e.i(15823),aV=e.i(93803),aJ=e.i(19273),aW=e.i(80166),aG=class extends aq.Subscribable{constructor(e,t){super(),this.options=t,this.#e=e,this.#t=null,this.#r=(0,aV.pendingThenable)(),this.bindMethods(),this.setOptions(t)}#e;#n=void 0;#i=void 0;#s=void 0;#a;#o;#r;#t;#l;#u;#c;#d;#h;#f;#p=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){1===this.listeners.size&&(this.#n.addObserver(this),aH(this.#n,this.options)?this.#m():this.updateResult(),this.#g())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return aQ(this.#n,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return aQ(this.#n,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#y(),this.#v(),this.#n.removeObserver(this)}setOptions(e){let t=this.options,r=this.#n;if(this.options=this.#e.defaultQueryOptions(e),void 0!==this.options.enabled&&"boolean"!=typeof this.options.enabled&&"function"!=typeof this.options.enabled&&"boolean"!=typeof(0,aJ.resolveEnabled)(this.options.enabled,this.#n))throw Error("Expected enabled to be a boolean or a callback that returns a boolean");this.#b(),this.#n.setOptions(this.options),t._defaulted&&!(0,aJ.shallowEqualObjects)(this.options,t)&&this.#e.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#n,observer:this});let n=this.hasListeners();n&&aY(this.#n,r,this.options,t)&&this.#m(),this.updateResult(),n&&(this.#n!==r||(0,aJ.resolveEnabled)(this.options.enabled,this.#n)!==(0,aJ.resolveEnabled)(t.enabled,this.#n)||(0,aJ.resolveStaleTime)(this.options.staleTime,this.#n)!==(0,aJ.resolveStaleTime)(t.staleTime,this.#n))&&this.#x();let i=this.#w();n&&(this.#n!==r||(0,aJ.resolveEnabled)(this.options.enabled,this.#n)!==(0,aJ.resolveEnabled)(t.enabled,this.#n)||i!==this.#f)&&this.#_(i)}getOptimisticResult(e){var t,r;let n=this.#e.getQueryCache().build(this.#e,e),i=this.createResult(n,e);return t=this,r=i,(0,aJ.shallowEqualObjects)(t.getCurrentResult(),r)||(this.#s=i,this.#o=this.options,this.#a=this.#n.state),i}getCurrentResult(){return this.#s}trackResult(e,t){return new Proxy(e,{get:(e,r)=>(this.trackProp(r),t?.(r),"promise"===r&&(this.trackProp("data"),this.options.experimental_prefetchInRender||"pending"!==this.#r.status||this.#r.reject(Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(e,r))})}trackProp(e){this.#p.add(e)}getCurrentQuery(){return this.#n}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){let t=this.#e.defaultQueryOptions(e),r=this.#e.getQueryCache().build(this.#e,t);return r.fetch().then(()=>this.createResult(r,t))}fetch(e){return this.#m({...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),this.#s))}#m(e){this.#b();let t=this.#n.fetch(this.options,e);return e?.throwOnError||(t=t.catch(aJ.noop)),t}#x(){this.#y();let e=(0,aJ.resolveStaleTime)(this.options.staleTime,this.#n);if(aJ.isServer||this.#s.isStale||!(0,aJ.isValidTimeout)(e))return;let t=(0,aJ.timeUntilStale)(this.#s.dataUpdatedAt,e);this.#d=aW.timeoutManager.setTimeout(()=>{this.#s.isStale||this.updateResult()},t+1)}#w(){return("function"==typeof this.options.refetchInterval?this.options.refetchInterval(this.#n):this.options.refetchInterval)??!1}#_(e){this.#v(),this.#f=e,!aJ.isServer&&!1!==(0,aJ.resolveEnabled)(this.options.enabled,this.#n)&&(0,aJ.isValidTimeout)(this.#f)&&0!==this.#f&&(this.#h=aW.timeoutManager.setInterval(()=>{(this.options.refetchIntervalInBackground||aB.focusManager.isFocused())&&this.#m()},this.#f))}#g(){this.#x(),this.#_(this.#w())}#y(){this.#d&&(aW.timeoutManager.clearTimeout(this.#d),this.#d=void 0)}#v(){this.#h&&(aW.timeoutManager.clearInterval(this.#h),this.#h=void 0)}createResult(e,t){let r,n=this.#n,i=this.options,s=this.#s,a=this.#a,o=this.#o,l=e!==n?e.state:this.#i,{state:u}=e,c={...u},d=!1;if(t._optimisticResults){let r=this.hasListeners(),s=!r&&aH(e,t),a=r&&aY(e,n,t,i);(s||a)&&(c={...c,...(0,aZ.fetchState)(u.data,e.options)}),"isRestoring"===t._optimisticResults&&(c.fetchStatus="idle")}let{error:h,errorUpdatedAt:f,status:p}=c;r=c.data;let m=!1;if(void 0!==t.placeholderData&&void 0===r&&"pending"===p){let e;s?.isPlaceholderData&&t.placeholderData===o?.placeholderData?(e=s.data,m=!0):e="function"==typeof t.placeholderData?t.placeholderData(this.#c?.state.data,this.#c):t.placeholderData,void 0!==e&&(p="success",r=(0,aJ.replaceData)(s?.data,e,t),d=!0)}if(t.select&&void 0!==r&&!m)if(s&&r===a?.data&&t.select===this.#l)r=this.#u;else try{this.#l=t.select,r=t.select(r),r=(0,aJ.replaceData)(s?.data,r,t),this.#u=r,this.#t=null}catch(e){this.#t=e}this.#t&&(h=this.#t,r=this.#u,f=Date.now(),p="error");let g="fetching"===c.fetchStatus,y="pending"===p,v="error"===p,b=y&&g,x=void 0!==r,w={status:p,fetchStatus:c.fetchStatus,isPending:y,isSuccess:"success"===p,isError:v,isInitialLoading:b,isLoading:b,data:r,dataUpdatedAt:c.dataUpdatedAt,error:h,errorUpdatedAt:f,failureCount:c.fetchFailureCount,failureReason:c.fetchFailureReason,errorUpdateCount:c.errorUpdateCount,isFetched:c.dataUpdateCount>0||c.errorUpdateCount>0,isFetchedAfterMount:c.dataUpdateCount>l.dataUpdateCount||c.errorUpdateCount>l.errorUpdateCount,isFetching:g,isRefetching:g&&!y,isLoadingError:v&&!x,isPaused:"paused"===c.fetchStatus,isPlaceholderData:d,isRefetchError:v&&x,isStale:aX(e,t),refetch:this.refetch,promise:this.#r,isEnabled:!1!==(0,aJ.resolveEnabled)(t.enabled,e)};if(this.options.experimental_prefetchInRender){let t=void 0!==w.data,r="error"===w.status&&!t,i=e=>{r?e.reject(w.error):t&&e.resolve(w.data)},s=()=>{i(this.#r=w.promise=(0,aV.pendingThenable)())},a=this.#r;switch(a.status){case"pending":e.queryHash===n.queryHash&&i(a);break;case"fulfilled":(r||w.data!==a.value)&&s();break;case"rejected":r&&w.error===a.reason||s()}}return w}updateResult(){let e=this.#s,t=this.createResult(this.#n,this.options);if(this.#a=this.#n.state,this.#o=this.options,void 0!==this.#a.data&&(this.#c=this.#n),(0,aJ.shallowEqualObjects)(t,e))return;this.#s=t;let r=()=>{if(!e)return!0;let{notifyOnChangeProps:t}=this.options,r="function"==typeof t?t():t;if("all"===r||!r&&!this.#p.size)return!0;let n=new Set(r??this.#p);return this.options.throwOnError&&n.add("error"),Object.keys(this.#s).some(t=>this.#s[t]!==e[t]&&n.has(t))};this.#k({listeners:r()})}#b(){let e=this.#e.getQueryCache().build(this.#e,this.options);if(e===this.#n)return;let t=this.#n;this.#n=e,this.#i=e.state,this.hasListeners()&&(t?.removeObserver(this),e.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#g()}#k(e){aK.notifyManager.batch(()=>{e.listeners&&this.listeners.forEach(e=>{e(this.#s)}),this.#e.getQueryCache().notify({query:this.#n,type:"observerResultsUpdated"})})}};function aH(e,t){return!1!==(0,aJ.resolveEnabled)(t.enabled,e)&&void 0===e.state.data&&("error"!==e.state.status||!1!==t.retryOnMount)||void 0!==e.state.data&&aQ(e,t,t.refetchOnMount)}function aQ(e,t,r){if(!1!==(0,aJ.resolveEnabled)(t.enabled,e)&&"static"!==(0,aJ.resolveStaleTime)(t.staleTime,e)){let n="function"==typeof r?r(e):r;return"always"===n||!1!==n&&aX(e,t)}return!1}function aY(e,t,r,n){return(e!==t||!1===(0,aJ.resolveEnabled)(n.enabled,e))&&(!r.suspense||"error"!==e.state.status)&&aX(e,r)}function aX(e,t){return!1!==(0,aJ.resolveEnabled)(t.enabled,e)&&e.isStaleByTime((0,aJ.resolveStaleTime)(t.staleTime,e))}var a0=e.i(12598),a1=M.createContext((i=!1,{clearReset:()=>{i=!1},reset:()=>{i=!0},isReset:()=>i})),a2=M.createContext(!1);a2.Provider;var a3=(e,t,r)=>t.fetchOptimistic(e).catch(()=>{r.clearReset()});function a4(e,t){return function(e,t,r){let n,i=M.useContext(a2),s=M.useContext(a1),a=(0,a0.useQueryClient)(r),o=a.defaultQueryOptions(e);a.getDefaultOptions().queries?._experimental_beforeQuery?.(o);let l=a.getQueryCache().get(o.queryHash);if(o._optimisticResults=i?"isRestoring":"optimistic",o.suspense){let e=e=>"static"===e?e:Math.max(e??1e3,1e3),t=o.staleTime;o.staleTime="function"==typeof t?(...r)=>e(t(...r)):e(t),"number"==typeof o.gcTime&&(o.gcTime=Math.max(o.gcTime,1e3))}n=l?.state.error&&"function"==typeof o.throwOnError?(0,aJ.shouldThrowError)(o.throwOnError,[l.state.error,l]):o.throwOnError,(o.suspense||o.experimental_prefetchInRender||n)&&!s.isReset()&&(o.retryOnMount=!1),M.useEffect(()=>{s.clearReset()},[s]);let u=!a.getQueryCache().get(o.queryHash),[c]=M.useState(()=>new t(a,o)),d=c.getOptimisticResult(o),h=!i&&!1!==e.subscribed;if(M.useSyncExternalStore(M.useCallback(e=>{let t=h?c.subscribe(aK.notifyManager.batchCalls(e)):aJ.noop;return c.updateResult(),t},[c,h]),()=>c.getCurrentResult(),()=>c.getCurrentResult()),M.useEffect(()=>{c.setOptions(o)},[o,c]),o?.suspense&&d.isPending)throw a3(o,c,s);if((({result:e,errorResetBoundary:t,throwOnError:r,query:n,suspense:i})=>e.isError&&!t.isReset()&&!e.isFetching&&n&&(i&&void 0===e.data||(0,aJ.shouldThrowError)(r,[e.error,n])))({result:d,errorResetBoundary:s,throwOnError:o.throwOnError,query:l,suspense:o.suspense}))throw d.error;if(a.getDefaultOptions().queries?._experimental_afterQuery?.(o,d),o.experimental_prefetchInRender&&!aJ.isServer&&d.isLoading&&d.isFetching&&!i){let e=u?a3(o,c,s):l?.promise;e?.catch(aJ.noop).finally(()=>{c.updateResult()})}return o.notifyOnChangeProps?d:c.trackResult(d)}(e,aG,t)}var a5=e.i(14272),a6=aq,a8=class extends a6.Subscribable{#e;#s=void 0;#j;#E;constructor(e,t){super(),this.#e=e,this.setOptions(t),this.bindMethods(),this.#S()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){let t=this.options;this.options=this.#e.defaultMutationOptions(e),(0,aJ.shallowEqualObjects)(this.options,t)||this.#e.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#j,observer:this}),t?.mutationKey&&this.options.mutationKey&&(0,aJ.hashKey)(t.mutationKey)!==(0,aJ.hashKey)(this.options.mutationKey)?this.reset():this.#j?.state.status==="pending"&&this.#j.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#j?.removeObserver(this)}onMutationUpdate(e){this.#S(),this.#k(e)}getCurrentResult(){return this.#s}reset(){this.#j?.removeObserver(this),this.#j=void 0,this.#S(),this.#k()}mutate(e,t){return this.#E=t,this.#j?.removeObserver(this),this.#j=this.#e.getMutationCache().build(this.#e,this.options),this.#j.addObserver(this),this.#j.execute(e)}#S(){let e=this.#j?.state??(0,a5.getDefaultState)();this.#s={...e,isPending:"pending"===e.status,isSuccess:"success"===e.status,isError:"error"===e.status,isIdle:"idle"===e.status,mutate:this.mutate,reset:this.reset}}#k(e){aK.notifyManager.batch(()=>{if(this.#E&&this.hasListeners()){let t=this.#s.variables,r=this.#s.context,n={client:this.#e,meta:this.options.meta,mutationKey:this.options.mutationKey};if(e?.type==="success"){try{this.#E.onSuccess?.(e.data,t,r,n)}catch(e){Promise.reject(e)}try{this.#E.onSettled?.(e.data,null,t,r,n)}catch(e){Promise.reject(e)}}else if(e?.type==="error"){try{this.#E.onError?.(e.error,t,r,n)}catch(e){Promise.reject(e)}try{this.#E.onSettled?.(void 0,e.error,t,r,n)}catch(e){Promise.reject(e)}}}this.listeners.forEach(e=>{e(this.#s)})})}};function a7(e,t){let r=(0,a0.useQueryClient)(t),[n]=M.useState(()=>new a8(r,e));M.useEffect(()=>{n.setOptions(e)},[n,e]);let i=M.useSyncExternalStore(M.useCallback(e=>n.subscribe(aK.notifyManager.batchCalls(e)),[n]),()=>n.getCurrentResult(),()=>n.getCurrentResult()),s=M.useCallback((e,t)=>{n.mutate(e,t).catch(aJ.noop)},[n]);if(i.error&&(0,aJ.shouldThrowError)(n.options.throwOnError,[i.error]))throw i.error;return{...i,mutate:s,mutateAsync:i.mutate}}var a9=e.i(93560);let oe=Symbol.for("Dexie"),ot=globalThis[oe]||(globalThis[oe]=a9.default);if(a9.default.semVer!==ot.semVer)throw Error(`Two different versions of Dexie loaded in the same app: ${a9.default.semVer} and ${ot.semVer}`);let{liveQuery:or,mergeRanges:on,rangesOverlap:oi,RangeSet:os,cmp:oa,Entity:oo,PropModification:ol,replacePrefix:ou,add:oc,remove:od,DexieYProvider:oh}=ot,of=ot,op=new class extends of{photos;constructor(){super("PhotoVaultDB"),this.version(1).stores({photos:"++id, cid, uploadedAt"})}};async function om(e){return await op.photos.add(e)}async function og(){return await op.photos.orderBy("uploadedAt").reverse().toArray()}async function oy(e){await op.photos.delete(e)}async function ov(){return await op.photos.count()}class ob extends Error{constructor(e,t="FunctionsError",r){super(e),this.name=t,this.context=r}}class ox extends ob{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class ow extends ob{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class o_ extends ob{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}(d=S||(S={})).Any="any",d.ApNortheast1="ap-northeast-1",d.ApNortheast2="ap-northeast-2",d.ApSouth1="ap-south-1",d.ApSoutheast1="ap-southeast-1",d.ApSoutheast2="ap-southeast-2",d.CaCentral1="ca-central-1",d.EuCentral1="eu-central-1",d.EuWest1="eu-west-1",d.EuWest2="eu-west-2",d.EuWest3="eu-west-3",d.SaEast1="sa-east-1",d.UsEast1="us-east-1",d.UsWest1="us-west-1",d.UsWest2="us-west-2";class ok{constructor(t,{headers:r={},customFetch:n,region:i=S.Any}={}){this.url=t,this.headers=r,this.region=i,this.fetch=(t=>{let r;return r=t||("u"<typeof fetch?(...t)=>e.A(11737).then(({default:e})=>e(...t)):fetch),(...e)=>r(...e)})(n)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var r,n,i,s,a;return n=this,i=void 0,s=void 0,a=function*(){try{let n,{headers:i,method:s,body:a}=t,o={},{region:l}=t;l||(l=this.region),l&&"any"!==l&&(o["x-region"]=l),a&&(i&&!Object.prototype.hasOwnProperty.call(i,"Content-Type")||!i)&&("u">typeof Blob&&a instanceof Blob||a instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",n=a):"string"==typeof a?(o["Content-Type"]="text/plain",n=a):"u">typeof FormData&&a instanceof FormData?n=a:(o["Content-Type"]="application/json",n=JSON.stringify(a)));let u=yield this.fetch(`${this.url}/${e}`,{method:s||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),i),body:n}).catch(e=>{throw new ox(e)}),c=u.headers.get("x-relay-error");if(c&&"true"===c)throw new ow(u);if(!u.ok)throw new o_(u);let d=(null!=(r=u.headers.get("Content-Type"))?r:"text/plain").split(";")[0].trim();return{data:"application/json"===d?yield u.json():"application/octet-stream"===d?yield u.blob():"text/event-stream"===d?u:"multipart/form-data"===d?yield u.formData():yield u.text(),error:null}}catch(e){return{data:null,error:e}}},new(s||(s=Promise))(function(e,t){function r(e){try{l(a.next(e))}catch(e){t(e)}}function o(e){try{l(a.throw(e))}catch(e){t(e)}}function l(t){var n;t.done?e(t.value):((n=t.value)instanceof s?n:new s(function(e){e(n)})).then(r,o)}l((a=a.apply(n,i||[])).next())})}}let{PostgrestClient:oj,PostgrestQueryBuilder:oE,PostgrestFilterBuilder:oS,PostgrestTransformBuilder:oO,PostgrestBuilder:oT,PostgrestError:oN}=e.i(82215).default,oA={"X-Client-Info":"realtime-js/2.11.2"};(h=O||(O={}))[h.connecting=0]="connecting",h[h.open=1]="open",h[h.closing=2]="closing",h[h.closed=3]="closed",(f=T||(T={})).closed="closed",f.errored="errored",f.joined="joined",f.joining="joining",f.leaving="leaving",(p=N||(N={})).close="phx_close",p.error="phx_error",p.join="phx_join",p.reply="phx_reply",p.leave="phx_leave",p.access_token="access_token",(A||(A={})).websocket="websocket",(m=P||(P={})).Connecting="connecting",m.Open="open",m.Closing="closing",m.Closed="closed";class oP{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):"string"==typeof e?t(JSON.parse(e)):t({})}_binaryDecode(e){let t=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,t,r)}_decodeBroadcast(e,t,r){let n=t.getUint8(1),i=t.getUint8(2),s=this.HEADER_LENGTH+2,a=r.decode(e.slice(s,s+n));s+=n;let o=r.decode(e.slice(s,s+i));return s+=i,{ref:null,topic:a,event:o,payload:JSON.parse(r.decode(e.slice(s,e.byteLength)))}}}class oC{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}(g=C||(C={})).abstime="abstime",g.bool="bool",g.date="date",g.daterange="daterange",g.float4="float4",g.float8="float8",g.int2="int2",g.int4="int4",g.int4range="int4range",g.int8="int8",g.int8range="int8range",g.json="json",g.jsonb="jsonb",g.money="money",g.numeric="numeric",g.oid="oid",g.reltime="reltime",g.text="text",g.time="time",g.timestamp="timestamp",g.timestamptz="timestamptz",g.timetz="timetz",g.tsrange="tsrange",g.tstzrange="tstzrange";let oz=(e,t,r={})=>{var n;let i=null!=(n=r.skipTypes)?n:[];return Object.keys(t).reduce((r,n)=>(r[n]=oR(n,e,t,i),r),{})},oR=(e,t,r,n)=>{let i=t.find(t=>t.name===e),s=null==i?void 0:i.type,a=r[e];return s&&!n.includes(s)?o$(s,a):oF(a)},o$=(e,t)=>{if("_"===e.charAt(0))return oU(t,e.slice(1,e.length));switch(e){case C.bool:return oI(t);case C.float4:case C.float8:case C.int2:case C.int4:case C.int8:case C.numeric:case C.oid:return oD(t);case C.json:case C.jsonb:return oM(t);case C.timestamp:return oL(t);case C.abstime:case C.date:case C.daterange:case C.int4range:case C.int8range:case C.money:case C.reltime:case C.text:case C.time:case C.timestamptz:case C.timetz:case C.tsrange:case C.tstzrange:default:return oF(t)}},oF=e=>e,oI=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},oD=e=>{if("string"==typeof e){let t=parseFloat(e);if(!Number.isNaN(t))return t}return e},oM=e=>{if("string"==typeof e)try{return JSON.parse(e)}catch(e){console.log(`JSON parse error: ${e}`)}return e},oU=(e,t)=>{if("string"!=typeof e)return e;let r=e.length-1,n=e[r];if("{"===e[0]&&"}"===n){let n,i=e.slice(1,r);try{n=JSON.parse("["+i+"]")}catch(e){n=i?i.split(","):[]}return n.map(e=>o$(t,e))}return e},oL=e=>"string"==typeof e?e.replace(" ","T"):e,oB=e=>{let t=e;return(t=(t=t.replace(/^ws/i,"http")).replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,"")).replace(/\/+$/,"")};class oK{constructor(e,t,r={},n=1e4){this.channel=e,this.event=t,this.payload=r,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var r;return this._hasReceived(e)&&t(null==(r=this.receivedResp)?void 0:r.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);let e=e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(t=>t.status===e).forEach(e=>e.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}(y=z||(z={})).SYNC="sync",y.JOIN="join",y.LEAVE="leave";class oZ{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(null==t?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},e=>{let{onJoin:t,onLeave:r,onSync:n}=this.caller;this.joinRef=this.channel._joinRef(),this.state=oZ.syncState(this.state,e,t,r),this.pendingDiffs.forEach(e=>{this.state=oZ.syncDiff(this.state,e,t,r)}),this.pendingDiffs=[],n()}),this.channel._on(r.diff,{},e=>{let{onJoin:t,onLeave:r,onSync:n}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(e):(this.state=oZ.syncDiff(this.state,e,t,r),n())}),this.onJoin((e,t,r)=>{this.channel._trigger("presence",{event:"join",key:e,currentPresences:t,newPresences:r})}),this.onLeave((e,t,r)=>{this.channel._trigger("presence",{event:"leave",key:e,currentPresences:t,leftPresences:r})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,r,n){let i=this.cloneDeep(e),s=this.transformState(t),a={},o={};return this.map(i,(e,t)=>{s[e]||(o[e]=t)}),this.map(s,(e,t)=>{let r=i[e];if(r){let n=t.map(e=>e.presence_ref),i=r.map(e=>e.presence_ref),s=t.filter(e=>0>i.indexOf(e.presence_ref)),l=r.filter(e=>0>n.indexOf(e.presence_ref));s.length>0&&(a[e]=s),l.length>0&&(o[e]=l)}else a[e]=t}),this.syncDiff(i,{joins:a,leaves:o},r,n)}static syncDiff(e,t,r,n){let{joins:i,leaves:s}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return r||(r=()=>{}),n||(n=()=>{}),this.map(i,(t,n)=>{var i;let s=null!=(i=e[t])?i:[];if(e[t]=this.cloneDeep(n),s.length>0){let r=e[t].map(e=>e.presence_ref),n=s.filter(e=>0>r.indexOf(e.presence_ref));e[t].unshift(...n)}r(t,s,n)}),this.map(s,(t,r)=>{let i=e[t];if(!i)return;let s=r.map(e=>e.presence_ref);i=i.filter(e=>0>s.indexOf(e.presence_ref)),e[t]=i,n(t,i,r),0===i.length&&delete e[t]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(r=>t(r,e[r]))}static transformState(e){return Object.getOwnPropertyNames(e=this.cloneDeep(e)).reduce((t,r)=>{let n=e[r];return"metas"in n?t[r]=n.metas.map(e=>(e.presence_ref=e.phx_ref,delete e.phx_ref,delete e.phx_ref_prev,e)):t[r]=n,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}(v=R||(R={})).ALL="*",v.INSERT="INSERT",v.UPDATE="UPDATE",v.DELETE="DELETE",(b=$||($={})).BROADCAST="broadcast",b.PRESENCE="presence",b.POSTGRES_CHANGES="postgres_changes",b.SYSTEM="system",(x=F||(F={})).SUBSCRIBED="SUBSCRIBED",x.TIMED_OUT="TIMED_OUT",x.CLOSED="CLOSED",x.CHANNEL_ERROR="CHANNEL_ERROR";class oq{constructor(e,t={config:{}},r){this.topic=e,this.params=t,this.socket=r,this.bindings={},this.state=T.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new oK(this,N.join,this.params,this.timeout),this.rejoinTimer=new oC(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=T.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(e=>e.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=T.closed,this.socket._remove(this)}),this._onError(e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,e),this.state=T.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=T.errored,this.rejoinTimer.scheduleTimeout())}),this._on(N.reply,{},(e,t)=>{this._trigger(this._replyEventName(t),e)}),this.presence=new oZ(this),this.broadcastEndpointURL=oB(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var r,n;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{let{config:{broadcast:i,presence:s,private:a}}=this.params;this._onError(t=>null==e?void 0:e(F.CHANNEL_ERROR,t)),this._onClose(()=>null==e?void 0:e(F.CLOSED));let o={},l={broadcast:i,presence:s,postgres_changes:null!=(n=null==(r=this.bindings.postgres_changes)?void 0:r.map(e=>e.filter))?n:[],private:a};this.socket.accessTokenValue&&(o.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:l},o)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:t})=>{var r;if(this.socket.setAuth(),void 0===t){null==e||e(F.SUBSCRIBED);return}{let n=this.bindings.postgres_changes,i=null!=(r=null==n?void 0:n.length)?r:0,s=[];for(let r=0;r<i;r++){let i=n[r],{filter:{event:a,schema:o,table:l,filter:u}}=i,c=t&&t[r];if(c&&c.event===a&&c.schema===o&&c.table===l&&c.filter===u)s.push(Object.assign(Object.assign({},i),{id:c.id}));else{this.unsubscribe(),null==e||e(F.CHANNEL_ERROR,Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=s,e&&e(F.SUBSCRIBED);return}}).receive("error",t=>{null==e||e(F.CHANNEL_ERROR,Error(JSON.stringify(Object.values(t).join(", ")||"error")))}).receive("timeout",()=>{null==e||e(F.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,r){return this._on(e,t,r)}async send(e,t={}){var r,n;if(this._canPush()||"broadcast"!==e.type)return new Promise(r=>{var n,i,s;let a=this._push(e.type,e,t.timeout||this.timeout);"broadcast"!==e.type||(null==(s=null==(i=null==(n=this.params)?void 0:n.config)?void 0:i.broadcast)?void 0:s.ack)||r("ok"),a.receive("ok",()=>r("ok")),a.receive("error",()=>r("error")),a.receive("timeout",()=>r("timed out"))});{let{event:i,payload:s}=e,a={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:s,private:this.private}]})};try{let e=await this._fetchWithTimeout(this.broadcastEndpointURL,a,null!=(r=t.timeout)?r:this.timeout);return await (null==(n=e.body)?void 0:n.cancel()),e.ok?"ok":"error"}catch(e){if("AbortError"===e.name)return"timed out";return"error"}}}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=T.leaving;let t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(N.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(r=>{let n=new oK(this,N.leave,{},e);n.receive("ok",()=>{t(),r("ok")}).receive("timeout",()=>{t(),r("timed out")}).receive("error",()=>{r("error")}),n.send(),this._canPush()||n.trigger("ok",{})})}async _fetchWithTimeout(e,t,r){let n=new AbortController,i=setTimeout(()=>n.abort(),r),s=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:n.signal}));return clearTimeout(i),s}_push(e,t,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new oK(this,e,t,r);return this._canPush()?n.send():(n.startTimeout(),this.pushBuffer.push(n)),n}_onMessage(e,t,r){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,r){var n,i;let s=e.toLocaleLowerCase(),{close:a,error:o,leave:l,join:u}=N;if(r&&[a,o,l,u].indexOf(s)>=0&&r!==this._joinRef())return;let c=this._onMessage(s,t,r);if(t&&!c)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(s)?null==(n=this.bindings.postgres_changes)||n.filter(e=>{var t,r,n;return(null==(t=e.filter)?void 0:t.event)==="*"||(null==(n=null==(r=e.filter)?void 0:r.event)?void 0:n.toLocaleLowerCase())===s}).map(e=>e.callback(c,r)):null==(i=this.bindings[s])||i.filter(e=>{var r,n,i,a,o,l;if(!["broadcast","presence","postgres_changes"].includes(s))return e.type.toLocaleLowerCase()===s;if("id"in e){let s=e.id,a=null==(r=e.filter)?void 0:r.event;return s&&(null==(n=t.ids)?void 0:n.includes(s))&&("*"===a||(null==a?void 0:a.toLocaleLowerCase())===(null==(i=t.data)?void 0:i.type.toLocaleLowerCase()))}{let r=null==(o=null==(a=null==e?void 0:e.filter)?void 0:a.event)?void 0:o.toLocaleLowerCase();return"*"===r||r===(null==(l=null==t?void 0:t.event)?void 0:l.toLocaleLowerCase())}}).map(e=>{if("object"==typeof c&&"ids"in c){let e=c.data,{schema:t,table:r,commit_timestamp:n,type:i,errors:s}=e;c=Object.assign(Object.assign({},{schema:t,table:r,commit_timestamp:n,eventType:i,new:{},old:{},errors:s}),this._getPayloadRecords(e))}e.callback(c,r)})}_isClosed(){return this.state===T.closed}_isJoined(){return this.state===T.joined}_isJoining(){return this.state===T.joining}_isLeaving(){return this.state===T.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,r){let n=e.toLocaleLowerCase(),i={type:n,filter:t,callback:r};return this.bindings[n]?this.bindings[n].push(i):this.bindings[n]=[i],this}_off(e,t){let r=e.toLocaleLowerCase();return this.bindings[r]=this.bindings[r].filter(e=>{var n;return!((null==(n=e.type)?void 0:n.toLocaleLowerCase())===r&&oq.isEqual(e.filter,t))}),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(let r in e)if(e[r]!==t[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(N.close,{},e)}_onError(e){this._on(N.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=T.joining,this.joinPush.resend(e))}_getPayloadRecords(e){let t={new:{},old:{}};return("INSERT"===e.type||"UPDATE"===e.type)&&(t.new=oz(e.columns,e.record)),("UPDATE"===e.type||"DELETE"===e.type)&&(t.old=oz(e.columns,e.old_record)),t}}let oV=()=>{},oJ="u">typeof WebSocket,oW=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class oG{constructor(t,r){var n;this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=oA,this.params={},this.timeout=1e4,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=oV,this.conn=null,this.sendBuffer=[],this.serializer=new oP,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=t=>{let r;return r=t||("u"<typeof fetch?(...t)=>e.A(11737).then(({default:e})=>e(...t)):fetch),(...e)=>r(...e)},this.endPoint=`${t}/${A.websocket}`,this.httpEndpoint=oB(t),(null==r?void 0:r.transport)?this.transport=r.transport:this.transport=null,(null==r?void 0:r.params)&&(this.params=r.params),(null==r?void 0:r.headers)&&(this.headers=Object.assign(Object.assign({},this.headers),r.headers)),(null==r?void 0:r.timeout)&&(this.timeout=r.timeout),(null==r?void 0:r.logger)&&(this.logger=r.logger),(null==r?void 0:r.heartbeatIntervalMs)&&(this.heartbeatIntervalMs=r.heartbeatIntervalMs);const i=null==(n=null==r?void 0:r.params)?void 0:n.apikey;if(i&&(this.accessTokenValue=i,this.apiKey=i),this.reconnectAfterMs=(null==r?void 0:r.reconnectAfterMs)?r.reconnectAfterMs:e=>[1e3,2e3,5e3,1e4][e-1]||1e4,this.encode=(null==r?void 0:r.encode)?r.encode:(e,t)=>t(JSON.stringify(e)),this.decode=(null==r?void 0:r.decode)?r.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new oC(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(null==r?void 0:r.fetch),null==r?void 0:r.worker){if("u">typeof window&&!window.Worker)throw Error("Web Worker is not supported");this.worker=(null==r?void 0:r.worker)||!1,this.workerUrl=null==r?void 0:r.workerUrl}this.accessToken=(null==r?void 0:r.accessToken)||null}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers});return}if(oJ){this.conn=new WebSocket(this.endpointURL()),this.setupConnection();return}this.conn=new oH(this.endpointURL(),void 0,{close:()=>{this.conn=null}}),e.A(56555).then(({default:e})=>{this.conn=new e(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:"1.0.0"}))}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,null!=t?t:""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(e){let t=await e.unsubscribe();return 0===this.channels.length&&this.disconnect(),t}async removeAllChannels(){let e=await Promise.all(this.channels.map(e=>e.unsubscribe()));return this.disconnect(),e}log(e,t,r){this.logger(e,t,r)}connectionState(){switch(this.conn&&this.conn.readyState){case O.connecting:return P.Connecting;case O.open:return P.Open;case O.closing:return P.Closing;default:return P.Closed}}isConnected(){return this.connectionState()===P.Open}channel(e,t={config:{}}){let r=new oq(`realtime:${e}`,t,this);return this.channels.push(r),r}push(e){let{topic:t,event:r,payload:n,ref:i}=e,s=()=>{this.encode(e,e=>{var t;null==(t=this.conn)||t.send(e)})};this.log("push",`${t} ${r} (${i})`,n),this.isConnected()?s():this.sendBuffer.push(s)}async setAuth(e=null){let t=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;if(t){let e=null;try{e=JSON.parse(atob(t.split(".")[1]))}catch(e){}if(e&&e.exp&&!(Math.floor(Date.now()/1e3)-e.exp<0))return this.log("auth",`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${e.exp}`),Promise.reject(`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${e.exp}`);this.accessTokenValue=t,this.channels.forEach(e=>{t&&e.updateJoinPayload({access_token:t}),e.joinedOnce&&e._isJoined()&&e._push(N.access_token,{access_token:t})})}}async sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),null==(e=this.conn)||e.close(1e3,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth()}}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(t=>t.topic===e&&(t._isJoined()||t._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t._joinRef()!==e._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,e=>{let{topic:t,event:r,payload:n,ref:i}=e;i&&i===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${n.status||""} ${t} ${r} ${i&&"("+i+")"||""}`,n),this.channels.filter(e=>e._isMember(t)).forEach(e=>e._trigger(r,n,i)),this.stateChangeCallbacks.message.forEach(t=>t(e))})}async _onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");let e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=e=>{this.log("worker","worker error",e.message),this.workerRef.terminate()},this.workerRef.onmessage=e=>{"keepAlive"===e.data.event&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}else this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs);this.stateChangeCallbacks.open.forEach(e=>e())}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(t=>t(e))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(t=>t(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(N.error))}_appendParams(e,t){if(0===Object.keys(t).length)return e;let r=e.match(/\?/)?"&":"?",n=new URLSearchParams(t);return`${e}${r}${n}`}_workerObjectUrl(e){let t;if(e)t=e;else{let e=new Blob([oW],{type:"application/javascript"});t=URL.createObjectURL(e)}return t}}class oH{constructor(e,t,r){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=O.connecting,this.send=()=>{},this.url=null,this.url=e,this.close=r.close}}var oQ=e.i(67034);class oY extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function oX(e){return"object"==typeof e&&null!==e&&"__isStorageError"in e}class o0 extends oY{constructor(e,t){super(e),this.name="StorageApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class o1 extends oY{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}let o2=t=>{let r;return r=t||("u"<typeof fetch?(...t)=>e.A(11737).then(({default:e})=>e(...t)):fetch),(...e)=>r(...e)},o3=e=>{if(Array.isArray(e))return e.map(e=>o3(e));if("function"==typeof e||e!==Object(e))return e;let t={};return Object.entries(e).forEach(([e,r])=>{t[e.replace(/([-_][a-z])/gi,e=>e.toUpperCase().replace(/[-_]/g,""))]=o3(r)}),t};var o4=function(e,t,r,n){return new(r||(r=Promise))(function(i,s){function a(e){try{l(n.next(e))}catch(e){s(e)}}function o(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(a,o)}l((n=n.apply(e,t||[])).next())})};let o5=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e);function o6(t,r,n,i,s,a){return o4(this,void 0,void 0,function*(){return new Promise((o,l)=>{let u;t(n,(u={method:r,headers:(null==i?void 0:i.headers)||{}},"GET"===r?u:(u.headers=Object.assign({"Content-Type":"application/json"},null==i?void 0:i.headers),a&&(u.body=JSON.stringify(a)),Object.assign(Object.assign({},u),s)))).then(e=>{if(!e.ok)throw e;return(null==i?void 0:i.noResolveJson)?e:e.json()}).then(e=>o(e)).catch(t=>o4(void 0,void 0,void 0,function*(){var r,n,s,a;let o=yield(r=void 0,n=void 0,s=void 0,a=function*(){return"u"<typeof Response?(yield e.A(11737)).Response:Response},new(s||(s=Promise))(function(e,t){function i(e){try{l(a.next(e))}catch(e){t(e)}}function o(e){try{l(a.throw(e))}catch(e){t(e)}}function l(t){var r;t.done?e(t.value):((r=t.value)instanceof s?r:new s(function(e){e(r)})).then(i,o)}l((a=a.apply(r,n||[])).next())}));t instanceof o&&!(null==i?void 0:i.noResolveJson)?t.json().then(e=>{l(new o0(o5(e),t.status||500))}).catch(e=>{l(new o1(o5(e),e))}):l(new o1(o5(t),t))}))})})}function o8(e,t,r,n){return o4(this,void 0,void 0,function*(){return o6(e,"GET",t,r,n)})}function o7(e,t,r,n,i){return o4(this,void 0,void 0,function*(){return o6(e,"POST",t,n,i,r)})}function o9(e,t,r,n,i){return o4(this,void 0,void 0,function*(){return o6(e,"DELETE",t,n,i,r)})}var le=function(e,t,r,n){return new(r||(r=Promise))(function(i,s){function a(e){try{l(n.next(e))}catch(e){s(e)}}function o(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(a,o)}l((n=n.apply(e,t||[])).next())})};let lt={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},lr={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class ln{constructor(e,t={},r,n){this.url=e,this.headers=t,this.bucketId=r,this.fetch=o2(n)}uploadOrUpdate(e,t,r,n){return le(this,void 0,void 0,function*(){try{let i,s=Object.assign(Object.assign({},lr),n),a=Object.assign(Object.assign({},this.headers),"POST"===e&&{"x-upsert":String(s.upsert)}),o=s.metadata;"u">typeof Blob&&r instanceof Blob?((i=new FormData).append("cacheControl",s.cacheControl),o&&i.append("metadata",this.encodeMetadata(o)),i.append("",r)):"u">typeof FormData&&r instanceof FormData?((i=r).append("cacheControl",s.cacheControl),o&&i.append("metadata",this.encodeMetadata(o))):(i=r,a["cache-control"]=`max-age=${s.cacheControl}`,a["content-type"]=s.contentType,o&&(a["x-metadata"]=this.toBase64(this.encodeMetadata(o)))),(null==n?void 0:n.headers)&&(a=Object.assign(Object.assign({},a),n.headers));let l=this._removeEmptyFolders(t),u=this._getFinalPath(l),c=yield this.fetch(`${this.url}/object/${u}`,Object.assign({method:e,body:i,headers:a},(null==s?void 0:s.duplex)?{duplex:s.duplex}:{})),d=yield c.json();if(c.ok)return{data:{path:l,id:d.Id,fullPath:d.Key},error:null};return{data:null,error:d}}catch(e){if(oX(e))return{data:null,error:e};throw e}})}upload(e,t,r){return le(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,r)})}uploadToSignedUrl(e,t,r,n){return le(this,void 0,void 0,function*(){let i=this._removeEmptyFolders(e),s=this._getFinalPath(i),a=new URL(this.url+`/object/upload/sign/${s}`);a.searchParams.set("token",t);try{let e,t=Object.assign({upsert:lr.upsert},n),s=Object.assign(Object.assign({},this.headers),{"x-upsert":String(t.upsert)});"u">typeof Blob&&r instanceof Blob?((e=new FormData).append("cacheControl",t.cacheControl),e.append("",r)):"u">typeof FormData&&r instanceof FormData?(e=r).append("cacheControl",t.cacheControl):(e=r,s["cache-control"]=`max-age=${t.cacheControl}`,s["content-type"]=t.contentType);let o=yield this.fetch(a.toString(),{method:"PUT",body:e,headers:s}),l=yield o.json();if(o.ok)return{data:{path:i,fullPath:l.Key},error:null};return{data:null,error:l}}catch(e){if(oX(e))return{data:null,error:e};throw e}})}createSignedUploadUrl(e,t){return le(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e),n=Object.assign({},this.headers);(null==t?void 0:t.upsert)&&(n["x-upsert"]="true");let i=yield o7(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:n}),s=new URL(this.url+i.url),a=s.searchParams.get("token");if(!a)throw new oY("No token returned by API");return{data:{signedUrl:s.toString(),path:e,token:a},error:null}}catch(e){if(oX(e))return{data:null,error:e};throw e}})}update(e,t,r){return le(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,r)})}move(e,t,r){return le(this,void 0,void 0,function*(){try{return{data:yield o7(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null==r?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(e){if(oX(e))return{data:null,error:e};throw e}})}copy(e,t,r){return le(this,void 0,void 0,function*(){try{return{data:{path:(yield o7(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null==r?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(e){if(oX(e))return{data:null,error:e};throw e}})}createSignedUrl(e,t,r){return le(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e),i=yield o7(this.fetch,`${this.url}/object/sign/${n}`,Object.assign({expiresIn:t},(null==r?void 0:r.transform)?{transform:r.transform}:{}),{headers:this.headers}),s=(null==r?void 0:r.download)?`&download=${!0===r.download?"":r.download}`:"";return{data:i={signedUrl:encodeURI(`${this.url}${i.signedURL}${s}`)},error:null}}catch(e){if(oX(e))return{data:null,error:e};throw e}})}createSignedUrls(e,t,r){return le(this,void 0,void 0,function*(){try{let n=yield o7(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),i=(null==r?void 0:r.download)?`&download=${!0===r.download?"":r.download}`:"";return{data:n.map(e=>Object.assign(Object.assign({},e),{signedUrl:e.signedURL?encodeURI(`${this.url}${e.signedURL}${i}`):null})),error:null}}catch(e){if(oX(e))return{data:null,error:e};throw e}})}download(e,t){return le(this,void 0,void 0,function*(){let r=void 0!==(null==t?void 0:t.transform),n=this.transformOptsToQueryString((null==t?void 0:t.transform)||{}),i=n?`?${n}`:"";try{let t=this._getFinalPath(e),n=yield o8(this.fetch,`${this.url}/${r?"render/image/authenticated":"object"}/${t}${i}`,{headers:this.headers,noResolveJson:!0});return{data:yield n.blob(),error:null}}catch(e){if(oX(e))return{data:null,error:e};throw e}})}info(e){return le(this,void 0,void 0,function*(){let t=this._getFinalPath(e);try{let e=yield o8(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:o3(e),error:null}}catch(e){if(oX(e))return{data:null,error:e};throw e}})}exists(e){return le(this,void 0,void 0,function*(){let t=this._getFinalPath(e);try{return yield function(e,t,r,n){return o4(this,void 0,void 0,function*(){return o6(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),void 0)})}(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(e){if(oX(e)&&e instanceof o1){let t=e.originalError;if([400,404].includes(null==t?void 0:t.status))return{data:!1,error:e}}throw e}})}getPublicUrl(e,t){let r=this._getFinalPath(e),n=[],i=(null==t?void 0:t.download)?`download=${!0===t.download?"":t.download}`:"";""!==i&&n.push(i);let s=void 0!==(null==t?void 0:t.transform),a=this.transformOptsToQueryString((null==t?void 0:t.transform)||{});""!==a&&n.push(a);let o=n.join("&");return""!==o&&(o=`?${o}`),{data:{publicUrl:encodeURI(`${this.url}/${s?"render/image":"object"}/public/${r}${o}`)}}}remove(e){return le(this,void 0,void 0,function*(){try{return{data:yield o9(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(e){if(oX(e))return{data:null,error:e};throw e}})}list(e,t,r){return le(this,void 0,void 0,function*(){try{let n=Object.assign(Object.assign(Object.assign({},lt),t),{prefix:e||""});return{data:yield o7(this.fetch,`${this.url}/object/list/${this.bucketId}`,n,{headers:this.headers},r),error:null}}catch(e){if(oX(e))return{data:null,error:e};throw e}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return void 0!==oQ.Buffer?oQ.Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){let t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}let li={"X-Client-Info":"storage-js/2.7.1"};var ls=function(e,t,r,n){return new(r||(r=Promise))(function(i,s){function a(e){try{l(n.next(e))}catch(e){s(e)}}function o(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(a,o)}l((n=n.apply(e,t||[])).next())})};class la{constructor(e,t={},r){this.url=e,this.headers=Object.assign(Object.assign({},li),t),this.fetch=o2(r)}listBuckets(){return ls(this,void 0,void 0,function*(){try{return{data:yield o8(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(oX(e))return{data:null,error:e};throw e}})}getBucket(e){return ls(this,void 0,void 0,function*(){try{return{data:yield o8(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(e){if(oX(e))return{data:null,error:e};throw e}})}createBucket(e,t={public:!1}){return ls(this,void 0,void 0,function*(){try{return{data:yield o7(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(e){if(oX(e))return{data:null,error:e};throw e}})}updateBucket(e,t){return ls(this,void 0,void 0,function*(){try{return{data:yield function(e,t,r,n,i){return o4(this,void 0,void 0,function*(){return o6(e,"PUT",t,n,void 0,r)})}(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(e){if(oX(e))return{data:null,error:e};throw e}})}emptyBucket(e){return ls(this,void 0,void 0,function*(){try{return{data:yield o7(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(e){if(oX(e))return{data:null,error:e};throw e}})}deleteBucket(e){return ls(this,void 0,void 0,function*(){try{return{data:yield o9(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(e){if(oX(e))return{data:null,error:e};throw e}})}}class lo extends la{constructor(e,t={},r){super(e,t,r)}from(e){return new ln(this.url,this.headers,e,this.fetch)}}let ll="";ll="u">typeof Deno?"deno":"u">typeof document?"web":"u">typeof navigator&&"ReactNative"===navigator.product?"react-native":"node";let lu={headers:{"X-Client-Info":`supabase-js-${ll}/2.48.1`}},lc={schema:"public"},ld={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},lh={};var lf=e.i(6085);let lp="2.67.3",lm={"X-Client-Info":`gotrue-js/${lp}`},lg="X-Supabase-Api-Version",ly={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},lv=()=>"u">typeof window&&"u">typeof document,lb={tested:!1,writable:!1},lx=()=>{if(!lv())return!1;try{if("object"!=typeof globalThis.localStorage)return!1}catch(e){return!1}if(lb.tested)return lb.writable;let e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),lb.tested=!0,lb.writable=!0}catch(e){lb.tested=!0,lb.writable=!1}return lb.writable},lw=t=>{let r;return r=t||("u"<typeof fetch?(...t)=>e.A(11737).then(({default:e})=>e(...t)):fetch),(...e)=>r(...e)},l_=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},lk=async(e,t)=>{let r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch(e){return r}},lj=async(e,t)=>{await e.removeItem(t)};class lE{constructor(){this.promise=new lE.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}function lS(e){let t=e.split(".");if(3!==t.length)throw Error("JWT is not valid: not a JWT structure");if(!/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i.test(t[1]))throw Error("JWT is not valid: payload is not in base64url format");return JSON.parse(function(e){let t,r,n,i,s,a,o,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",u="",c=0;for(e=e.replace("-","+").replace("_","/");c<e.length;)i=l.indexOf(e.charAt(c++)),s=l.indexOf(e.charAt(c++)),a=l.indexOf(e.charAt(c++)),o=l.indexOf(e.charAt(c++)),t=i<<2|s>>4,r=(15&s)<<4|a>>2,n=(3&a)<<6|o,u+=String.fromCharCode(t),64!=a&&0!=r&&(u+=String.fromCharCode(r)),64!=o&&0!=n&&(u+=String.fromCharCode(n));return u}(t[1]))}async function lO(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function lT(e){return("0"+e.toString(16)).substr(-2)}async function lN(e){let t=new TextEncoder().encode(e);return Array.from(new Uint8Array(await crypto.subtle.digest("SHA-256",t))).map(e=>String.fromCharCode(e)).join("")}async function lA(e){return"u">typeof crypto&&void 0!==crypto.subtle&&"u">typeof TextEncoder?btoa(await lN(e)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,""):(console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e)}async function lP(e,t,r=!1){let n=function(){let e=new Uint32Array(56);if("u"<typeof crypto){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",t=e.length,r="";for(let n=0;n<56;n++)r+=e.charAt(Math.floor(Math.random()*t));return r}return crypto.getRandomValues(e),Array.from(e,lT).join("")}(),i=n;r&&(i+="/PASSWORD_RECOVERY"),await l_(e,`${t}-code-verifier`,i);let s=await lA(n),a=n===s?"plain":"s256";return[s,a]}lE.promiseConstructor=Promise;let lC=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;class lz extends Error{constructor(e,t,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=r}}function lR(e){return"object"==typeof e&&null!==e&&"__isAuthError"in e}class l$ extends lz{constructor(e,t,r){super(e,t,r),this.name="AuthApiError",this.status=t,this.code=r}}class lF extends lz{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class lI extends lz{constructor(e,t,r,n){super(e,r,n),this.name=t,this.status=r}}class lD extends lI{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}class lM extends lI{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class lU extends lI{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class lL extends lI{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class lB extends lI{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class lK extends lI{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function lZ(e){return lR(e)&&"AuthRetryableFetchError"===e.name}class lq extends lI{constructor(e,t,r){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=r}}var lV=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&0>t.indexOf(n)&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)0>t.indexOf(n[i])&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r};let lJ=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),lW=[502,503,504];async function lG(e){var t;let r,n;if(!("object"==typeof e&&null!==e&&"status"in e&&"ok"in e&&"json"in e&&"function"==typeof e.json))throw new lK(lJ(e),0);if(lW.includes(e.status))throw new lK(lJ(e),e.status);try{r=await e.json()}catch(e){throw new lF(lJ(e),e)}let i=function(e){let t=e.headers.get(lg);if(!t||!t.match(lC))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch(e){return null}}(e);if(i&&i.getTime()>=ly["2024-01-01"].timestamp&&"object"==typeof r&&r&&"string"==typeof r.code?n=r.code:"object"==typeof r&&r&&"string"==typeof r.error_code&&(n=r.error_code),n){if("weak_password"===n)throw new lq(lJ(r),e.status,(null==(t=r.weak_password)?void 0:t.reasons)||[]);else if("session_not_found"===n)throw new lD}else if("object"==typeof r&&r&&"object"==typeof r.weak_password&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((e,t)=>e&&"string"==typeof t,!0))throw new lq(lJ(r),e.status,r.weak_password.reasons);throw new l$(lJ(r),e.status||500,n)}async function lH(e,t,r,n){var i;let s=Object.assign({},null==n?void 0:n.headers);s[lg]||(s[lg]=ly["2024-01-01"].name),(null==n?void 0:n.jwt)&&(s.Authorization=`Bearer ${n.jwt}`);let a=null!=(i=null==n?void 0:n.query)?i:{};(null==n?void 0:n.redirectTo)&&(a.redirect_to=n.redirectTo);let o=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",l=await lQ(e,t,r+o,{headers:s,noResolveJson:null==n?void 0:n.noResolveJson},{},null==n?void 0:n.body);return(null==n?void 0:n.xform)?null==n?void 0:n.xform(l):{data:Object.assign({},l),error:null}}async function lQ(e,t,r,n,i,s){let a,o,l=(o={method:t,headers:(null==n?void 0:n.headers)||{}},"GET"===t?o:(o.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},null==n?void 0:n.headers),o.body=JSON.stringify(s),Object.assign(Object.assign({},o),i)));try{a=await e(r,Object.assign({},l))}catch(e){throw console.error(e),new lK(lJ(e),0)}if(a.ok||await lG(a),null==n?void 0:n.noResolveJson)return a;try{return await a.json()}catch(e){await lG(e)}}function lY(e){var t,r,n;let i=null;(n=e).access_token&&n.refresh_token&&n.expires_in&&(i=Object.assign({},e),e.expires_at||(i.expires_at=(r=e.expires_in,Math.round(Date.now()/1e3)+r)));return{data:{session:i,user:null!=(t=e.user)?t:e},error:null}}function lX(e){let t=lY(e);return!t.error&&e.weak_password&&"object"==typeof e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&"string"==typeof e.weak_password.message&&e.weak_password.reasons.reduce((e,t)=>e&&"string"==typeof t,!0)&&(t.data.weak_password=e.weak_password),t}function l0(e){var t;return{data:{user:null!=(t=e.user)?t:e},error:null}}function l1(e){return{data:e,error:null}}function l2(e){let{action_link:t,email_otp:r,hashed_token:n,redirect_to:i,verification_type:s}=e;return{data:{properties:{action_link:t,email_otp:r,hashed_token:n,redirect_to:i,verification_type:s},user:Object.assign({},lV(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]))},error:null}}function l3(e){return e}var l4=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&0>t.indexOf(n)&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)0>t.indexOf(n[i])&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r};class l5{constructor({url:e="",headers:t={},fetch:r}){this.url=e,this.headers=t,this.fetch=lw(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t="global"){try{return await lH(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(e){if(lR(e))return{data:null,error:e};throw e}}async inviteUserByEmail(e,t={}){try{return await lH(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:l0})}catch(e){if(lR(e))return{data:{user:null},error:e};throw e}}async generateLink(e){try{let{options:t}=e,r=l4(e,["options"]),n=Object.assign(Object.assign({},r),t);return"newEmail"in r&&(n.new_email=null==r?void 0:r.newEmail,delete n.newEmail),await lH(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:l2,redirectTo:null==t?void 0:t.redirectTo})}catch(e){if(lR(e))return{data:{properties:null,user:null},error:e};throw e}}async createUser(e){try{return await lH(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:l0})}catch(e){if(lR(e))return{data:{user:null},error:e};throw e}}async listUsers(e){var t,r,n,i,s,a,o;try{let l={nextPage:null,lastPage:0,total:0},u=await lH(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:null!=(r=null==(t=null==e?void 0:e.page)?void 0:t.toString())?r:"",per_page:null!=(i=null==(n=null==e?void 0:e.perPage)?void 0:n.toString())?i:""},xform:l3});if(u.error)throw u.error;let c=await u.json(),d=null!=(s=u.headers.get("x-total-count"))?s:0,h=null!=(o=null==(a=u.headers.get("link"))?void 0:a.split(","))?o:[];return h.length>0&&(h.forEach(e=>{let t=parseInt(e.split(";")[0].split("=")[1].substring(0,1)),r=JSON.parse(e.split(";")[1].split("=")[1]);l[`${r}Page`]=t}),l.total=parseInt(d)),{data:Object.assign(Object.assign({},c),l),error:null}}catch(e){if(lR(e))return{data:{users:[]},error:e};throw e}}async getUserById(e){try{return await lH(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:l0})}catch(e){if(lR(e))return{data:{user:null},error:e};throw e}}async updateUserById(e,t){try{return await lH(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:l0})}catch(e){if(lR(e))return{data:{user:null},error:e};throw e}}async deleteUser(e,t=!1){try{return await lH(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:l0})}catch(e){if(lR(e))return{data:{user:null},error:e};throw e}}async _listFactors(e){try{let{data:t,error:r}=await lH(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:e=>({data:{factors:e},error:null})});return{data:t,error:r}}catch(e){if(lR(e))return{data:null,error:e};throw e}}async _deleteFactor(e){try{return{data:await lH(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(e){if(lR(e))return{data:null,error:e};throw e}}}let l6={getItem:e=>lx()?globalThis.localStorage.getItem(e):null,setItem:(e,t)=>{lx()&&globalThis.localStorage.setItem(e,t)},removeItem:e=>{lx()&&globalThis.localStorage.removeItem(e)}};function l8(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}let l7={debug:!!(globalThis&&lx()&&globalThis.localStorage&&"true"===globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug"))};class l9 extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class ue extends l9{}async function ut(e,t,r){l7.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);let n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),l7.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,0===t?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async n=>{if(n){l7.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,n.name);try{return await r()}finally{l7.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,n.name)}}if(0===t)throw l7.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new ue(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(l7.debug)try{let e=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(e,null,"  "))}catch(e){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",e)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}))}if("object"!=typeof globalThis)try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch(e){"u">typeof self&&(self.globalThis=self)}let ur={url:"http://localhost:9999",storageKey:"supabase.auth.token",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:lm,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function un(e,t,r){return await r()}class ui{constructor(e){var t,r;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=ui.nextInstanceID,ui.nextInstanceID+=1,this.instanceID>0&&lv()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const n=Object.assign(Object.assign({},ur),e);if(this.logDebugMessages=!!n.debug,"function"==typeof n.debug&&(this.logger=n.debug),this.persistSession=n.persistSession,this.storageKey=n.storageKey,this.autoRefreshToken=n.autoRefreshToken,this.admin=new l5({url:n.url,headers:n.headers,fetch:n.fetch}),this.url=n.url,this.headers=n.headers,this.fetch=lw(n.fetch),this.lock=n.lock||un,this.detectSessionInUrl=n.detectSessionInUrl,this.flowType=n.flowType,this.hasCustomAuthorizationHeader=n.hasCustomAuthorizationHeader,n.lock?this.lock=n.lock:lv()&&(null==(t=null==globalThis?void 0:globalThis.navigator)?void 0:t.locks)?this.lock=ut:this.lock=un,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?n.storage?this.storage=n.storage:lx()?this.storage=l6:(this.memoryStorage={},this.storage=l8(this.memoryStorage)):(this.memoryStorage={},this.storage=l8(this.memoryStorage)),lv()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(e){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",e)}null==(r=this.broadcastChannel)||r.addEventListener("message",async e=>{this._debug("received broadcast notification from other tab or client",e),await this._notifyAllSubscribers(e.data.event,e.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${lp}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise||(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))()),await this.initializePromise}async _initialize(){var e;try{let t=function(e){let t={},r=new URL(e);if(r.hash&&"#"===r.hash[0])try{new URLSearchParams(r.hash.substring(1)).forEach((e,r)=>{t[r]=e})}catch(e){}return r.searchParams.forEach((e,r)=>{t[r]=e}),t}(window.location.href),r="none";if(this._isImplicitGrantCallback(t)?r="implicit":await this._isPKCECallback(t)&&(r="pkce"),lv()&&this.detectSessionInUrl&&"none"!==r){let{data:n,error:i}=await this._getSessionFromURL(t,r);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),lR(i)&&"AuthImplicitGrantRedirectError"===i.name){let t=null==(e=i.details)?void 0:e.code;if("identity_already_exists"===t||"identity_not_found"===t||"single_identity_not_deletable"===t)return{error:i}}return await this._removeSession(),{error:i}}let{session:s,redirectType:a}=n;return this._debug("#_initialize()","detected session in URL",s,"redirect type",a),await this._saveSession(s),setTimeout(async()=>{"recovery"===a?await this._notifyAllSubscribers("PASSWORD_RECOVERY",s):await this._notifyAllSubscribers("SIGNED_IN",s)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(e){if(lR(e))return{error:e};return{error:new lF("Unexpected error during initialization",e)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,r,n;try{let{data:i,error:s}=await lH(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:null!=(r=null==(t=null==e?void 0:e.options)?void 0:t.data)?r:{},gotrue_meta_security:{captcha_token:null==(n=null==e?void 0:e.options)?void 0:n.captchaToken}},xform:lY});if(s||!i)return{data:{user:null,session:null},error:s};let a=i.session,o=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",a)),{data:{user:o,session:a},error:null}}catch(e){if(lR(e))return{data:{user:null,session:null},error:e};throw e}}async signUp(e){var t,r,n;try{let i;if("email"in e){let{email:r,password:n,options:s}=e,a=null,o=null;"pkce"===this.flowType&&([a,o]=await lP(this.storage,this.storageKey)),i=await lH(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:null==s?void 0:s.emailRedirectTo,body:{email:r,password:n,data:null!=(t=null==s?void 0:s.data)?t:{},gotrue_meta_security:{captcha_token:null==s?void 0:s.captchaToken},code_challenge:a,code_challenge_method:o},xform:lY})}else if("phone"in e){let{phone:t,password:s,options:a}=e;i=await lH(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:t,password:s,data:null!=(r=null==a?void 0:a.data)?r:{},channel:null!=(n=null==a?void 0:a.channel)?n:"sms",gotrue_meta_security:{captcha_token:null==a?void 0:a.captchaToken}},xform:lY})}else throw new lU("You must provide either an email or phone number and a password");let{data:s,error:a}=i;if(a||!s)return{data:{user:null,session:null},error:a};let o=s.session,l=s.user;return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",o)),{data:{user:l,session:o},error:null}}catch(e){if(lR(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithPassword(e){try{let t;if("email"in e){let{email:r,password:n,options:i}=e;t=await lH(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:r,password:n,gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken}},xform:lX})}else if("phone"in e){let{phone:r,password:n,options:i}=e;t=await lH(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:r,password:n,gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken}},xform:lX})}else throw new lU("You must provide either an email or phone number and a password");let{data:r,error:n}=t;if(n)return{data:{user:null,session:null},error:n};if(!r||!r.session||!r.user)return{data:{user:null,session:null},error:new lM};return r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:n}}catch(e){if(lR(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithOAuth(e){var t,r,n,i;return await this._handleProviderSignIn(e.provider,{redirectTo:null==(t=e.options)?void 0:t.redirectTo,scopes:null==(r=e.options)?void 0:r.scopes,queryParams:null==(n=e.options)?void 0:n.queryParams,skipBrowserRedirect:null==(i=e.options)?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async _exchangeCodeForSession(e){let t=await lk(this.storage,`${this.storageKey}-code-verifier`),[r,n]=(null!=t?t:"").split("/");try{let{data:t,error:i}=await lH(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:lY});if(await lj(this.storage,`${this.storageKey}-code-verifier`),i)throw i;if(!t||!t.session||!t.user)return{data:{user:null,session:null,redirectType:null},error:new lM};return t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),{data:Object.assign(Object.assign({},t),{redirectType:null!=n?n:null}),error:i}}catch(e){if(lR(e))return{data:{user:null,session:null,redirectType:null},error:e};throw e}}async signInWithIdToken(e){try{let{options:t,provider:r,token:n,access_token:i,nonce:s}=e,{data:a,error:o}=await lH(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:n,access_token:i,nonce:s,gotrue_meta_security:{captcha_token:null==t?void 0:t.captchaToken}},xform:lY});if(o)return{data:{user:null,session:null},error:o};if(!a||!a.session||!a.user)return{data:{user:null,session:null},error:new lM};return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),{data:a,error:o}}catch(e){if(lR(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithOtp(e){var t,r,n,i,s;try{if("email"in e){let{email:n,options:i}=e,s=null,a=null;"pkce"===this.flowType&&([s,a]=await lP(this.storage,this.storageKey));let{error:o}=await lH(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:n,data:null!=(t=null==i?void 0:i.data)?t:{},create_user:null==(r=null==i?void 0:i.shouldCreateUser)||r,gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken},code_challenge:s,code_challenge_method:a},redirectTo:null==i?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:o}}if("phone"in e){let{phone:t,options:r}=e,{data:a,error:o}=await lH(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:t,data:null!=(n=null==r?void 0:r.data)?n:{},create_user:null==(i=null==r?void 0:r.shouldCreateUser)||i,gotrue_meta_security:{captcha_token:null==r?void 0:r.captchaToken},channel:null!=(s=null==r?void 0:r.channel)?s:"sms"}});return{data:{user:null,session:null,messageId:null==a?void 0:a.message_id},error:o}}throw new lU("You must provide either an email or phone number.")}catch(e){if(lR(e))return{data:{user:null,session:null},error:e};throw e}}async verifyOtp(e){var t,r;try{let n,i;"options"in e&&(n=null==(t=e.options)?void 0:t.redirectTo,i=null==(r=e.options)?void 0:r.captchaToken);let{data:s,error:a}=await lH(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:n,xform:lY});if(a)throw a;if(!s)throw Error("An error occurred on token verification.");let o=s.session,l=s.user;return(null==o?void 0:o.access_token)&&(await this._saveSession(o),await this._notifyAllSubscribers("recovery"==e.type?"PASSWORD_RECOVERY":"SIGNED_IN",o)),{data:{user:l,session:o},error:null}}catch(e){if(lR(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithSSO(e){var t,r,n;try{let i=null,s=null;return"pkce"===this.flowType&&([i,s]=await lP(this.storage,this.storageKey)),await lH(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:null!=(r=null==(t=e.options)?void 0:t.redirectTo)?r:void 0}),(null==(n=null==e?void 0:e.options)?void 0:n.captchaToken)?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:s}),headers:this.headers,xform:l1})}catch(e){if(lR(e))return{data:null,error:e};throw e}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{let{data:{session:t},error:r}=e;if(r)throw r;if(!t)throw new lD;let{error:n}=await lH(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:n}})}catch(e){if(lR(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{let t=`${this.url}/resend`;if("email"in e){let{email:r,type:n,options:i}=e,{error:s}=await lH(this.fetch,"POST",t,{headers:this.headers,body:{email:r,type:n,gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken}},redirectTo:null==i?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:s}}if("phone"in e){let{phone:r,type:n,options:i}=e,{data:s,error:a}=await lH(this.fetch,"POST",t,{headers:this.headers,body:{phone:r,type:n,gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:null==s?void 0:s.message_id},error:a}}throw new lU("You must provide either an email or phone number and a type")}catch(e){if(lR(e))return{data:{user:null,session:null},error:e};throw e}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async e=>e))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){let e=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),r=(async()=>(await e,await t()))();return this.pendingInLock.push((async()=>{try{await r}catch(e){}})()),r}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;let e=t();for(this.pendingInLock.push((async()=>{try{await e}catch(e){}})()),await e;this.pendingInLock.length;){let e=[...this.pendingInLock];await Promise.all(e),this.pendingInLock.splice(0,e.length)}return await e}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{let t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",Error().stack);try{let e=null,t=await lk(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),null!==t&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};let r=!!e.expires_at&&e.expires_at<=Date.now()/1e3;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.storage.isServer){let t=this.suppressGetSessionWarning;e=new Proxy(e,{get:(e,r,n)=>(t||"user"!==r||(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t=!0,this.suppressGetSessionWarning=!0),Reflect.get(e,r,n))})}return{data:{session:e},error:null}}let{session:n,error:i}=await this._callRefreshToken(e.refresh_token);if(i)return{data:{session:null},error:i};return{data:{session:n},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{if(e)return await lH(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:l0});return await this._useSession(async e=>{var t,r,n;let{data:i,error:s}=e;if(s)throw s;return(null==(t=i.session)?void 0:t.access_token)||this.hasCustomAuthorizationHeader?await lH(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:null!=(n=null==(r=i.session)?void 0:r.access_token)?n:void 0,xform:l0}):{data:{user:null},error:new lD}})}catch(e){if(lR(e))return lR(e)&&"AuthSessionMissingError"===e.name&&(await this._removeSession(),await lj(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:e};throw e}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async r=>{let{data:n,error:i}=r;if(i)throw i;if(!n.session)throw new lD;let s=n.session,a=null,o=null;"pkce"===this.flowType&&null!=e.email&&([a,o]=await lP(this.storage,this.storageKey));let{data:l,error:u}=await lH(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:null==t?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:a,code_challenge_method:o}),jwt:s.access_token,xform:l0});if(u)throw u;return s.user=l.user,await this._saveSession(s),await this._notifyAllSubscribers("USER_UPDATED",s),{data:{user:s.user},error:null}})}catch(e){if(lR(e))return{data:{user:null},error:e};throw e}}_decodeJWT(e){return lS(e)}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new lD;let t=Date.now()/1e3,r=t,n=!0,i=null,s=lS(e.access_token);if(s.exp&&(n=(r=s.exp)<=t),n){let{session:t,error:r}=await this._callRefreshToken(e.refresh_token);if(r)return{data:{user:null,session:null},error:r};if(!t)return{data:{user:null,session:null},error:null};i=t}else{let{data:n,error:s}=await this._getUser(e.access_token);if(s)throw s;i={access_token:e.access_token,refresh_token:e.refresh_token,user:n.user,token_type:"bearer",expires_in:r-t,expires_at:r},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(e){if(lR(e))return{data:{session:null,user:null},error:e};throw e}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var r;if(!e){let{data:n,error:i}=t;if(i)throw i;e=null!=(r=n.session)?r:void 0}if(!(null==e?void 0:e.refresh_token))throw new lD;let{session:n,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{user:null,session:null},error:i}:n?{data:{user:n.user,session:n},error:null}:{data:{user:null,session:null},error:null}})}catch(e){if(lR(e))return{data:{user:null,session:null},error:e};throw e}}async _getSessionFromURL(e,t){try{if(!lv())throw new lL("No browser detected.");if(e.error||e.error_description||e.error_code)throw new lL(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if("pkce"===this.flowType)throw new lB("Not a valid PKCE flow url.");break;case"pkce":if("implicit"===this.flowType)throw new lL("Not a valid implicit grant flow url.")}if("pkce"===t){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new lB("No code detected.");let{data:t,error:r}=await this._exchangeCodeForSession(e.code);if(r)throw r;let n=new URL(window.location.href);return n.searchParams.delete("code"),window.history.replaceState(window.history.state,"",n.toString()),{data:{session:t.session,redirectType:null},error:null}}let{provider_token:r,provider_refresh_token:n,access_token:i,refresh_token:s,expires_in:a,expires_at:o,token_type:l}=e;if(!i||!a||!s||!l)throw new lL("No session defined in URL");let u=Math.round(Date.now()/1e3),c=parseInt(a),d=u+c;o&&(d=parseInt(o));let h=d-u;1e3*h<=3e4&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${h}s, should have been closer to ${c}s`);let f=d-c;u-f>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",f,d,u):u-f<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",f,d,u);let{data:p,error:m}=await this._getUser(i);if(m)throw m;let g={provider_token:r,provider_refresh_token:n,access_token:i,expires_in:c,expires_at:d,refresh_token:s,token_type:l,user:p.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:g,redirectType:e.type},error:null}}catch(e){if(lR(e))return{data:{session:null,redirectType:null},error:e};throw e}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){let t=await lk(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var r;let{data:n,error:i}=t;if(i)return{error:i};let s=null==(r=n.session)?void 0:r.access_token;if(s){let{error:t}=await this.admin.signOut(s,e);if(t&&!(lR(t)&&"AuthApiError"===t.name&&(404===t.status||401===t.status||403===t.status)))return{error:t}}return"others"!==e&&(await this._removeSession(),await lj(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){let t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){let t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}),r={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,r),(async()=>{await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})})(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async t=>{var r,n;try{let{data:{session:n},error:i}=t;if(i)throw i;await (null==(r=this.stateChangeEmitters.get(e))?void 0:r.callback("INITIAL_SESSION",n)),this._debug("INITIAL_SESSION","callback id",e,"session",n)}catch(t){await (null==(n=this.stateChangeEmitters.get(e))?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",t),console.error(t)}})}async resetPasswordForEmail(e,t={}){let r=null,n=null;"pkce"===this.flowType&&([r,n]=await lP(this.storage,this.storageKey,!0));try{return await lH(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:n,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(e){if(lR(e))return{data:null,error:e};throw e}}async getUserIdentities(){var e;try{let{data:t,error:r}=await this.getUser();if(r)throw r;return{data:{identities:null!=(e=t.user.identities)?e:[]},error:null}}catch(e){if(lR(e))return{data:null,error:e};throw e}}async linkIdentity(e){var t;try{let{data:r,error:n}=await this._useSession(async t=>{var r,n,i,s,a;let{data:o,error:l}=t;if(l)throw l;let u=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:null==(r=e.options)?void 0:r.redirectTo,scopes:null==(n=e.options)?void 0:n.scopes,queryParams:null==(i=e.options)?void 0:i.queryParams,skipBrowserRedirect:!0});return await lH(this.fetch,"GET",u,{headers:this.headers,jwt:null!=(a=null==(s=o.session)?void 0:s.access_token)?a:void 0})});if(n)throw n;return!lv()||(null==(t=e.options)?void 0:t.skipBrowserRedirect)||window.location.assign(null==r?void 0:r.url),{data:{provider:e.provider,url:null==r?void 0:r.url},error:null}}catch(t){if(lR(t))return{data:{provider:e.provider,url:null},error:t};throw t}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var r,n;let{data:i,error:s}=t;if(s)throw s;return await lH(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:null!=(n=null==(r=i.session)?void 0:r.access_token)?n:void 0})})}catch(e){if(lR(e))return{data:null,error:e};throw e}}async _refreshAccessToken(e){let t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{var r,n;let i=Date.now();return await (r=async r=>(r>0&&await lO(200*Math.pow(2,r-1)),this._debug(t,"refreshing attempt",r),await lH(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:lY})),n=(e,t)=>{let r=200*Math.pow(2,e);return t&&lZ(t)&&Date.now()+r-i<3e4},new Promise((e,t)=>{(async()=>{for(let i=0;i<1/0;i++)try{let t=await r(i);if(!n(i,null,t))return void e(t)}catch(e){if(!n(i,e))return void t(e)}})()}))}catch(e){if(this._debug(t,"error",e),lR(e))return{data:{session:null,user:null},error:e};throw e}finally{this._debug(t,"end")}}_isValidSession(e){return"object"==typeof e&&null!==e&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){let r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",r),lv()&&!t.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e;let t="#_recoverAndRefresh()";this._debug(t,"begin");try{let r=await lk(this.storage,this.storageKey);if(this._debug(t,"session from storage",r),!this._isValidSession(r)){this._debug(t,"session is not valid"),null!==r&&await this._removeSession();return}let n=Math.round(Date.now()/1e3),i=(null!=(e=r.expires_at)?e:1/0)<n+10;if(this._debug(t,`session has${i?"":" not"} expired with margin of 10s`),i){if(this.autoRefreshToken&&r.refresh_token){let{error:e}=await this._callRefreshToken(r.refresh_token);e&&(console.error(e),lZ(e)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",e),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(e){this._debug(t,"error",e),console.error(e);return}finally{this._debug(t,"end")}}async _callRefreshToken(e){var t,r;if(!e)throw new lD;if(this.refreshingDeferred)return this.refreshingDeferred.promise;let n=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new lE;let{data:t,error:r}=await this._refreshAccessToken(e);if(r)throw r;if(!t.session)throw new lD;await this._saveSession(t.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",t.session);let n={session:t.session,error:null};return this.refreshingDeferred.resolve(n),n}catch(e){if(this._debug(n,"error",e),lR(e)){let r={session:null,error:e};return lZ(e)||await this._removeSession(),null==(t=this.refreshingDeferred)||t.resolve(r),r}throw null==(r=this.refreshingDeferred)||r.reject(e),e}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(e,t,r=!0){let n=`#_notifyAllSubscribers(${e})`;this._debug(n,"begin",t,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:t});let n=[],i=Array.from(this.stateChangeEmitters.values()).map(async r=>{try{await r.callback(e,t)}catch(e){n.push(e)}});if(await Promise.all(i),n.length>0){for(let e=0;e<n.length;e+=1)console.error(n[e]);throw n[0]}}finally{this._debug(n,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await l_(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await lj(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");let e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&lv()&&(null==window?void 0:window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(e){console.error("removing visibilitychange callback failed",e)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");let e=setInterval(()=>this._autoRefreshTokenTick(),3e4);this.autoRefreshTicker=e,e&&"object"==typeof e&&"function"==typeof e.unref?e.unref():"u">typeof Deno&&"function"==typeof Deno.unrefTimer&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");let e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{let e=Date.now();try{return await this._useSession(async t=>{let{data:{session:r}}=t;if(!r||!r.refresh_token||!r.expires_at)return void this._debug("#_autoRefreshTokenTick()","no session");let n=Math.floor((1e3*r.expires_at-e)/3e4);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts 30000ms, refresh threshold is 3 ticks`),n<=3&&await this._callRefreshToken(r.refresh_token)})}catch(e){console.error("Auto refresh tick failed with error. This is likely a transient error.",e)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof l9)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!lv()||!(null==window?void 0:window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),null==window||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){let t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),"visible"===document.visibilityState?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{"visible"!==document.visibilityState?this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting"):await this._recoverAndRefresh()}))):"hidden"===document.visibilityState&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,r){let n=[`provider=${encodeURIComponent(t)}`];if((null==r?void 0:r.redirectTo)&&n.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),(null==r?void 0:r.scopes)&&n.push(`scopes=${encodeURIComponent(r.scopes)}`),"pkce"===this.flowType){let[e,t]=await lP(this.storage,this.storageKey),r=new URLSearchParams({code_challenge:`${encodeURIComponent(e)}`,code_challenge_method:`${encodeURIComponent(t)}`});n.push(r.toString())}if(null==r?void 0:r.queryParams){let e=new URLSearchParams(r.queryParams);n.push(e.toString())}return(null==r?void 0:r.skipBrowserRedirect)&&n.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${n.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var r;let{data:n,error:i}=t;return i?{data:null,error:i}:await lH(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:null==(r=null==n?void 0:n.session)?void 0:r.access_token})})}catch(e){if(lR(e))return{data:null,error:e};throw e}}async _enroll(e){try{return await this._useSession(async t=>{var r,n;let{data:i,error:s}=t;if(s)return{data:null,error:s};let a=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},"phone"===e.factorType?{phone:e.phone}:{issuer:e.issuer}),{data:o,error:l}=await lH(this.fetch,"POST",`${this.url}/factors`,{body:a,headers:this.headers,jwt:null==(r=null==i?void 0:i.session)?void 0:r.access_token});return l?{data:null,error:l}:("totp"===e.factorType&&(null==(n=null==o?void 0:o.totp)?void 0:n.qr_code)&&(o.totp.qr_code=`data:image/svg+xml;utf-8,${o.totp.qr_code}`),{data:o,error:null})})}catch(e){if(lR(e))return{data:null,error:e};throw e}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;let{data:n,error:i}=t;if(i)return{data:null,error:i};let{data:s,error:a}=await lH(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:null==(r=null==n?void 0:n.session)?void 0:r.access_token});return a?{data:null,error:a}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+s.expires_in},s)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",s),{data:s,error:a})})}catch(e){if(lR(e))return{data:null,error:e};throw e}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;let{data:n,error:i}=t;return i?{data:null,error:i}:await lH(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:null==(r=null==n?void 0:n.session)?void 0:r.access_token})})}catch(e){if(lR(e))return{data:null,error:e};throw e}})}async _challengeAndVerify(e){let{data:t,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){let{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};let r=(null==e?void 0:e.factors)||[],n=r.filter(e=>"totp"===e.factor_type&&"verified"===e.status),i=r.filter(e=>"phone"===e.factor_type&&"verified"===e.status);return{data:{all:r,totp:n,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,r;let{data:{session:n},error:i}=e;if(i)return{data:null,error:i};if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};let s=this._decodeJWT(n.access_token),a=null;s.aal&&(a=s.aal);let o=a;return(null!=(r=null==(t=n.user.factors)?void 0:t.filter(e=>"verified"===e.status))?r:[]).length>0&&(o="aal2"),{data:{currentLevel:a,nextLevel:o,currentAuthenticationMethods:s.amr||[]},error:null}}))}}ui.nextInstanceID=0;let us=ui;class ua extends us{constructor(e){super(e)}}let uo=new class e{constructor(e,t,r){var n,i,s;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw Error("supabaseUrl is required.");if(!t)throw Error("supabaseKey is required.");const a=e.replace(/\/$/,"");this.realtimeUrl=`${a}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${a}/auth/v1`,this.storageUrl=`${a}/storage/v1`,this.functionsUrl=`${a}/functions/v1`;const o=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,l=function(e,t){let{db:r,auth:n,realtime:i,global:s}=e,{db:a,auth:o,realtime:l,global:u}=t,c={db:Object.assign(Object.assign({},a),r),auth:Object.assign(Object.assign({},o),n),realtime:Object.assign(Object.assign({},l),i),global:Object.assign(Object.assign({},u),s),accessToken:()=>{var e,t,r,n;return e=this,t=void 0,n=function*(){return""},new(r=void 0,r=Promise)(function(i,s){function a(e){try{l(n.next(e))}catch(e){s(e)}}function o(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(a,o)}l((n=n.apply(e,t||[])).next())})}};return e.accessToken?c.accessToken=e.accessToken:delete c.accessToken,c}(null!=r?r:{},{db:lc,realtime:lh,auth:Object.assign(Object.assign({},ld),{storageKey:o}),global:lu});this.storageKey=null!=(n=l.auth.storageKey)?n:"",this.headers=null!=(i=l.global.headers)?i:{},l.accessToken?(this.accessToken=l.accessToken,this.auth=new Proxy({},{get:(e,t)=>{throw Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(t)} is not possible`)}})):this.auth=this._initSupabaseAuthClient(null!=(s=l.auth)?s:{},this.headers,l.global.fetch),this.fetch=((e,t,r)=>{let n,i=(n=r||("u"<typeof fetch?lf.default:fetch),(...e)=>n(...e)),s="u"<typeof Headers?lf.Headers:Headers;return(r,n)=>{var a,o,l,u;return a=void 0,o=void 0,l=void 0,u=function*(){var a;let o=null!=(a=yield t())?a:e,l=new s(null==n?void 0:n.headers);return l.has("apikey")||l.set("apikey",e),l.has("Authorization")||l.set("Authorization",`Bearer ${o}`),i(r,Object.assign(Object.assign({},n),{headers:l}))},new(l||(l=Promise))(function(e,t){function r(e){try{i(u.next(e))}catch(e){t(e)}}function n(e){try{i(u.throw(e))}catch(e){t(e)}}function i(t){var i;t.done?e(t.value):((i=t.value)instanceof l?i:new l(function(e){e(i)})).then(r,n)}i((u=u.apply(a,o||[])).next())})}})(t,this._getAccessToken.bind(this),l.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},l.realtime)),this.rest=new oj(`${a}/rest/v1`,{headers:this.headers,schema:l.db.schema,fetch:this.fetch}),l.accessToken||this._listenForAuthEvents()}get functions(){return new ok(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new lo(this.storageUrl,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t,r,n,i,s;return r=this,n=void 0,i=void 0,s=function*(){if(this.accessToken)return yield this.accessToken();let{data:r}=yield this.auth.getSession();return null!=(t=null==(e=r.session)?void 0:e.access_token)?t:null},new(i||(i=Promise))(function(e,t){function a(e){try{l(s.next(e))}catch(e){t(e)}}function o(e){try{l(s.throw(e))}catch(e){t(e)}}function l(t){var r;t.done?e(t.value):((r=t.value)instanceof i?r:new i(function(e){e(r)})).then(a,o)}l((s=s.apply(r,n||[])).next())})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:n,storageKey:i,flowType:s,lock:a,debug:o},l,u){let c={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new ua({url:this.authUrl,headers:Object.assign(Object.assign({},c),l),storageKey:i,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:n,flowType:s,lock:a,debug:o,fetch:u,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new oG(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},null==e?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",null==t?void 0:t.access_token)})}_handleTokenChanged(e,t,r){("TOKEN_REFRESHED"===e||"SIGNED_IN"===e)&&this.changedAccessToken!==r?this.changedAccessToken=r:"SIGNED_OUT"===e&&(this.realtime.setAuth(),"STORAGE"==t&&this.auth.signOut(),this.changedAccessToken=void 0)}}("https://jextayidnmtsoofugnig.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpleHRheWlkbm10c29vZnVnbmlnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjkwODM1MDAsImV4cCI6MjA4NDY1OTUwMH0.vxRq32MPWyO_znst5nFCiQ7AWJtlJeOFWMY-RlZmjrs",void 0);async function ul(e,t,r,n,i,s){let{data:a,error:o}=await uo.from("photos_metadata").insert([{cid:e,file_size_bytes:t,device_id:r,nonce:n,mime_type:i,user_key_hash:s}]).select();if(o)throw console.error("Supabase Metadata Upload Error:",o),o;return a}async function uu(e,t){let r=uo.from("photos_metadata").select("cid, device_id, uploaded_at, file_size_bytes, nonce, mime_type");t&&(r=r.eq("user_key_hash",t));let{data:n,error:i}=await r.order("uploaded_at",{ascending:!1});if(i)throw console.error("Supabase Load Error:",i),i;return n||[]}async function uc(e){let{data:t,error:r}=await uo.from("photos_metadata").select("id").eq("cid",e).single();return r&&"PGRST116"!==r.code&&console.error("Supabase Check Error:",r),!!t}async function ud(e,t,r,n,i){if(!n||0===n.length)throw console.error("registerDevice: userKeyHash is required"),Error("userKeyHash is required for device registration");let{data:s}=await uo.from("devices").select("id").eq("id",e).single(),a={device_name:t,device_type:r,user_key_hash:n,user_id:i};if(s){let{data:t,error:r}=await uo.from("devices").update(a).eq("id",e).select();if(r)throw console.error("Supabase Device Update Error:",r),r;return t?.[0]}{let{data:t,error:r}=await uo.from("devices").insert([{id:e,...a}]).select();if(r){if(r.message?.includes("Device limit exceeded"))throw Error("DEVICE_LIMIT_EXCEEDED");throw console.error("Supabase Device Insert Error:",r),r}return t?.[0]}}async function uh(e){let{data:t,error:r}=await uo.from("devices").select("*").eq("user_key_hash",e).order("created_at",{ascending:!1});if(r)throw console.error("Supabase Get Devices Error:",r),r;return t||[]}let uf="red-able-bug-554.mypinata.cloud";async function up(e,t){let r=new FormData;r.append("file",e,t||"encrypted-photo.bin");let n=JSON.stringify({name:t||"photovault-encrypted",keyvalues:{app:"photovault",type:"encrypted-photo"}});r.append("pinataMetadata",n);let i=JSON.stringify({cidVersion:1});r.append("pinataOptions",i);let s=await fetch("https://api.pinata.cloud/pinning/pinFileToIPFS",{method:"POST",headers:{Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySW5mb3JtYXRpb24iOnsiaWQiOiJlYTcxMDdjNi0yMGE0LTQ5Y2ItODAyYy1kMmRhOWM2Nzk4NjUiLCJlbWFpbCI6ImVpbmFyQGJsYWNrLWtuaWdodC5kZXYiLCJlbWFpbF92ZXJpZmllZCI6dHJ1ZSwicGluX3BvbGljeSI6eyJyZWdpb25zIjpbeyJkZXNpcmVkUmVwbGljYXRpb25Db3VudCI6MSwiaWQiOiJGUkExIn0seyJkZXNpcmVkUmVwbGljYXRpb25Db3VudCI6MSwiaWQiOiJOWUMxIn1dLCJ2ZXJzaW9uIjoxfSwibWZhX2VuYWJsZWQiOmZhbHNlLCJzdGF0dXMiOiJBQ1RJVkUifSwiYXV0aGVudGljYXRpb25UeXBlIjoic2NvcGVkS2V5Iiwic2NvcGVkS2V5S2V5IjoiNjkyYjcyYTBlOTk2NDhmNjQ4NjgiLCJzY29wZWRLZXlTZWNyZXQiOiJmMmM3ZDUwMWE3NjhiMWI3NTI3ODExODAyZTg1YzJlNmUyZDc5ZjA0YTM1ZTA4ZjNmYWJiYmRiMmFlMGMzMmUwIiwiZXhwIjoxODAwNjgxOTMzfQ.g47clgfFIHt9Bw-pjvytmuMPO8FSXgAsSfhcXaP-YII"},body:r});if(!s.ok)throw console.error("Pinata upload failed:",await s.text()),Error(`IPFS upload failed: ${s.status}`);let a=await s.json();return console.log("IPFS upload successful:",a.IpfsHash),a.IpfsHash}async function um(e){let t=null;for(let r of[()=>{let t=uf.startsWith("http")?uf:uf.includes(".")?`https://${uf}`:`https://${uf}.mypinata.cloud`,r=new URL(`${t}/ipfs/${e}`);return r.searchParams.set("pinataGatewayToken","q1z_4lRpNW9NNmISiMudoy79QVUJ_7-V6s5CDJvEM-CadXIF_WIWW5Xizui72HvA"),{url:r.toString(),headers:{}}},()=>({url:`https://cloudflare-ipfs.com/ipfs/${e}`,headers:{}}),()=>({url:`https://dweb.link/ipfs/${e}`,headers:{}}),()=>({url:`https://w3s.link/ipfs/${e}`,headers:{}})])try{let{url:e,headers:t}=r();console.log("Fetching from gateway:",e.split("?")[0]);let n=await fetch(e,{method:"GET",headers:t,mode:"cors",credentials:"omit"});if(n.ok)return await n.blob();console.warn(`Gateway returned ${n.status}: ${e.split("?")[0]}`)}catch(e){console.warn("Gateway fetch error:",e),t=e instanceof Error?e:Error(String(e))}throw t||Error(`IPFS download failed for CID: ${e}`)}let ug=async(e,t)=>{try{console.log("Uploading to IPFS...",{size:e.size,fileName:t});let r=await up(e,t);return console.log("IPFS upload successful:",r),r}catch(e){throw console.error("Remote Storage Upload failed:",e),e}},uy=async e=>{try{console.log("Downloading from IPFS:",e);let t=await um(e);return console.log("IPFS download successful:",{cid:e,size:t.size}),t}catch(e){throw console.error("Remote Storage Download failed:",e),e}};function uv(e){return e.startsWith("Qm")||e.startsWith("bafy")||e.startsWith("bafk")}var ub=e.i(52789);function ux(e){let t=(0,a0.useQueryClient)(),[r,n]=(0,M.useState)(null);(0,M.useEffect)(()=>{e?(0,aC.getUserKeyHash)(e).then(n):n(null)},[e]);let{data:i=[],isLoading:s,error:a}=a4({queryKey:["photos"],queryFn:og,enabled:!!e}),{data:o=0}=a4({queryKey:["photoCount"],queryFn:ov}),l=a7({mutationFn:async t=>{let n;if(!e)throw Error("No encryption key");let{encrypted:i,nonce:s}=await (0,aC.encryptFile)(t,e);console.log("File encrypted:",{size:i.size,nonce:s.slice(0,8)+"..."});try{n=await ug(i,t.name),console.log("Uploaded to IPFS with CID:",n)}catch(e){console.error("IPFS upload failed:",e),console.log("Using local fallback CID:",n=`cid_${Date.now()}_${Math.random().toString(36).slice(2)}`)}let a={cid:n,nonce:s,fileName:t.name,mimeType:t.type,fileSize:t.size,uploadedAt:new Date,encryptedBlob:i};await om(a),console.log("Saved to local IndexedDB");let o=(0,ub.getDeviceId)();try{await ul(n,t.size,o,s,t.type,r||void 0),console.log("Metadata synced to Supabase:",n)}catch(e){console.error("Supabase metadata sync failed (photo saved locally & on IPFS):",e)}return a},onSuccess:()=>{t.invalidateQueries({queryKey:["photos"]}),t.invalidateQueries({queryKey:["photoCount"]})}}),u=a7({mutationFn:async e=>{await oy(e)},onSuccess:()=>{t.invalidateQueries({queryKey:["photos"]}),t.invalidateQueries({queryKey:["photoCount"]})}}),c=(0,M.useCallback)(async t=>{if(!e||!t.encryptedBlob)return null;let r=await (0,aC.decryptFile)(t.encryptedBlob,t.nonce,e,t.mimeType);return r?URL.createObjectURL(r):null},[e]);return{photos:i,photoCount:o,isLoading:s,error:a,uploadPhoto:l.mutate,deletePhoto:u.mutate,decryptPhoto:c,isUploading:l.isPending,userKeyHash:r}}var uw=Object.defineProperty,u_=Object.getOwnPropertySymbols,uk=Object.prototype.hasOwnProperty,uj=Object.prototype.propertyIsEnumerable,uE=(e,t,r)=>t in e?uw(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,uS=(e,t)=>{for(var r in t||(t={}))uk.call(t,r)&&uE(e,r,t[r]);if(u_)for(var r of u_(t))uj.call(t,r)&&uE(e,r,t[r]);return e},uO=(e,t)=>{var r={};for(var n in e)uk.call(e,n)&&0>t.indexOf(n)&&(r[n]=e[n]);if(null!=e&&u_)for(var n of u_(e))0>t.indexOf(n)&&uj.call(e,n)&&(r[n]=e[n]);return r};(e=>{let t=class t{constructor(e,r,n,s){if(this.version=e,this.errorCorrectionLevel=r,this.modules=[],this.isFunction=[],e<t.MIN_VERSION||e>t.MAX_VERSION)throw RangeError("Version value out of range");if(s<-1||s>7)throw RangeError("Mask value out of range");this.size=4*e+17;let a=[];for(let e=0;e<this.size;e++)a.push(!1);for(let e=0;e<this.size;e++)this.modules.push(a.slice()),this.isFunction.push(a.slice());this.drawFunctionPatterns();const o=this.addEccAndInterleave(n);if(this.drawCodewords(o),-1==s){let e=1e9;for(let t=0;t<8;t++){this.applyMask(t),this.drawFormatBits(t);const r=this.getPenaltyScore();r<e&&(s=t,e=r),this.applyMask(t)}}i(0<=s&&s<=7),this.mask=s,this.applyMask(s),this.drawFormatBits(s),this.isFunction=[]}static encodeText(r,n){let i=e.QrSegment.makeSegments(r);return t.encodeSegments(i,n)}static encodeBinary(r,n){let i=e.QrSegment.makeBytes(r);return t.encodeSegments([i],n)}static encodeSegments(e,n,s=1,o=40,l=-1,u=!0){let c,d;if(!(t.MIN_VERSION<=s&&s<=o&&o<=t.MAX_VERSION)||l<-1||l>7)throw RangeError("Invalid value");for(c=s;;c++){let r=8*t.getNumDataCodewords(c,n),i=a.getTotalBits(e,c);if(i<=r){d=i;break}if(c>=o)throw RangeError("Data too long")}for(let e of[t.Ecc.MEDIUM,t.Ecc.QUARTILE,t.Ecc.HIGH])u&&d<=8*t.getNumDataCodewords(c,e)&&(n=e);let h=[];for(let t of e)for(let e of(r(t.mode.modeBits,4,h),r(t.numChars,t.mode.numCharCountBits(c),h),t.getData()))h.push(e);i(h.length==d);let f=8*t.getNumDataCodewords(c,n);i(h.length<=f),r(0,Math.min(4,f-h.length),h),r(0,(8-h.length%8)%8,h),i(h.length%8==0);for(let e=236;h.length<f;e^=253)r(e,8,h);let p=[];for(;8*p.length<h.length;)p.push(0);return h.forEach((e,t)=>p[t>>>3]|=e<<7-(7&t)),new t(c,n,p,l)}getModule(e,t){return 0<=e&&e<this.size&&0<=t&&t<this.size&&this.modules[t][e]}getModules(){return this.modules}drawFunctionPatterns(){for(let e=0;e<this.size;e++)this.setFunctionModule(6,e,e%2==0),this.setFunctionModule(e,6,e%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);let e=this.getAlignmentPatternPositions(),t=e.length;for(let r=0;r<t;r++)for(let n=0;n<t;n++)(0!=r||0!=n)&&(0!=r||n!=t-1)&&(r!=t-1||0!=n)&&this.drawAlignmentPattern(e[r],e[n]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(e){let t=this.errorCorrectionLevel.formatBits<<3|e,r=t;for(let e=0;e<10;e++)r=r<<1^(r>>>9)*1335;let s=(t<<10|r)^21522;i(s>>>15==0);for(let e=0;e<=5;e++)this.setFunctionModule(8,e,n(s,e));this.setFunctionModule(8,7,n(s,6)),this.setFunctionModule(8,8,n(s,7)),this.setFunctionModule(7,8,n(s,8));for(let e=9;e<15;e++)this.setFunctionModule(14-e,8,n(s,e));for(let e=0;e<8;e++)this.setFunctionModule(this.size-1-e,8,n(s,e));for(let e=8;e<15;e++)this.setFunctionModule(8,this.size-15+e,n(s,e));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let e=this.version;for(let t=0;t<12;t++)e=e<<1^(e>>>11)*7973;let t=this.version<<12|e;i(t>>>18==0);for(let e=0;e<18;e++){let r=n(t,e),i=this.size-11+e%3,s=Math.floor(e/3);this.setFunctionModule(i,s,r),this.setFunctionModule(s,i,r)}}drawFinderPattern(e,t){for(let r=-4;r<=4;r++)for(let n=-4;n<=4;n++){let i=Math.max(Math.abs(n),Math.abs(r)),s=e+n,a=t+r;0<=s&&s<this.size&&0<=a&&a<this.size&&this.setFunctionModule(s,a,2!=i&&4!=i)}}drawAlignmentPattern(e,t){for(let r=-2;r<=2;r++)for(let n=-2;n<=2;n++)this.setFunctionModule(e+n,t+r,1!=Math.max(Math.abs(n),Math.abs(r)))}setFunctionModule(e,t,r){this.modules[t][e]=r,this.isFunction[t][e]=!0}addEccAndInterleave(e){let r=this.version,n=this.errorCorrectionLevel;if(e.length!=t.getNumDataCodewords(r,n))throw RangeError("Invalid argument");let s=t.NUM_ERROR_CORRECTION_BLOCKS[n.ordinal][r],a=t.ECC_CODEWORDS_PER_BLOCK[n.ordinal][r],o=Math.floor(t.getNumRawDataModules(r)/8),l=s-o%s,u=Math.floor(o/s),c=[],d=t.reedSolomonComputeDivisor(a);for(let r=0,n=0;r<s;r++){let i=e.slice(n,n+u-a+(r<l?0:1));n+=i.length;let s=t.reedSolomonComputeRemainder(i,d);r<l&&i.push(0),c.push(i.concat(s))}let h=[];for(let e=0;e<c[0].length;e++)c.forEach((t,r)=>{(e!=u-a||r>=l)&&h.push(t[e])});return i(h.length==o),h}drawCodewords(e){if(e.length!=Math.floor(t.getNumRawDataModules(this.version)/8))throw RangeError("Invalid argument");let r=0;for(let t=this.size-1;t>=1;t-=2){6==t&&(t=5);for(let i=0;i<this.size;i++)for(let s=0;s<2;s++){let a=t-s,o=(t+1&2)==0?this.size-1-i:i;!this.isFunction[o][a]&&r<8*e.length&&(this.modules[o][a]=n(e[r>>>3],7-(7&r)),r++)}}i(r==8*e.length)}applyMask(e){if(e<0||e>7)throw RangeError("Mask value out of range");for(let t=0;t<this.size;t++)for(let r=0;r<this.size;r++){let n;switch(e){case 0:n=(r+t)%2==0;break;case 1:n=t%2==0;break;case 2:n=r%3==0;break;case 3:n=(r+t)%3==0;break;case 4:n=(Math.floor(r/3)+Math.floor(t/2))%2==0;break;case 5:n=r*t%2+r*t%3==0;break;case 6:n=(r*t%2+r*t%3)%2==0;break;case 7:n=((r+t)%2+r*t%3)%2==0;break;default:throw Error("Unreachable")}!this.isFunction[t][r]&&n&&(this.modules[t][r]=!this.modules[t][r])}}getPenaltyScore(){let e=0;for(let r=0;r<this.size;r++){let n=!1,i=0,s=[0,0,0,0,0,0,0];for(let a=0;a<this.size;a++)this.modules[r][a]==n?5==++i?e+=t.PENALTY_N1:i>5&&e++:(this.finderPenaltyAddHistory(i,s),n||(e+=this.finderPenaltyCountPatterns(s)*t.PENALTY_N3),n=this.modules[r][a],i=1);e+=this.finderPenaltyTerminateAndCount(n,i,s)*t.PENALTY_N3}for(let r=0;r<this.size;r++){let n=!1,i=0,s=[0,0,0,0,0,0,0];for(let a=0;a<this.size;a++)this.modules[a][r]==n?5==++i?e+=t.PENALTY_N1:i>5&&e++:(this.finderPenaltyAddHistory(i,s),n||(e+=this.finderPenaltyCountPatterns(s)*t.PENALTY_N3),n=this.modules[a][r],i=1);e+=this.finderPenaltyTerminateAndCount(n,i,s)*t.PENALTY_N3}for(let r=0;r<this.size-1;r++)for(let n=0;n<this.size-1;n++){let i=this.modules[r][n];i==this.modules[r][n+1]&&i==this.modules[r+1][n]&&i==this.modules[r+1][n+1]&&(e+=t.PENALTY_N2)}let r=0;for(let e of this.modules)r=e.reduce((e,t)=>e+ +!!t,r);let n=this.size*this.size,s=Math.ceil(Math.abs(20*r-10*n)/n)-1;return i(0<=s&&s<=9),i(0<=(e+=s*t.PENALTY_N4)&&e<=2568888),e}getAlignmentPatternPositions(){if(1==this.version)return[];{let e=Math.floor(this.version/7)+2,t=32==this.version?26:2*Math.ceil((4*this.version+4)/(2*e-2)),r=[6];for(let n=this.size-7;r.length<e;n-=t)r.splice(1,0,n);return r}}static getNumRawDataModules(e){if(e<t.MIN_VERSION||e>t.MAX_VERSION)throw RangeError("Version number out of range");let r=(16*e+128)*e+64;if(e>=2){let t=Math.floor(e/7)+2;r-=(25*t-10)*t-55,e>=7&&(r-=36)}return i(208<=r&&r<=29648),r}static getNumDataCodewords(e,r){return Math.floor(t.getNumRawDataModules(e)/8)-t.ECC_CODEWORDS_PER_BLOCK[r.ordinal][e]*t.NUM_ERROR_CORRECTION_BLOCKS[r.ordinal][e]}static reedSolomonComputeDivisor(e){if(e<1||e>255)throw RangeError("Degree out of range");let r=[];for(let t=0;t<e-1;t++)r.push(0);r.push(1);let n=1;for(let i=0;i<e;i++){for(let e=0;e<r.length;e++)r[e]=t.reedSolomonMultiply(r[e],n),e+1<r.length&&(r[e]^=r[e+1]);n=t.reedSolomonMultiply(n,2)}return r}static reedSolomonComputeRemainder(e,r){let n=r.map(e=>0);for(let i of e){let e=i^n.shift();n.push(0),r.forEach((r,i)=>n[i]^=t.reedSolomonMultiply(r,e))}return n}static reedSolomonMultiply(e,t){if(e>>>8!=0||t>>>8!=0)throw RangeError("Byte out of range");let r=0;for(let n=7;n>=0;n--)r=r<<1^(r>>>7)*285^(t>>>n&1)*e;return i(r>>>8==0),r}finderPenaltyCountPatterns(e){let t=e[1];i(t<=3*this.size);let r=t>0&&e[2]==t&&e[3]==3*t&&e[4]==t&&e[5]==t;return(r&&e[0]>=4*t&&e[6]>=t?1:0)+(r&&e[6]>=4*t&&e[0]>=t?1:0)}finderPenaltyTerminateAndCount(e,t,r){return e&&(this.finderPenaltyAddHistory(t,r),t=0),t+=this.size,this.finderPenaltyAddHistory(t,r),this.finderPenaltyCountPatterns(r)}finderPenaltyAddHistory(e,t){0==t[0]&&(e+=this.size),t.pop(),t.unshift(e)}};function r(e,t,r){if(t<0||t>31||e>>>t!=0)throw RangeError("Value out of range");for(let n=t-1;n>=0;n--)r.push(e>>>n&1)}function n(e,t){return(e>>>t&1)!=0}function i(e){if(!e)throw Error("Assertion error")}t.MIN_VERSION=1,t.MAX_VERSION=40,t.PENALTY_N1=3,t.PENALTY_N2=3,t.PENALTY_N3=40,t.PENALTY_N4=10,t.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],t.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],e.QrCode=t;let s=class e{constructor(e,t,r){if(this.mode=e,this.numChars=t,this.bitData=r,t<0)throw RangeError("Invalid argument");this.bitData=r.slice()}static makeBytes(t){let n=[];for(let e of t)r(e,8,n);return new e(e.Mode.BYTE,t.length,n)}static makeNumeric(t){if(!e.isNumeric(t))throw RangeError("String contains non-numeric characters");let n=[];for(let e=0;e<t.length;){let i=Math.min(t.length-e,3);r(parseInt(t.substring(e,e+i),10),3*i+1,n),e+=i}return new e(e.Mode.NUMERIC,t.length,n)}static makeAlphanumeric(t){let n;if(!e.isAlphanumeric(t))throw RangeError("String contains unencodable characters in alphanumeric mode");let i=[];for(n=0;n+2<=t.length;n+=2){let s=45*e.ALPHANUMERIC_CHARSET.indexOf(t.charAt(n));r(s+=e.ALPHANUMERIC_CHARSET.indexOf(t.charAt(n+1)),11,i)}return n<t.length&&r(e.ALPHANUMERIC_CHARSET.indexOf(t.charAt(n)),6,i),new e(e.Mode.ALPHANUMERIC,t.length,i)}static makeSegments(t){return""==t?[]:e.isNumeric(t)?[e.makeNumeric(t)]:e.isAlphanumeric(t)?[e.makeAlphanumeric(t)]:[e.makeBytes(e.toUtf8ByteArray(t))]}static makeEci(t){let n=[];if(t<0)throw RangeError("ECI assignment value out of range");if(t<128)r(t,8,n);else if(t<16384)r(2,2,n),r(t,14,n);else if(t<1e6)r(6,3,n),r(t,21,n);else throw RangeError("ECI assignment value out of range");return new e(e.Mode.ECI,0,n)}static isNumeric(t){return e.NUMERIC_REGEX.test(t)}static isAlphanumeric(t){return e.ALPHANUMERIC_REGEX.test(t)}getData(){return this.bitData.slice()}static getTotalBits(e,t){let r=0;for(let n of e){let e=n.mode.numCharCountBits(t);if(n.numChars>=1<<e)return 1/0;r+=4+e+n.bitData.length}return r}static toUtf8ByteArray(e){e=encodeURI(e);let t=[];for(let r=0;r<e.length;r++)"%"!=e.charAt(r)?t.push(e.charCodeAt(r)):(t.push(parseInt(e.substring(r+1,r+3),16)),r+=2);return t}};s.NUMERIC_REGEX=/^[0-9]*$/,s.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,s.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:";let a=s;e.QrSegment=s})(I||(I={})),_=(w=I||(I={})).QrCode||(w.QrCode={}),(s=class{constructor(e,t){this.ordinal=e,this.formatBits=t}}).LOW=new s(0,1),s.MEDIUM=new s(1,0),s.QUARTILE=new s(2,3),s.HIGH=new s(3,2),_.Ecc=s,j=(k=I||(I={})).QrSegment||(k.QrSegment={}),(a=class{constructor(e,t){this.modeBits=e,this.numBitsCharCount=t}numCharCountBits(e){return this.numBitsCharCount[Math.floor((e+7)/17)]}}).NUMERIC=new a(1,[10,12,14]),a.ALPHANUMERIC=new a(2,[9,11,13]),a.BYTE=new a(4,[8,16,16]),a.KANJI=new a(8,[8,10,12]),a.ECI=new a(7,[0,0,0]),j.Mode=a;var uT=I,uN={L:uT.QrCode.Ecc.LOW,M:uT.QrCode.Ecc.MEDIUM,Q:uT.QrCode.Ecc.QUARTILE,H:uT.QrCode.Ecc.HIGH},uA="#FFFFFF",uP="#000000";function uC(e,t=0){let r=[];return e.forEach(function(e,n){let i=null;e.forEach(function(s,a){if(!s&&null!==i){r.push(`M${i+t} ${n+t}h${a-i}v1H${i+t}z`),i=null;return}if(a===e.length-1){if(!s)return;null===i?r.push(`M${a+t},${n+t} h1v1H${a+t}z`):r.push(`M${i+t},${n+t} h${a+1-i}v1H${i+t}z`);return}s&&null===i&&(i=a)})}),r.join("")}function uz(e,t){return e.slice().map((e,r)=>r<t.y||r>=t.y+t.h?e:e.map((e,r)=>(r<t.x||r>=t.x+t.w)&&e))}function uR({value:e,level:t,minVersion:r,includeMargin:n,marginSize:i,imageSettings:s,size:a,boostLevel:o}){let l=M.default.useMemo(()=>{let n=(Array.isArray(e)?e:[e]).reduce((e,t)=>(e.push(...uT.QrSegment.makeSegments(t)),e),[]);return uT.QrCode.encodeSegments(n,uN[t],r,void 0,void 0,o)},[e,t,r,o]),{cells:u,margin:c,numCells:d,calculatedImageSettings:h}=M.default.useMemo(()=>{let e=l.getModules(),t=null!=i?Math.max(Math.floor(i),0):4*!!n,r=e.length+2*t,o=function(e,t,r,n){if(null==n)return null;let i=e.length+2*r,s=Math.floor(.1*t),a=i/t,o=(n.width||s)*a,l=(n.height||s)*a,u=null==n.x?e.length/2-o/2:n.x*a,c=null==n.y?e.length/2-l/2:n.y*a,d=null==n.opacity?1:n.opacity,h=null;if(n.excavate){let e=Math.floor(u),t=Math.floor(c),r=Math.ceil(o+u-e),n=Math.ceil(l+c-t);h={x:e,y:t,w:r,h:n}}return{x:u,y:c,h:l,w:o,excavation:h,opacity:d,crossOrigin:n.crossOrigin}}(e,a,t,s);return{cells:e,margin:t,numCells:r,calculatedImageSettings:o}},[l,a,s,n,i]);return{qrcode:l,margin:c,cells:u,numCells:d,calculatedImageSettings:h}}var u$=function(){try{new Path2D().addPath(new Path2D)}catch(e){return!1}return!0}();M.default.forwardRef(function(e,t){let{value:r,size:n=128,level:i="L",bgColor:s=uA,fgColor:a=uP,includeMargin:o=!1,minVersion:l=1,boostLevel:u,marginSize:c,imageSettings:d}=e,h=uO(e,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","marginSize","imageSettings"]),{style:f}=h,p=uO(h,["style"]),m=null==d?void 0:d.src,g=M.default.useRef(null),y=M.default.useRef(null),v=M.default.useCallback(e=>{g.current=e,"function"==typeof t?t(e):t&&(t.current=e)},[t]),[b,x]=M.default.useState(!1),{margin:w,cells:_,numCells:k,calculatedImageSettings:j}=uR({value:r,level:i,minVersion:l,boostLevel:u,includeMargin:o,marginSize:c,imageSettings:d,size:n});M.default.useEffect(()=>{if(null!=g.current){let e=g.current,t=e.getContext("2d");if(!t)return;let r=_,i=y.current,o=null!=j&&null!==i&&i.complete&&0!==i.naturalHeight&&0!==i.naturalWidth;o&&null!=j.excavation&&(r=uz(_,j.excavation));let l=window.devicePixelRatio||1;e.height=e.width=n*l;let u=n/k*l;t.scale(u,u),t.fillStyle=s,t.fillRect(0,0,k,k),t.fillStyle=a,u$?t.fill(new Path2D(uC(r,w))):_.forEach(function(e,r){e.forEach(function(e,n){e&&t.fillRect(n+w,r+w,1,1)})}),j&&(t.globalAlpha=j.opacity),o&&t.drawImage(i,j.x+w,j.y+w,j.w,j.h)}}),M.default.useEffect(()=>{x(!1)},[m]);let E=uS({height:n,width:n},f),S=null;return null!=m&&(S=M.default.createElement("img",{src:m,key:m,style:{display:"none"},onLoad:()=>{x(!0)},ref:y,crossOrigin:null==j?void 0:j.crossOrigin})),M.default.createElement(M.default.Fragment,null,M.default.createElement("canvas",uS({style:E,height:n,width:n,ref:v,role:"img"},p)),S)}).displayName="QRCodeCanvas";var uF=M.default.forwardRef(function(e,t){let{value:r,size:n=128,level:i="L",bgColor:s=uA,fgColor:a=uP,includeMargin:o=!1,minVersion:l=1,boostLevel:u,title:c,marginSize:d,imageSettings:h}=e,f=uO(e,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","title","marginSize","imageSettings"]),{margin:p,cells:m,numCells:g,calculatedImageSettings:y}=uR({value:r,level:i,minVersion:l,boostLevel:u,includeMargin:o,marginSize:d,imageSettings:h,size:n}),v=m,b=null;null!=h&&null!=y&&(null!=y.excavation&&(v=uz(m,y.excavation)),b=M.default.createElement("image",{href:h.src,height:y.h,width:y.w,x:y.x+p,y:y.y+p,preserveAspectRatio:"none",opacity:y.opacity,crossOrigin:y.crossOrigin}));let x=uC(v,p);return M.default.createElement("svg",uS({height:n,width:n,viewBox:`0 0 ${g} ${g}`,ref:t,role:"img"},f),!!c&&M.default.createElement("title",null,c),M.default.createElement("path",{fill:s,d:`M0,0 h${g}v${g}H0z`,shapeRendering:"crispEdges"}),M.default.createElement("path",{fill:a,d:x,shapeRendering:"crispEdges"}),b)});uF.displayName="QRCodeSVG";let uI=K("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),uD=K("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]),uM=K("QrCode",[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]]);function uU({isOpen:e,onClose:t}){let[r,n]=(0,M.useState)("show"),[i,s]=(0,M.useState)(""),[a,o]=(0,M.useState)(!1),[l,u]=(0,M.useState)(null),[c,d]=(0,M.useState)(!1),{recoveryPhrase:h,restoreFromPhrase:f}=aI(),p=async()=>{if(h)try{await navigator.clipboard.writeText(h),o(!0),setTimeout(()=>o(!1),2e3)}catch{console.error("Failed to copy to clipboard")}};return e?(0,D.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 px-4",children:(0,D.jsxs)("div",{className:"bg-white w-full max-w-[380px] rounded-2xl overflow-hidden",children:[(0,D.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-[#E5E5EA]",children:[(0,D.jsx)("h2",{className:"sf-pro-display text-[17px] font-semibold text-[#1D1D1F]",children:"Gert verbinden"}),(0,D.jsx)("button",{onClick:t,className:"w-8 h-8 flex items-center justify-center rounded-full bg-[#F2F2F7]",children:(0,D.jsx)(uI,{className:"w-4 h-4 text-[#6E6E73]"})})]}),(0,D.jsxs)("div",{className:"flex border-b border-[#E5E5EA]",children:[(0,D.jsxs)("button",{onClick:()=>n("show"),className:`flex-1 py-3 text-[15px] font-medium flex items-center justify-center gap-2 ${"show"===r?"text-[#007AFF] border-b-2 border-[#007AFF]":"text-[#6E6E73]"}`,children:[(0,D.jsx)(uM,{className:"w-4 h-4"}),"Schlssel zeigen"]}),(0,D.jsxs)("button",{onClick:()=>n("input"),className:`flex-1 py-3 text-[15px] font-medium flex items-center justify-center gap-2 ${"input"===r?"text-[#007AFF] border-b-2 border-[#007AFF]":"text-[#6E6E73]"}`,children:[(0,D.jsx)(uD,{className:"w-4 h-4"}),"Schlssel eingeben"]})]}),(0,D.jsx)("div",{className:"p-5",children:"show"===r?(0,D.jsxs)("div",{className:"flex flex-col items-center",children:[(0,D.jsx)("p",{className:"text-[13px] text-[#6E6E73] text-center mb-4",children:"Scanne diesen QR-Code mit deinem anderen Gert oder kopiere den Schlssel."}),h&&(0,D.jsx)("div",{className:"bg-white p-4 rounded-xl border border-[#E5E5EA] mb-4",children:(0,D.jsx)(uF,{value:h,size:180,level:"M",includeMargin:!1})}),(0,D.jsxs)("div",{className:"w-full bg-[#F2F2F7] rounded-xl p-3 mb-4",children:[(0,D.jsx)("p",{className:"text-[11px] text-[#6E6E73] mb-1",children:"Dein Schlssel:"}),(0,D.jsx)("p",{className:"text-[13px] font-mono text-[#1D1D1F] break-all leading-relaxed",children:h||"Kein Schlssel verfgbar"})]}),(0,D.jsx)("button",{onClick:p,disabled:!h,className:"w-full h-[44px] bg-[#007AFF] text-white text-[15px] font-semibold rounded-xl flex items-center justify-center gap-2 disabled:opacity-50",children:a?(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(aR,{className:"w-4 h-4"}),"Kopiert!"]}):(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(a$,{className:"w-4 h-4"}),"Schlssel kopieren"]})})]}):(0,D.jsxs)("div",{className:"flex flex-col",children:[(0,D.jsx)("p",{className:"text-[13px] text-[#6E6E73] text-center mb-4",children:"Gib den Schlssel von deinem anderen Gert ein, um deine Fotos zu synchronisieren."}),(0,D.jsx)("textarea",{value:i,onChange:e=>{s(e.target.value),u(null)},placeholder:"Schlssel hier eingeben...",className:"w-full h-[100px] bg-[#F2F2F7] rounded-xl p-3 text-[14px] font-mono text-[#1D1D1F] resize-none mb-3 placeholder:text-[#C7C7CC]"}),l&&(0,D.jsx)("p",{className:"text-[13px] text-[#FF3B30] text-center mb-3",children:l}),c&&(0,D.jsx)("p",{className:"text-[13px] text-[#30D158] text-center mb-3",children:"Schlssel erfolgreich importiert!"}),(0,D.jsxs)("button",{onClick:()=>{(u(null),i.trim())?f(i.trim())?(d(!0),s(""),setTimeout(()=>{d(!1),t()},1500)):u("Ungltiger Schlssel. Bitte berprfe die Eingabe."):u("Bitte gib einen Schlssel ein")},disabled:!i.trim()||c,className:"w-full h-[44px] bg-[#30D158] text-white text-[15px] font-semibold rounded-xl flex items-center justify-center gap-2 disabled:opacity-50",children:[(0,D.jsx)(uD,{className:"w-4 h-4"}),"Gert verbinden"]}),(0,D.jsx)("p",{className:"text-[11px] text-[#FF9500] text-center mt-4",children:"Achtung: Dies berschreibt deinen aktuellen Schlssel. Stelle sicher, dass du ihn gesichert hast."})]})})]})}):null}let uL=e=>{let t,r=new Set,n=(e,n)=>{let i="function"==typeof e?e(t):e;if(!Object.is(i,t)){let e=t;t=(null!=n?n:"object"!=typeof i||null===i)?i:Object.assign({},t,i),r.forEach(r=>r(t,e))}},i=()=>t,s={setState:n,getState:i,getInitialState:()=>a,subscribe:e=>(r.add(e),()=>r.delete(e))},a=t=e(n,i,s);return s},uB=e=>{let t=e?uL(e):uL,r=e=>(function(e,t=e=>e){let r=M.default.useSyncExternalStore(e.subscribe,M.default.useCallback(()=>t(e.getState()),[e,t]),M.default.useCallback(()=>t(e.getInitialState()),[e,t]));return M.default.useDebugValue(r),r})(t,e);return Object.assign(r,t),r};function uK(e,t){let r;try{r=e()}catch(e){return}return{getItem:e=>{var n;let i=e=>null===e?null:JSON.parse(e,null==t?void 0:t.reviver),s=null!=(n=r.getItem(e))?n:null;return s instanceof Promise?s.then(i):i(s)},setItem:(e,n)=>r.setItem(e,JSON.stringify(n,null==t?void 0:t.replacer)),removeItem:e=>r.removeItem(e)}}let uZ=e=>t=>{try{let r=e(t);if(r instanceof Promise)return r;return{then:e=>uZ(e)(r),catch(e){return this}}}catch(e){return{then(e){return this},catch:t=>uZ(t)(e)}}},uq=(o?uB(o):uB)((l=e=>({backupActive:!1,autoBackupEnabled:!0,backgroundBackupEnabled:!1,selectedPlan:"free",lastBackup:"Noch nie",permanence:0,setBackupActive:t=>e({backupActive:t}),setAutoBackupEnabled:t=>e({autoBackupEnabled:t}),setBackgroundBackupEnabled:t=>e({backgroundBackupEnabled:t}),setSelectedPlan:t=>e({selectedPlan:t}),setLastBackup:t=>e({lastBackup:t}),setPermanence:t=>e({permanence:t})}),u={name:"photovault-settings",storage:uK(()=>localStorage)},(e,t,r)=>{let n,i={storage:uK(()=>localStorage),partialize:e=>e,version:0,merge:(e,t)=>({...t,...e}),...u},s=!1,a=0,o=new Set,c=new Set,d=i.storage;if(!d)return l((...t)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),e(...t)},t,r);let h=()=>{let e=i.partialize({...t()});return d.setItem(i.name,{state:e,version:i.version})},f=r.setState;r.setState=(e,t)=>(f(e,t),h());let p=l((...t)=>(e(...t),h()),t,r);r.getInitialState=()=>p;let m=()=>{var r,l;if(!d)return;let u=++a;s=!1,o.forEach(e=>{var r;return e(null!=(r=t())?r:p)});let f=(null==(l=i.onRehydrateStorage)?void 0:l.call(i,null!=(r=t())?r:p))||void 0;return uZ(d.getItem.bind(d))(i.name).then(e=>{if(e)if("number"!=typeof e.version||e.version===i.version)return[!1,e.state];else{if(i.migrate){let t=i.migrate(e.state,e.version);return t instanceof Promise?t.then(e=>[!0,e]):[!0,t]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}return[!1,void 0]}).then(r=>{var s;if(u!==a)return;let[o,l]=r;if(e(n=i.merge(l,null!=(s=t())?s:p),!0),o)return h()}).then(()=>{u===a&&(null==f||f(n,void 0),n=t(),s=!0,c.forEach(e=>e(n)))}).catch(e=>{u===a&&(null==f||f(void 0,e))})};return r.persist={setOptions:e=>{i={...i,...e},e.storage&&(d=e.storage)},clearStorage:()=>{null==d||d.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>m(),hasHydrated:()=>s,onHydrate:e=>(o.add(e),()=>{o.delete(e)}),onFinishHydration:e=>(c.add(e),()=>{c.delete(e)})},i.skipHydration||m(),n||p}));function uV({state:e,setState:t}){let[r,n]=(0,M.useState)(null),[i,s]=(0,M.useState)(!1),[a,o]=(0,M.useState)(!1),[l,u]=(0,M.useState)(!1),[c,d]=(0,M.useState)({current:0,total:0}),h=uq(e=>e.backupActive),f=uq(e=>e.setBackupActive),p=uq(e=>e.lastBackup),m=uq(e=>e.setLastBackup),g=uq(e=>e.permanence),{secretKey:y,hasKey:v}=aI(),{photoCount:b,userKeyHash:x}=ux(v?y:null),w=b>0?b:e.photosCount,_=async()=>{if(!l&&y){u(!0),console.log("Starting backup to IPFS...");try{let e=(await og()).filter(e=>e.encryptedBlob);d({current:0,total:e.length});let t=0,r=(0,ub.getDeviceId)(),n=x||await (0,aC.getUserKeyHash)(y);for(let i of e)if(i.encryptedBlob)try{if(!await uc(i.cid)){let e=await ug(i.encryptedBlob,i.fileName);console.log(`Uploaded to IPFS: ${e}`),await ul(e,i.fileSize,r,i.nonce,i.mimeType,n)}t++,d({current:t,total:e.length})}catch(e){console.error(`Failed to upload ${i.cid}:`,e)}m("Gerade eben"),console.log(`Backup complete: ${t} photos processed`)}catch(e){console.error("Backup failed:",e)}finally{u(!1),d({current:0,total:0})}}};return(0,D.jsxs)("div",{className:"h-full flex flex-col px-5 pt-6 pb-4 overflow-y-auto",children:[(0,D.jsxs)("header",{className:"mb-6",children:[(0,D.jsx)("h1",{className:"sf-pro-display text-[28px] text-[#1D1D1F]",children:"Backup"}),(0,D.jsx)("p",{className:"text-[15px] text-[#6E6E73] mt-1",children:"Verschlsseltes Photo-Backup"})]}),(0,D.jsx)("button",{onClick:()=>{s(!0)},className:"w-full bg-white rounded-xl p-5 mb-3 ios-tap-target",children:(0,D.jsxs)("div",{className:"flex items-center justify-between",children:[(0,D.jsxs)("div",{className:"flex items-center gap-4",children:[(0,D.jsx)("div",{className:`w-14 h-14 rounded-full flex items-center justify-center ${h?"bg-[#30D158]/10":"bg-[#E5E5EA]"}`,children:(0,D.jsx)(ez,{name:"shield",size:28})}),(0,D.jsxs)("div",{className:"text-left",children:[(0,D.jsxs)("p",{className:"text-[17px] font-semibold text-[#1D1D1F]",children:["Backup ",h?"Aktiv":"Aus"]}),(0,D.jsx)("p",{className:"text-[15px] text-[#6E6E73]",children:h?"Deine Fotos werden geschtzt":"Tippe zum Aktivieren"})]})]}),(0,D.jsx)("div",{className:`w-[51px] h-[31px] rounded-full p-[2px] ${h?"bg-[#30D158]":"bg-[#E5E5EA]"}`,children:(0,D.jsx)("div",{className:`w-[27px] h-[27px] rounded-full bg-white shadow-sm transition-transform duration-200 transform ${h?"translate-x-5":""}`})})]})}),(0,D.jsx)("p",{className:"text-[13px] text-[#6E6E73] px-2 mb-6",children:"Automatisch neue Fotos sichern"}),(0,D.jsxs)("div",{className:"grid grid-cols-3 gap-3 mb-6",children:[(0,D.jsx)(uJ,{icon:(0,D.jsx)(ez,{name:"image",size:20}),value:w.toLocaleString(),label:"Fotos gesichert",tooltip:"Lokal auf deinen Gerten gespeichert",showTooltip:"photos"===r,onTap:()=>n("photos"===r?null:"photos")}),(0,D.jsx)(uJ,{icon:(0,D.jsx)(ez,{name:"clock",size:20}),value:p,label:"Letztes Backup",tooltip:"Automatisches Backup alle 6 Stunden",showTooltip:"lastBackup"===r,onTap:()=>n("lastBackup"===r?null:"lastBackup")}),(0,D.jsx)(uJ,{icon:(0,D.jsx)(ez,{name:"shield",size:20}),value:`${g}%`,label:"Dauerhaft",tooltip:"Fotos sind auf mehreren Gerten gesichert",showTooltip:"permanence"===r,onTap:()=>n("permanence"===r?null:"permanence")})]}),(0,D.jsx)("button",{onClick:_,disabled:l,className:`w-full h-[50px] text-[17px] font-semibold rounded-xl mb-3 ios-tap-target ${h?"bg-[#007AFF] text-white":"bg-[#30D158] text-white"} disabled:opacity-70 flex items-center justify-center`,children:l?(0,D.jsxs)("span",{className:"flex items-center justify-center gap-2",children:[(0,D.jsx)(aL,{className:"w-5 h-5 animate-spin"}),c.total>0?`${c.current}/${c.total} hochladen...`:"Vorbereiten..."]}):h?"Jetzt sichern":"Backup aktivieren"}),(0,D.jsxs)("button",{onClick:()=>o(!0),className:"w-full h-[50px] text-[17px] font-semibold rounded-xl mb-4 ios-tap-target bg-[#F2F2F7] text-[#007AFF] flex items-center justify-center gap-2",children:[(0,D.jsx)(aU,{className:"w-5 h-5"}),"Gert verbinden"]}),(0,D.jsx)("div",{className:"mt-auto pt-4",children:(0,D.jsxs)("p",{className:"text-[15px] text-[#8E8E93] text-center leading-relaxed",children:["Deine Fotos sind verschlsselt.",(0,D.jsx)("br",{}),"Niemand kann sie sehen."]})}),i&&(0,D.jsx)("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 px-8",children:(0,D.jsxs)("div",{className:"bg-white w-full max-w-[270px] rounded-2xl overflow-hidden",children:[(0,D.jsxs)("div",{className:"p-4 text-center",children:[(0,D.jsx)("h3",{className:"sf-pro-display text-[17px] text-[#1D1D1F] mb-1",children:h?"Backup deaktivieren?":"Backup aktivieren?"}),(0,D.jsx)("p",{className:"text-[13px] text-[#6E6E73] leading-relaxed",children:h?"Neue Fotos werden nicht mehr automatisch gesichert.":"Neue Fotos werden automatisch verschlsselt und gesichert."})]}),(0,D.jsxs)("div",{className:"border-t border-[#E5E5EA]",children:[(0,D.jsx)("button",{onClick:()=>s(!1),className:"w-full py-3 text-[17px] text-[#007AFF] border-b border-[#E5E5EA] ios-tap-target",children:"Abbrechen"}),(0,D.jsx)("button",{onClick:()=>{f(!h),s(!1)},className:`w-full py-3 text-[17px] font-semibold ios-tap-target ${h?"text-[#FF3B30]":"text-[#30D158]"}`,children:h?"Deaktivieren":"Aktivieren"})]})]})}),(0,D.jsx)(uU,{isOpen:a,onClose:()=>o(!1)})]})}function uJ({icon:e,value:t,label:r,tooltip:n,showTooltip:i,onTap:s}){return(0,D.jsxs)("div",{className:"relative",children:[(0,D.jsxs)("button",{onClick:s,className:"w-full bg-white rounded-xl p-4 text-center ios-tap-target",children:[(0,D.jsxs)("div",{className:"flex justify-center mb-2 relative",children:[e,(0,D.jsx)(aM,{className:"w-3 h-3 text-[#C7C7CC] absolute -right-1 -top-1"})]}),(0,D.jsx)("p",{className:"text-[17px] font-semibold text-[#1D1D1F] truncate",children:t}),(0,D.jsx)("p",{className:"text-[11px] text-[#6E6E73]",children:r})]}),i&&(0,D.jsxs)("div",{className:"absolute left-1/2 -translate-x-1/2 bottom-full mb-2 w-[180px] bg-[#1D1D1F] text-white text-[13px] p-3 rounded-lg z-10 text-center",children:[n,(0,D.jsx)("div",{className:"absolute left-1/2 -translate-x-1/2 top-full w-0 h-0 border-l-[6px] border-r-[6px] border-t-[6px] border-transparent border-t-[#1D1D1F]"})]})]})}let uW=K("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);function uG({state:t,setState:r,onRestartOnboarding:n}){let[i,s]=(0,M.useState)(!1),[a,o]=(0,M.useState)(!1),[l,u]=(0,M.useState)(!1),[c,d]=(0,M.useState)(!1),[h,f]=(0,M.useState)(!1),[p,m]=(0,M.useState)(!1),[g,y]=(0,M.useState)([]),v=uq(e=>e.autoBackupEnabled),b=uq(e=>e.setAutoBackupEnabled),x=uq(e=>e.backgroundBackupEnabled),w=uq(e=>e.setBackgroundBackupEnabled),_=uq(e=>e.selectedPlan),k=uq(e=>e.setSelectedPlan),{secretKey:j,recoveryPhrase:E,generateNewKey:S,clearKey:O}=aI(),T=(0,ub.getDeviceId)(),[N,A]=(0,M.useState)(null);(0,M.useEffect)(()=>{j&&e.A(88936).then(e=>e.getUserKeyHash(j)).then(A)},[j]),(0,M.useEffect)(()=>{N&&(async()=>{try{let e=await uh(N);y(e)}catch(e){console.error("Failed to fetch devices:",e)}})()},[N]);let P=E?.split("-").slice(0,12)||[],C=async()=>{O(),await S()&&r(e=>({...e,photosCount:0})),u(!1)},[z,R]=(0,M.useState)(!1);if(i){let e=g.map(e=>({id:e.id,name:e.device_name||"Unbekanntes Gert",lastActive:e.id===T?"Aktiv":function(e){if(!e)return"Unbekannt";let t=new Date(e),r=new Date().getTime()-t.getTime(),n=Math.floor(r/6e4),i=Math.floor(r/36e5),s=Math.floor(r/864e5);return n<1?"Gerade eben":n<60?`vor ${n} Min.`:i<24?`vor ${i} Std.`:s<7?`vor ${s} Tagen`:t.toLocaleDateString("de-DE")}(e.created_at),syncing:!1}));return 0===e.length&&e.push({id:T,name:"Dieses Gert",lastActive:"Aktiv",syncing:!1}),(0,D.jsx)(uQ,{devices:e,onBack:()=>s(!1),onAddDevice:()=>{s(!1),R(!0)}})}return(0,D.jsxs)("div",{className:"h-full flex flex-col pb-4 overflow-y-auto",children:[(0,D.jsx)("header",{className:"px-5 pt-6 pb-4 bg-[#F2F2F7]",children:(0,D.jsx)("h1",{className:"sf-pro-display text-[28px] text-[#1D1D1F]",children:"Einstellungen"})}),(0,D.jsxs)("div",{className:"flex-1 px-5",children:[(0,D.jsxs)("div",{className:"mb-6",children:[(0,D.jsx)("h2",{className:"text-[13px] font-semibold text-[#6E6E73] uppercase tracking-wide px-4 mb-2",children:"Backup"}),(0,D.jsxs)("div",{className:"bg-white rounded-xl overflow-hidden",children:[(0,D.jsx)(uH,{label:"Automatisches Backup",description:"Neue Fotos automatisch sichern",enabled:v,onToggle:()=>{b(!v)}}),(0,D.jsx)("div",{className:"h-[0.5px] bg-[#E5E5EA] ml-4"}),(0,D.jsx)(uH,{label:"Hintergrund-Backup",description:"Weiter sichern wenn App geschlossen",enabled:x,onToggle:()=>{w(!x)}}),(0,D.jsx)("div",{className:"h-[0.5px] bg-[#E5E5EA] ml-4"}),(0,D.jsxs)("button",{onClick:()=>f(!0),className:"w-full flex items-center justify-between p-4 ios-tap-target",children:[(0,D.jsxs)("div",{className:"flex items-center gap-3",children:[(0,D.jsx)(ez,{name:"folder",size:24}),(0,D.jsxs)("div",{className:"text-left",children:[(0,D.jsx)("span",{className:"text-[17px] text-[#1D1D1F] block",children:"Backup-Quelle"}),(0,D.jsx)("span",{className:"text-[13px] text-[#6E6E73]",children:"photos-app"===t.photoSource?"Fotos-App":"Dateien-App"})]})]}),(0,D.jsx)(ez,{name:"chevronRight",size:16})]})]})]}),(0,D.jsxs)("div",{className:"mb-6",children:[(0,D.jsx)("h2",{className:"text-[13px] font-semibold text-[#6E6E73] uppercase tracking-wide px-4 mb-2",children:"Speicher"}),(0,D.jsxs)("div",{className:"bg-white rounded-xl overflow-hidden",children:[(0,D.jsxs)("div",{className:"p-4",children:[(0,D.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,D.jsx)("span",{className:"text-[17px] text-[#1D1D1F]",children:"Aktueller Plan"}),(0,D.jsx)("span",{className:"text-[15px] font-semibold text-[#007AFF]",children:"free"===_?"Free":"Backup+"})]}),(0,D.jsx)("p",{className:"text-[13px] text-[#6E6E73]",children:"free"===_?"Fotos auf deinen Gerten":"200 GB Cloud-Backup"})]}),(0,D.jsx)("div",{className:"h-[0.5px] bg-[#E5E5EA] ml-4"}),(0,D.jsx)("div",{className:"p-4",children:(0,D.jsxs)("div",{className:"flex items-center justify-between",children:[(0,D.jsx)("span",{className:"text-[15px] text-[#6E6E73]",children:"Verwendet"}),(0,D.jsxs)("span",{className:"text-[15px] text-[#1D1D1F]",children:[t.photosCount.toLocaleString()," Fotos (nur lokal)"]})]})}),(0,D.jsx)("div",{className:"h-[0.5px] bg-[#E5E5EA] ml-4"}),(0,D.jsxs)("button",{onClick:()=>m(!0),className:"w-full flex items-center justify-between p-4 ios-tap-target",children:[(0,D.jsx)("span",{className:"text-[17px] text-[#007AFF]",children:"free"===_?"Upgrade zu Backup+":"Plan verwalten"}),(0,D.jsx)(ez,{name:"chevronRight",size:16})]})]})]}),(0,D.jsxs)("div",{className:"mb-6",children:[(0,D.jsx)("h2",{className:"text-[13px] font-semibold text-[#6E6E73] uppercase tracking-wide px-4 mb-2",children:"Gerte"}),(0,D.jsx)("div",{className:"bg-white rounded-xl overflow-hidden",children:(0,D.jsxs)("button",{onClick:()=>{console.log("Fetch Device List"),s(!0)},className:"w-full flex items-center justify-between p-4 ios-tap-target",children:[(0,D.jsxs)("div",{className:"flex items-center gap-3",children:[(0,D.jsx)(ez,{name:"smartphone",size:24}),(0,D.jsx)("span",{className:"text-[17px] text-[#1D1D1F]",children:"Verbundene Gerte"})]}),(0,D.jsxs)("div",{className:"flex items-center gap-2",children:[(0,D.jsx)("span",{className:"text-[15px] text-[#6E6E73]",children:g.length||1}),(0,D.jsx)(ez,{name:"chevronRight",size:16})]})]})})]}),(0,D.jsxs)("div",{className:"mb-6",children:[(0,D.jsx)("h2",{className:"text-[13px] font-semibold text-[#6E6E73] uppercase tracking-wide px-4 mb-2",children:"Sicherheit"}),(0,D.jsxs)("div",{className:"bg-white rounded-xl overflow-hidden",children:[(0,D.jsxs)("button",{onClick:()=>o(!0),className:"w-full flex items-center justify-between p-4 ios-tap-target",children:[(0,D.jsx)("span",{className:"text-[17px] text-[#1D1D1F]",children:"Backup-Phrase anzeigen"}),(0,D.jsx)(ez,{name:"chevronRight",size:16})]}),(0,D.jsx)("div",{className:"h-[0.5px] bg-[#E5E5EA] ml-4"}),(0,D.jsxs)("button",{onClick:()=>u(!0),className:"w-full flex items-center justify-between p-4 ios-tap-target",children:[(0,D.jsx)("span",{className:"text-[17px] text-[#FF3B30]",children:"Neuen Schlssel erstellen"}),(0,D.jsx)(ez,{name:"chevronRight",size:16})]})]}),(0,D.jsx)("p",{className:"text-[13px] text-[#6E6E73] px-4 mt-2",children:"Teile diese Wrter niemals mit anderen."})]}),(0,D.jsxs)("div",{className:"mb-6",children:[(0,D.jsx)("h2",{className:"text-[13px] font-semibold text-[#6E6E73] uppercase tracking-wide px-4 mb-2",children:"Setup"}),(0,D.jsx)("div",{className:"bg-white rounded-xl overflow-hidden",children:(0,D.jsxs)("button",{onClick:()=>{console.log("TODO: Navigate to onboarding screen 1"),n()},className:"w-full flex items-center justify-between p-4 ios-tap-target",children:[(0,D.jsxs)("div",{className:"flex items-center gap-3",children:[(0,D.jsx)(ez,{name:"refresh",size:24}),(0,D.jsx)("span",{className:"text-[17px] text-[#1D1D1F]",children:"Onboarding wiederholen"})]}),(0,D.jsx)(ez,{name:"chevronRight",size:16})]})}),(0,D.jsx)("p",{className:"text-[13px] text-[#6E6E73] px-4 mt-2",children:"Schlssel, Quelle und Plan neu einrichten"})]})]}),a&&(0,D.jsx)(u0,{title:"Sicherheitshinweis",message:"Deine Backup-Phrase gibt vollen Zugriff auf deine verschlsselten Fotos. Nur an einem privaten Ort anzeigen.",confirmLabel:"Phrase anzeigen",confirmDestructive:!1,onConfirm:()=>{o(!1),d(!0)},onCancel:()=>o(!1)}),c&&(0,D.jsx)("div",{className:"fixed inset-0 bg-black/40 flex items-end justify-center z-50",children:(0,D.jsxs)("div",{className:"bg-white w-full max-w-[428px] rounded-t-2xl p-6 pb-10",children:[(0,D.jsx)("h3",{className:"sf-pro-display text-[20px] text-[#1D1D1F] text-center mb-2",children:"Deine Backup-Phrase"}),(0,D.jsx)("p",{className:"text-[15px] text-[#6E6E73] text-center mb-4",children:"Notiere diese Wrter und bewahre sie sicher auf."}),P.length>0?(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)("div",{className:"grid grid-cols-3 gap-2 mb-4",children:P.map((e,t)=>(0,D.jsxs)("div",{className:"bg-[#F2F2F7] rounded-lg p-2 text-center",children:[(0,D.jsx)("span",{className:"text-[11px] text-[#8E8E93] block",children:t+1}),(0,D.jsx)("span",{className:"text-[14px] text-[#1D1D1F] font-mono",children:e})]},t))}),(0,D.jsxs)("div",{className:"bg-[#F2F2F7] rounded-xl p-3 mb-4",children:[(0,D.jsx)("p",{className:"text-[11px] text-[#6E6E73] mb-1",children:"Vollstndiger Schlssel:"}),(0,D.jsx)("p",{className:"text-[12px] font-mono text-[#1D1D1F] break-all",children:E})]})]}):(0,D.jsx)("div",{className:"bg-[#FF9500]/10 rounded-xl p-4 mb-4",children:(0,D.jsx)("p",{className:"text-[13px] text-[#FF9500] text-center",children:"Kein Schlssel gefunden. Bitte erstelle einen neuen Schlssel."})}),(0,D.jsx)("div",{className:"bg-[#FF3B30]/10 rounded-xl p-3 mb-4",children:(0,D.jsx)("p",{className:"text-[13px] text-[#FF3B30] text-center",children:" Teile diese Wrter niemals mit anderen"})}),(0,D.jsx)("button",{onClick:()=>d(!1),className:"w-full h-[50px] bg-[#007AFF] text-white text-[17px] font-semibold rounded-xl ios-tap-target",children:"Fertig"})]})}),l&&(0,D.jsx)(u0,{title:"Datenverlust-Warnung",message:"Das Erstellen eines neuen Schlssels lscht alle vorhandenen Backup-Daten permanent. Diese Aktion kann nicht rckgngig gemacht werden.",confirmLabel:"Neuen Schlssel erstellen",confirmDestructive:!0,onConfirm:C,onCancel:()=>u(!1)}),h&&(0,D.jsx)(uY,{currentSource:t.photoSource,onSelect:e=>{console.log("Update backup source preference:",e),r(t=>({...t,photoSource:e})),f(!1)},onClose:()=>f(!1)}),p&&(0,D.jsx)(uX,{currentPlan:_,onSelect:e=>{console.log("Update plan:",e),k(e),m(!1)},onClose:()=>m(!1)}),(0,D.jsx)(uU,{isOpen:z,onClose:()=>R(!1)})]})}function uH({label:e,description:t,enabled:r,onToggle:n}){return(0,D.jsxs)("button",{onClick:n,className:"w-full flex items-center justify-between p-4 ios-tap-target",children:[(0,D.jsxs)("div",{className:"text-left",children:[(0,D.jsx)("p",{className:"text-[17px] text-[#1D1D1F]",children:e}),(0,D.jsx)("p",{className:"text-[13px] text-[#6E6E73] mt-0.5",children:t})]}),(0,D.jsx)("div",{className:`w-[51px] h-[31px] rounded-full p-[2px] shrink-0 ${r?"bg-[#30D158]":"bg-[#E5E5EA]"}`,children:(0,D.jsx)("div",{className:`w-[27px] h-[27px] rounded-full bg-white shadow-sm ${r?"ml-auto":""}`})})]})}function uQ({devices:e,onBack:t,onAddDevice:r}){return(0,D.jsxs)("div",{className:"h-full flex flex-col pb-4 overflow-y-auto",children:[(0,D.jsxs)("header",{className:"px-5 pt-6 pb-4 bg-[#F2F2F7]",children:[(0,D.jsx)("button",{onClick:t,className:"text-[#007AFF] text-[17px] ios-tap-target mb-2",children:" Zurck"}),(0,D.jsx)("h1",{className:"sf-pro-display text-[28px] text-[#1D1D1F]",children:"Gerte"})]}),(0,D.jsxs)("div",{className:"flex-1 px-5",children:[(0,D.jsx)("div",{className:"bg-white rounded-xl overflow-hidden",children:e.map((e,t)=>(0,D.jsxs)("div",{children:[t>0&&(0,D.jsx)("div",{className:"h-[0.5px] bg-[#E5E5EA] ml-4"}),(0,D.jsxs)("div",{className:"flex items-center gap-3 p-4",children:[(0,D.jsx)(ez,{name:"smartphone",size:32}),(0,D.jsxs)("div",{className:"flex-1",children:[(0,D.jsx)("p",{className:"text-[17px] text-[#1D1D1F]",children:e.name}),(0,D.jsx)("p",{className:"text-[13px] text-[#6E6E73]",children:e.lastActive})]}),e.syncing?(0,D.jsx)(aL,{className:"w-5 h-5 text-[#007AFF] animate-spin"}):"Aktiv"===e.lastActive?(0,D.jsxs)("div",{className:"flex items-center gap-1",children:[(0,D.jsx)(aR,{className:"w-4 h-4 text-[#30D158]"}),(0,D.jsx)("span",{className:"text-[13px] text-[#30D158] font-medium",children:"Dieses Gert"})]}):null]})]},e.id))}),(0,D.jsxs)("button",{onClick:r,className:"w-full flex items-center justify-center gap-2 mt-6 p-4 bg-white rounded-xl ios-tap-target",children:[(0,D.jsx)(uW,{className:"w-5 h-5 text-[#007AFF]"}),(0,D.jsx)("span",{className:"text-[17px] text-[#007AFF]",children:"Neues Gert verbinden"})]}),(0,D.jsx)("p",{className:"text-[13px] text-[#6E6E73] text-center mt-3",children:"Scanne den QR-Code oder gib deine Backup-Phrase ein"})]})]})}function uY({currentSource:e,onSelect:t,onClose:r}){return(0,D.jsx)("div",{className:"fixed inset-0 bg-black/40 flex items-end justify-center z-50",children:(0,D.jsxs)("div",{className:"bg-white w-full max-w-[428px] rounded-t-2xl p-6 pb-10",children:[(0,D.jsx)("h3",{className:"sf-pro-display text-[20px] text-[#1D1D1F] text-center mb-2",children:"Backup-Quelle"}),(0,D.jsx)("p",{className:"text-[15px] text-[#6E6E73] text-center mb-6",children:"Wo sind deine Fotos gespeichert?"}),(0,D.jsx)("div",{className:"space-y-3 mb-6",children:[{id:"photos-app",label:"Fotos-App",description:"Alle Fotos aus der iOS Foto-Bibliothek"},{id:"files-app",label:"Dateien-App",description:"Fotos aus einem bestimmten Ordner"}].map(r=>(0,D.jsx)("button",{onClick:()=>t(r.id),className:`w-full p-4 rounded-xl bg-[#F2F2F7] text-left ios-tap-target ${e===r.id?"ring-2 ring-[#007AFF]":""}`,children:(0,D.jsxs)("div",{className:"flex items-center justify-between",children:[(0,D.jsxs)("div",{children:[(0,D.jsx)("p",{className:"text-[17px] font-medium text-[#1D1D1F]",children:r.label}),(0,D.jsx)("p",{className:"text-[13px] text-[#6E6E73] mt-0.5",children:r.description})]}),(0,D.jsx)("div",{className:`w-6 h-6 rounded-full border-2 flex items-center justify-center ${e===r.id?"border-[#007AFF] bg-[#007AFF]":"border-[#C7C7CC]"}`,children:e===r.id&&(0,D.jsx)("div",{className:"w-2.5 h-2.5 rounded-full bg-white"})})]})},r.id))}),(0,D.jsx)("button",{onClick:r,className:"w-full h-[44px] text-[#007AFF] text-[17px] ios-tap-target",children:"Abbrechen"})]})})}function uX({currentPlan:e,onSelect:t,onClose:r}){return(0,D.jsx)("div",{className:"fixed inset-0 bg-black/40 flex items-end justify-center z-50",children:(0,D.jsxs)("div",{className:"bg-white w-full max-w-[428px] rounded-t-2xl p-6 pb-10 max-h-[80vh] overflow-y-auto",children:[(0,D.jsx)("h3",{className:"sf-pro-display text-[20px] text-[#1D1D1F] text-center mb-2",children:"Speicherplan"}),(0,D.jsx)("p",{className:"text-[15px] text-[#6E6E73] text-center mb-6",children:"Du kannst jederzeit wechseln"}),(0,D.jsx)("div",{className:"space-y-3 mb-6",children:[{id:"free",label:"FREE",subtitle:"Auf deinen Gerten",price:"0/Monat",features:["Unbegrenzte Fotos","Zero-Knowledge Verschlsselung","Multi-Device Sync"]},{id:"backup-plus",label:"BACKUP+",subtitle:"Dauerhaft im Netz",price:"2,99/Monat",features:["Alles von Free","200 GB Cloud-Backup","Schnellere Synchronisierung"]}].map(r=>(0,D.jsx)("button",{onClick:()=>t(r.id),className:`w-full p-4 rounded-xl bg-[#F2F2F7] text-left ios-tap-target ${e===r.id?"ring-2 ring-[#007AFF]":""}`,children:(0,D.jsxs)("div",{className:"flex items-start justify-between",children:[(0,D.jsxs)("div",{className:"flex-1",children:[(0,D.jsx)("p",{className:"text-[13px] font-bold text-[#007AFF] tracking-wide",children:r.label}),(0,D.jsx)("p",{className:"text-[17px] font-semibold text-[#1D1D1F] mt-0.5",children:r.subtitle}),(0,D.jsx)("ul",{className:"mt-2 space-y-1",children:r.features.map(e=>(0,D.jsxs)("li",{className:"text-[13px] text-[#6E6E73] flex items-center gap-2",children:[(0,D.jsx)("span",{className:"text-[#30D158]",children:""})," ",e]},e))}),(0,D.jsx)("p",{className:"text-[15px] font-semibold text-[#1D1D1F] mt-3",children:r.price})]}),(0,D.jsx)("div",{className:`w-6 h-6 rounded-full border-2 flex items-center justify-center ${e===r.id?"border-[#007AFF] bg-[#007AFF]":"border-[#C7C7CC]"}`,children:e===r.id&&(0,D.jsx)("div",{className:"w-2.5 h-2.5 rounded-full bg-white"})})]})},r.id))}),(0,D.jsx)("button",{onClick:r,className:"w-full h-[44px] text-[#007AFF] text-[17px] ios-tap-target",children:"Abbrechen"})]})})}function u0({title:e,message:t,confirmLabel:r,confirmDestructive:n,onConfirm:i,onCancel:s}){return(0,D.jsx)("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 px-8",children:(0,D.jsxs)("div",{className:"bg-white w-full max-w-[270px] rounded-2xl overflow-hidden",children:[(0,D.jsxs)("div",{className:"p-4 text-center",children:[(0,D.jsx)("h3",{className:"sf-pro-display text-[17px] text-[#1D1D1F] mb-1",children:e}),(0,D.jsx)("p",{className:"text-[13px] text-[#6E6E73] leading-relaxed",children:t})]}),(0,D.jsxs)("div",{className:"border-t border-[#E5E5EA]",children:[(0,D.jsx)("button",{onClick:s,className:"w-full py-3 text-[17px] text-[#007AFF] border-b border-[#E5E5EA] ios-tap-target",children:"Abbrechen"}),(0,D.jsx)("button",{onClick:i,className:`w-full py-3 text-[17px] font-semibold ios-tap-target ${n?"text-[#FF3B30]":"text-[#007AFF]"}`,children:r})]})]})})}let u1=K("SlidersHorizontal",[["line",{x1:"21",x2:"14",y1:"4",y2:"4",key:"obuewd"}],["line",{x1:"10",x2:"3",y1:"4",y2:"4",key:"1q6298"}],["line",{x1:"21",x2:"12",y1:"12",y2:"12",key:"1iu8h1"}],["line",{x1:"8",x2:"3",y1:"12",y2:"12",key:"ntss68"}],["line",{x1:"21",x2:"16",y1:"20",y2:"20",key:"14d8ph"}],["line",{x1:"12",x2:"3",y1:"20",y2:"20",key:"m0wm8r"}],["line",{x1:"14",x2:"14",y1:"2",y2:"6",key:"14e1ph"}],["line",{x1:"8",x2:"8",y1:"10",y2:"14",key:"1i6ji0"}],["line",{x1:"16",x2:"16",y1:"18",y2:"22",key:"1lctlv"}]]),u2=K("CloudOff",[["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M5.782 5.782A7 7 0 0 0 9 19h8.5a4.5 4.5 0 0 0 1.307-.193",key:"yfwify"}],["path",{d:"M21.532 16.5A4.5 4.5 0 0 0 17.5 10h-1.79A7.008 7.008 0 0 0 10 5.07",key:"jlfiyv"}]]),u3=K("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),u4=K("Cloud",[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]]);function u5({photo:e,secretKey:t,showCloudBadge:r=!0}){let[n,i]=(0,M.useState)(null),[s,a]=(0,M.useState)(!1),[o,l]=(0,M.useState)(!1),[u,c]=(0,M.useState)(!1),[d,h]=(0,M.useState)(!1),f=(0,M.useRef)(null);return((0,M.useEffect)(()=>{if(t&&!n)return(async()=>{l(!0);try{let r=e.encryptedBlob;if(!r&&e.cid&&uv(e.cid)){c(!0),h(!0),console.log("Fetching from IPFS for thumbnail:",e.cid);try{r=await uy(e.cid),console.log("Fetched from IPFS:",{cid:e.cid,size:r.size})}catch(t){console.error(`Failed to fetch from IPFS (CID: ${e.cid}):`,t),a(!0);return}finally{c(!1)}}if(!r){console.log("No blob available for:",e.cid),h(!0);return}let n=await (0,aC.decryptFile)(r,e.nonce,t,e.mimeType);if(n){let e=URL.createObjectURL(n);f.current=e,i(e)}else a(!0)}catch(t){console.error("Failed to decrypt photo:",e.cid,t),a(!0)}finally{l(!1)}})(),()=>{f.current&&(URL.revokeObjectURL(f.current),f.current=null)}},[e,t,n]),s)?(0,D.jsxs)("div",{className:"w-full h-full flex flex-col items-center justify-center bg-red-50 text-red-500 p-2 text-center",children:[(0,D.jsx)(ez,{name:"lock",size:24,className:"mb-1 opacity-50"}),(0,D.jsx)("span",{className:"text-[10px]",children:"Fehler"})]}):u?(0,D.jsxs)("div",{className:"w-full h-full flex flex-col items-center justify-center bg-blue-50",children:[(0,D.jsx)(u4,{className:"w-5 h-5 text-blue-400 mb-1 animate-pulse"}),(0,D.jsx)(aL,{className:"w-4 h-4 animate-spin text-blue-400"}),(0,D.jsx)("span",{className:"text-[9px] text-blue-500 mt-1",children:"Laden..."})]}):o||!n?!d||n||o?(0,D.jsx)("div",{className:"w-full h-full flex items-center justify-center bg-gray-100",children:(0,D.jsx)(aL,{className:"w-6 h-6 animate-spin text-gray-400"})}):(0,D.jsxs)("div",{className:"w-full h-full flex flex-col items-center justify-center bg-gray-100 relative",children:[(0,D.jsx)(u4,{className:"w-6 h-6 text-gray-400"}),(0,D.jsx)("span",{className:"text-[9px] text-gray-500 mt-1",children:"In der Cloud"})]}):(0,D.jsxs)("div",{className:"relative w-full h-full",children:[(0,D.jsx)("img",{src:n,alt:"",className:"w-full h-full object-cover animate-in fade-in duration-500",loading:"lazy"}),r&&d&&(0,D.jsx)("div",{className:"absolute bottom-1 right-1 bg-black/50 rounded-full p-1",children:(0,D.jsx)(u4,{className:"w-3 h-3 text-white"})})]})}function u6({photosCount:t}){var r;let n,i,s,a,o,[l,u]=(0,M.useState)(""),[c,d]=(0,M.useState)(!1),[h,f]=(0,M.useState)(!1),[p,m]=(0,M.useState)(null),[g,y]=(0,M.useState)(!1),[v,b]=(0,M.useState)(new Set),[x,w]=(0,M.useState)(null),[_,k]=(0,M.useState)(null),[j,E]=(0,M.useState)(null),[S,O]=(0,M.useState)(!1),[T,N]=(0,M.useState)(!1),A=(0,M.useRef)(null),{secretKey:P}=aI(),{photos:C,uploadPhoto:z,isUploading:R}=ux(P),{remoteCIDs:$,remoteCIDsFromOtherDevices:F,isConnected:I}=function(t={}){let{onNewPhoto:r,onPhotoDeleted:n,enabled:i=!0,secretKey:s}=t,[a,o]=(0,M.useState)([]),[l,u]=(0,M.useState)(!1),[c,d]=(0,M.useState)(null),[h,f]=(0,M.useState)(null),p=(0,ub.getDeviceId)();(0,M.useEffect)(()=>{s?(0,aC.getUserKeyHash)(s).then(f):f(null)},[s]),(0,M.useEffect)(()=>{h&&"server"!==p&&(async()=>{try{let{getDeviceName:t,getDeviceType:r}=await e.A(66244),n=t(),i=r();await ud(p,n,i,h),console.log("Device registered with hash:",h)}catch(e){console.error("Failed to register device:",e)}})()},[h,p]);let m=(0,M.useCallback)(async()=>{try{let e=(await uu(p,h||void 0)).map(e=>({cid:e.cid,device_id:e.device_id,uploaded_at:e.uploaded_at,file_size_bytes:e.file_size_bytes,nonce:e.nonce||null,mime_type:e.mime_type||null,isFromOtherDevice:e.device_id!==p}));return o(e),d(null),e}catch(e){return console.error("Failed to load remote CIDs:",e),d(e),[]}},[p,h]);(0,M.useEffect)(()=>{if(!i)return;let e=null;return(async()=>{await m(),e=uo.channel("photos_metadata_changes").on("postgres_changes",{event:"INSERT",schema:"public",table:"photos_metadata"},e=>{let t=e.new;if(h&&t.user_key_hash!==h)return;let n={cid:t.cid,device_id:t.device_id,uploaded_at:t.uploaded_at,file_size_bytes:t.file_size_bytes,nonce:t.nonce,mime_type:t.mime_type,isFromOtherDevice:t.device_id!==p};n.isFromOtherDevice&&(console.log("New photo metadata received from another device:",n.cid),r?.(n)),o(e=>e.some(e=>e.cid===n.cid)?e:[n,...e])}).on("postgres_changes",{event:"DELETE",schema:"public",table:"photos_metadata"},e=>{let t=e.old;n?.(t.cid),o(e=>e.filter(e=>e.cid!==t.cid))}).subscribe(e=>{console.log("Realtime subscription status:",e),u("SUBSCRIBED"===e)})})(),()=>{e&&uo.removeChannel(e)}},[i,p,h,r,n,m]);let g=(0,M.useCallback)(async()=>m(),[m]),y=a.filter(e=>e.isFromOtherDevice);return{remoteCIDs:a,remoteCIDsFromOtherDevices:y,isConnected:l,lastSyncError:c,refresh:g,deviceId:p,userKeyHash:h}}({onNewPhoto:(0,M.useCallback)(e=>{console.log("New photo from device:",e.device_id),k(`Neues Foto von anderem Ger\xe4t empfangen`),setTimeout(()=>k(null),3e3)},[]),enabled:!0,secretKey:P}),U=(n=C.map(e=>({id:e.id?.toString()||e.cid,cid:e.cid,placeholderUrl:"",category:"photo",date:e.uploadedAt.toISOString().split("T")[0],metadata:e,isLocal:!0,isCloud:uv(e.cid)})),i=new Set(C.map(e=>e.cid)),[...n,...$.filter(e=>!i.has(e.cid)).map(e=>({id:e.cid,cid:e.cid,placeholderUrl:"",category:"cloud",date:e.uploaded_at?new Date(e.uploaded_at).toISOString().split("T")[0]:new Date().toISOString().split("T")[0],metadata:{cid:e.cid,nonce:e.nonce||"",fileName:`cloud_${e.cid}`,mimeType:e.mime_type||"image/jpeg",fileSize:e.file_size_bytes||0,uploadedAt:e.uploaded_at?new Date(e.uploaded_at):new Date},isLocal:!1,isCloud:!0}))]),L=U.length>0?U:(r=Math.min(t,50),s=["nature","architecture","travel","food","animals","city","landscape","portrait","ocean","forest"],a=new Date,Array.from({length:r},(e,t)=>{let r=new Date(a);return r.setDate(r.getDate()-Math.floor(t/3)),{id:`photo-${t}`,cid:`Qm${Math.random().toString(36).substring(2,15)}${Math.random().toString(36).substring(2,15)}`,placeholderUrl:`https://picsum.photos/seed/${t+100}/400/400`,category:s[t%s.length],date:r.toISOString().split("T")[0],metadata:void 0}})),B=(o={},L.filter(e=>(!p||e.category===p)&&(!l||!!e.category.includes(l.toLowerCase()))).forEach(e=>{o[e.date]||(o[e.date]=[]),o[e.date].push(e)}),Object.entries(o).map(([e,t])=>{var r;let n,i,s;return{date:e,photos:t,label:(n=new Date(r=e),((s=new Date(i=new Date)).setDate(s.getDate()-1),r===i.toISOString().split("T")[0])?"Heute":r===s.toISOString().split("T")[0]?"Gestern":n.toLocaleDateString("de-DE",{weekday:"long",day:"numeric",month:"long"}))}})),K=async e=>{if(P&&e.metadata){O(!0),E(null);try{let t=e.metadata.encryptedBlob;if(!t&&e.cid&&uv(e.cid)&&(console.log("Loading full-res from IPFS:",e.cid),t=await uy(e.cid)),!t)return void console.error("No blob available for fullscreen");let r=await (0,aC.decryptFile)(t,e.metadata.nonce,P,e.metadata.mimeType);if(r){let e=URL.createObjectURL(r);E(e)}}catch(e){console.error("Failed to load fullscreen photo:",e)}finally{O(!1)}}},Z=async e=>{if(P&&e.metadata){N(!0);try{let t=e.metadata.encryptedBlob;if(!t&&e.cid&&uv(e.cid)&&(t=await uy(e.cid)),!t)return;let r=await (0,aC.decryptFile)(t,e.metadata.nonce,P,e.metadata.mimeType);if(r){let t=URL.createObjectURL(r),n=document.createElement("a");n.href=t,n.download=e.metadata.fileName||`photo_${e.cid.slice(0,8)}.jpg`,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(t),k("Foto heruntergeladen!"),setTimeout(()=>k(null),2e3)}}catch(e){console.error("Failed to download photo:",e)}finally{N(!1)}}},q=()=>{A.current&&(clearTimeout(A.current),A.current=null)};return(0,D.jsxs)("div",{className:"flex flex-col h-full bg-[#F2F2F7]",children:[(0,D.jsx)("header",{className:"h-[60px] bg-white border-b border-[#E5E5EA] px-4 flex items-center justify-between shrink-0",children:c?(0,D.jsxs)("div",{className:"flex-1 flex items-center gap-3",children:[(0,D.jsxs)("div",{className:"flex-1 bg-[#E5E5EA] rounded-lg px-3 py-2 flex items-center gap-2",children:[(0,D.jsx)(ez,{name:"search",size:16}),(0,D.jsx)("input",{type:"text",placeholder:"Suchen...",value:l,onChange:e=>u(e.target.value),className:"flex-1 bg-transparent text-[15px] text-[#1D1D1F] outline-none",autoFocus:!0})]}),(0,D.jsx)("button",{onClick:()=>{d(!1),u("")},className:"text-[17px] text-[#007AFF] ios-tap-target",children:"Abbrechen"})]}):g?(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)("button",{onClick:()=>{y(!1),b(new Set)},className:"text-[17px] text-[#007AFF] ios-tap-target",children:"Abbrechen"}),(0,D.jsxs)("span",{className:"sf-pro-display text-[17px] text-[#1D1D1F]",children:[v.size," ausgewhlt"]}),(0,D.jsx)("button",{onClick:()=>{console.log("TODO: Delete selected photos",Array.from(v))},className:"text-[17px] text-[#FF3B30] ios-tap-target",children:"Lschen"})]}):(0,D.jsxs)(D.Fragment,{children:[(0,D.jsxs)("div",{className:"flex items-center gap-2",children:[(0,D.jsx)(ez,{name:"lock",size:20}),(0,D.jsx)("h1",{className:"sf-pro-display text-[20px] text-[#1D1D1F]",children:"Galerie"}),I?(0,D.jsx)(u4,{className:"w-4 h-4 text-[#007AFF]"}):(0,D.jsx)(u2,{className:"w-4 h-4 text-[#8E8E93]"})]}),(0,D.jsxs)("div",{className:"flex items-center gap-4",children:[(0,D.jsxs)("label",{className:"ios-tap-target cursor-pointer",children:[(0,D.jsx)("div",{className:R?"animate-pulse opacity-50":"",children:(0,D.jsx)(ez,{name:"upload",size:24})}),(0,D.jsx)("input",{type:"file",multiple:!0,accept:"image/*",onChange:e=>{Array.from(e.target.files||[]).forEach(e=>z(e))},className:"hidden",disabled:R})]}),(0,D.jsx)("button",{onClick:()=>d(!0),className:"ios-tap-target",children:(0,D.jsx)(ez,{name:"search",size:24})}),(0,D.jsx)("button",{onClick:()=>f(!h),className:"ios-tap-target",children:(0,D.jsx)(u1,{className:`w-6 h-6 ${p?"text-[#30D158]":"text-[#007AFF]"}`})})]})]})}),h&&(0,D.jsx)("div",{className:"bg-white border-b border-[#E5E5EA] px-4 py-3 shrink-0",children:(0,D.jsxs)("div",{className:"flex gap-2 overflow-x-auto pb-1 -mx-1 px-1",children:[(0,D.jsx)("button",{onClick:()=>m(null),className:`px-4 py-1.5 rounded-full text-[15px] whitespace-nowrap shrink-0 ${null===p?"bg-[#007AFF] text-white":"bg-[#E5E5EA] text-[#1D1D1F]"}`,children:"Alle"}),[{id:"nature",label:"Natur"},{id:"architecture",label:"Architektur"},{id:"travel",label:"Reisen"},{id:"food",label:"Essen"},{id:"animals",label:"Tiere"},{id:"city",label:"Stadt"},{id:"landscape",label:"Landschaft"}].map(e=>(0,D.jsx)("button",{onClick:()=>m(e.id),className:`px-4 py-1.5 rounded-full text-[15px] whitespace-nowrap shrink-0 ${p===e.id?"bg-[#007AFF] text-white":"bg-[#E5E5EA] text-[#1D1D1F]"}`,children:e.label},e.id))]})}),(0,D.jsxs)("div",{className:"flex-1 overflow-y-auto",children:[B.map(e=>(0,D.jsxs)("div",{className:"mb-2",children:[(0,D.jsx)("div",{className:"sticky top-0 bg-[#F2F2F7]/95 backdrop-blur-sm px-3 py-2 z-10",children:(0,D.jsx)("p",{className:"text-[13px] font-semibold text-[#6E6E73]",children:e.label})}),(0,D.jsx)("div",{className:"grid grid-cols-3 gap-[2px] px-[2px]",children:e.photos.map(e=>{let t=void 0!==e.metadata;return(0,D.jsxs)("button",{onClick:()=>{var t;return t=e.id,void(g?b(e=>{let r=new Set(e);return r.has(t)?r.delete(t):r.add(t),r}):(w(t),e.metadata&&K(e)))},onTouchStart:()=>{var t;return t=e.id,void(A.current=setTimeout(()=>{y(!0),b(new Set([t]))},500))},onTouchEnd:q,onTouchCancel:q,onContextMenu:t=>{t.preventDefault(),y(!0),b(new Set([e.id]))},className:"relative aspect-square overflow-hidden bg-[#E5E5EA]",children:[t?(0,D.jsx)(u5,{photo:e.metadata,secretKey:P,showCloudBadge:!0}):e.placeholderUrl?(0,D.jsx)("img",{src:e.placeholderUrl,alt:"",className:"w-full h-full object-cover",loading:"lazy"}):null,g&&(0,D.jsx)("div",{className:"absolute inset-0 bg-black/20",children:(0,D.jsx)("div",{className:`absolute top-2 right-2 w-6 h-6 rounded-full border-2 flex items-center justify-center ${v.has(e.id)?"bg-[#007AFF] border-[#007AFF]":"border-white bg-black/30"}`,children:v.has(e.id)&&(0,D.jsx)(aR,{className:"w-4 h-4 text-white"})})})]},e.id)})})]},e.date)),(0,D.jsxs)("div",{className:"text-center py-6 px-4",children:[(0,D.jsx)("p",{className:"text-[13px] text-[#8E8E93]",children:"Lange drcken zum Auswhlen  Tippen zum ffnen"}),(0,D.jsxs)("p",{className:"text-[11px] text-[#C7C7CC] mt-1",children:[C.length," Fotos lokal  ",$.length," in der Cloud"]}),F.length>0&&(0,D.jsxs)("div",{className:"text-[11px] text-[#007AFF] mt-1 flex items-center justify-center gap-1",children:[(0,D.jsx)(ez,{name:"smartphone",size:12}),F.length," von anderen Gerten"]})]})]}),_&&(0,D.jsxs)("div",{className:"fixed top-[70px] left-1/2 -translate-x-1/2 bg-[#1D1D1F] text-white px-4 py-2 rounded-full text-[13px] flex items-center gap-2 z-50 animate-pulse",children:[(0,D.jsx)(u4,{className:"w-4 h-4"}),_]}),x&&(0,D.jsxs)("div",{className:"fixed inset-0 bg-black z-50 flex flex-col",children:[(0,D.jsxs)("header",{className:"h-[60px] flex items-center justify-between px-4 bg-black/80",children:[(0,D.jsx)("button",{onClick:()=>{w(null),j&&(URL.revokeObjectURL(j),E(null))},className:"ios-tap-target",children:(0,D.jsx)(uI,{className:"w-6 h-6 text-white"})}),(0,D.jsxs)("span",{className:"text-[17px] text-white",children:["Foto ",L.findIndex(e=>e.id===x)+1," von"," ",L.length]}),(0,D.jsx)("div",{className:"w-10"})]}),(0,D.jsx)("div",{className:"flex-1 flex items-center justify-center p-4",children:S?(0,D.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,D.jsx)(aL,{className:"w-12 h-12 animate-spin text-white/60"}),(0,D.jsx)("p",{className:"text-white/60 text-center",children:"Lade von IPFS..."})]}):j?(0,D.jsx)("img",{src:j,alt:"",className:"max-w-full max-h-full object-contain rounded-lg"}):(0,D.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,D.jsx)(ez,{name:"lock",size:64}),(0,D.jsx)("p",{className:"text-white/80 text-center",children:"Verschlsseltes Foto"})]})}),(0,D.jsxs)("footer",{className:"h-[80px] flex items-center justify-center gap-6 bg-black/80 px-4",children:[(0,D.jsxs)("button",{onClick:()=>{let e=L.find(e=>e.id===x);e&&Z(e)},disabled:T,className:"flex flex-col items-center gap-1 ios-tap-target",children:[T?(0,D.jsx)(aL,{className:"w-6 h-6 animate-spin text-white"}):(0,D.jsx)(u3,{className:"w-6 h-6 text-white"}),(0,D.jsx)("span",{className:"text-[11px] text-white/80",children:"Herunterladen"})]}),(0,D.jsxs)("div",{className:"flex flex-col items-center gap-1",children:[(0,D.jsx)(ez,{name:"lock",size:20}),(0,D.jsx)("span",{className:"text-[11px] text-white/60",children:"Verschlsselt"})]})]})]})]})}let u8={isOnboarded:!1,backupActive:!1,selectedPlan:"free",autoBackupEnabled:!0,backgroundBackupEnabled:!1,photosCount:0,lastBackup:"Noch nie",permanence:0,encryptionKey:"",backupPhrase:[],devices:[],photoSource:"photos-app"};function u7(){let[e,t]=(0,M.useState)(u8),[r,n]=(0,M.useState)("gallery"),[i,s]=(0,M.useState)("loading"),[a,o]=(0,M.useState)(null),{data:l,isPending:u}=aO(),c=(0,M.useCallback)(async(e,t)=>{try{let r=(0,ub.getDeviceId)(),n=(0,ub.getDeviceName)(),i=(0,ub.getDeviceType)();await ud(r,n,i,e,t),console.log("Device registered successfully")}catch(e){console.error("Failed to register device:",e)}},[]);(0,M.useEffect)(()=>{(async()=>{if(u)return;if(!l?.user)return s("auth");let e=l.user;o({id:e.id,email:e.email,vaultKeyHash:e.vault_key_hash||null});let r=(0,aC.loadKeyFromStorage)();if(r){let n=await (0,aC.getUserKeyHash)(r);if(e.vault_key_hash&&n!==e.vault_key_hash){console.warn("Local key doesn't match account's vault_key_hash"),(0,aC.clearKeyFromStorage)(),s("unlock");return}await c(n,e.id),t(e=>({...e,isOnboarded:!0})),s("main")}else e.vault_key_hash?s("unlock"):s("setup")})()},[l,u,c]);let d=(0,M.useCallback)(e=>{o(e);let r=(0,aC.loadKeyFromStorage)();r?(0,aC.getUserKeyHash)(r).then(r=>{e.vaultKeyHash&&r!==e.vaultKeyHash?((0,aC.clearKeyFromStorage)(),s("unlock")):(c(r,e.id),t(e=>({...e,isOnboarded:!0})),s("main"))}):e.vaultKeyHash?s("unlock"):s("setup")},[c]),h=(0,M.useCallback)(async(e,r)=>{a&&(a.vaultKeyHash||(await u9(a.id,r),o({...a,vaultKeyHash:r})),await c(r,a.id),t(e=>({...e,isOnboarded:!0})),s("main"))},[a,c]),f=(0,M.useCallback)(async e=>{a&&(await u9(a.id,e),o({...a,vaultKeyHash:e}),await c(e,a.id),t(e=>({...e,isOnboarded:!0})),s("main"))},[a,c]),p=(0,M.useCallback)(async()=>{await aS(),(0,aC.clearKeyFromStorage)(),o(null),t(u8),s("auth")},[]);return"loading"===i||u?(0,D.jsx)(e$,{}):"auth"===i?(0,D.jsx)("div",{className:"min-h-screen ios-bg-gray",children:(0,D.jsx)("div",{className:"max-w-[428px] mx-auto min-h-screen bg-[#F2F2F7]",children:(0,D.jsx)(aN,{onSuccess:d})})}):"unlock"===i&&a?(0,D.jsx)("div",{className:"min-h-screen ios-bg-gray",children:(0,D.jsx)("div",{className:"max-w-[428px] mx-auto min-h-screen bg-[#F2F2F7]",children:(0,D.jsx)(az,{userEmail:a.email,expectedKeyHash:a.vaultKeyHash,onUnlock:h,onCreateNewVault:()=>s("setup"),onLogout:p})})}):"setup"===i&&a?(0,D.jsx)("div",{className:"min-h-screen ios-bg-gray",children:(0,D.jsx)("div",{className:"max-w-[428px] mx-auto min-h-screen bg-[#F2F2F7]",children:(0,D.jsx)(aD,{userId:a.id,onComplete:f,onBack:()=>s("unlock")})})}):(0,D.jsx)("div",{className:"min-h-screen ios-bg-gray",children:(0,D.jsxs)("div",{className:"max-w-[428px] mx-auto min-h-screen bg-[#F2F2F7] flex flex-col",children:[(0,D.jsxs)("div",{className:"flex-1 overflow-hidden pb-[80px]",children:["gallery"===r&&(0,D.jsx)(u6,{photosCount:e.photosCount}),"dashboard"===r&&(0,D.jsx)(uV,{state:e,setState:t}),"settings"===r&&(0,D.jsx)(uG,{state:e,setState:t,onRestartOnboarding:p})]}),(0,D.jsx)(ce,{currentScreen:r,onNavigate:e=>{n(e)}})]})})}async function u9(e,t){try{if(!(await fetch("/api/auth/update-vault-key",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:e,keyHash:t})})).ok)throw Error("Failed to update vault key hash")}catch(e){throw console.error("Failed to update vault_key_hash:",e),e}}function ce({currentScreen:e,onNavigate:t}){return(0,D.jsxs)("nav",{className:"fixed bottom-0 left-0 right-0 h-[80px] bg-white/80 backdrop-blur-xl border-t border-[#E5E5EA]/50 flex items-start justify-around pt-2 pb-6 max-w-[428px] mx-auto safe-area-bottom",children:[(0,D.jsxs)("button",{onClick:()=>t("gallery"),className:"flex flex-col items-center gap-1 ios-tap-target px-4",children:[(0,D.jsx)(ez,{name:"image",size:24,className:"gallery"===e?"text-[#007AFF]":"text-[#6E6E73]"}),(0,D.jsx)("span",{className:`text-[10px] ${"gallery"===e?"text-[#007AFF]":"text-[#6E6E73]"}`,children:"Galerie"})]}),(0,D.jsxs)("button",{onClick:()=>t("dashboard"),className:"flex flex-col items-center gap-1 ios-tap-target px-4",children:[(0,D.jsx)(ez,{name:"shield",size:24,className:"dashboard"===e?"text-[#007AFF]":"text-[#6E6E73]"}),(0,D.jsx)("span",{className:`text-[10px] ${"dashboard"===e?"text-[#007AFF]":"text-[#6E6E73]"}`,children:"Backup"})]}),(0,D.jsxs)("button",{onClick:()=>t("settings"),className:"flex flex-col items-center gap-1 ios-tap-target px-4",children:[(0,D.jsx)(Z,{className:`w-6 h-6 ${"settings"===e?"text-[#007AFF]":"text-[#6E6E73]"}`}),(0,D.jsx)("span",{className:`text-[10px] ${"settings"===e?"text-[#007AFF]":"text-[#6E6E73]"}`,children:"Einstellungen"})]})]})}e.s(["PhotoVaultApp",()=>u7],71058)}]);